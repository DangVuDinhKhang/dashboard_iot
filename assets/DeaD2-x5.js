var ng=Object.defineProperty;var ig=(n,t,e)=>t in n?ng(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var I=(n,t,e)=>(ig(n,typeof t!="symbol"?t+"":t,e),e);import{r as S,o as Ot,t as F,v as tt,E as y,F as X,G as us,d as Zt,H as Ta,g as It,I as sg,J as fe,K as Rn,L as Rr,M as xu,N as wu,O as Gt,P as Cu,x as L,Q as Ii,y as oe,R as re,z as Wt,S as ne,c as Q,T as og,U as ve,V as rg,W as ag,X as lg,A as zn,B as cg,Y as Es,Z as Ts,$ as ks,a0 as hg}from"./Q7CzeNFU.js";import{u as ug}from"./LM2H4yQC.js";const dg={key:0,class:"toast fixed shadow-2xl w-[60%] lg:w-[17%] h-[70px] mr-2 rounded-md bg-green-500 p-5 absolute top-[2%] left-[20%] lg:left-[83%] z-20 text-md lg:text-xl text-center"},fg={key:1,class:"toast toast-warning fixed shadow-2xl w-[60%] lg:w-[25%] h-[70px] mr-2 rounded-md bg-yellow-500 p-5 absolute top-[2%] left-[20%] lg:left-[0%] z-20 text-md lg:text-xl text-center"},pg={__name:"Toast",props:{type:String},setup(n){const t=n,e=S("");return Ot(()=>{e.value=t.type}),(i,s)=>(F(),tt(us,null,[y(e)=="info"?(F(),tt("div",dg,"Save Data Successfully")):X("",!0),y(e)=="warning"?(F(),tt("div",fg,"Co2 Concentration is too high!")):X("",!0)],64))}},gg=""+new URL("co2.Ic1eMh-q.png",import.meta.url).href,mg=""+new URL("Light.lXKUvo7z.png",import.meta.url).href,_g=""+new URL("PhunSuong_OFF.BWJLSRSM.png",import.meta.url).href,ka=""+new URL("temperature.BQxJ2iZt.png",import.meta.url).href;/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function ds(n){return n+.5|0}const $e=(n,t,e)=>Math.max(Math.min(n,e),t);function Mi(n){return $e(ds(n*2.55),0,255)}function Ke(n){return $e(ds(n*255),0,255)}function Me(n){return $e(ds(n/2.55)/100,0,1)}function zl(n){return $e(ds(n*100),0,100)}const te={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Or=[..."0123456789ABCDEF"],bg=n=>Or[n&15],yg=n=>Or[(n&240)>>4]+Or[n&15],Is=n=>(n&240)>>4===(n&15),vg=n=>Is(n.r)&&Is(n.g)&&Is(n.b)&&Is(n.a);function xg(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&te[n[1]]*17,g:255&te[n[2]]*17,b:255&te[n[3]]*17,a:t===5?te[n[4]]*17:255}:(t===7||t===9)&&(e={r:te[n[1]]<<4|te[n[2]],g:te[n[3]]<<4|te[n[4]],b:te[n[5]]<<4|te[n[6]],a:t===9?te[n[7]]<<4|te[n[8]]:255})),e}const wg=(n,t)=>n<255?t(n):"";function Cg(n){var t=vg(n)?bg:yg;return n?"#"+t(n.r)+t(n.g)+t(n.b)+wg(n.a,t):void 0}const Sg=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Su(n,t,e){const i=t*Math.min(e,1-e),s=(o,r=(o+n/30)%12)=>e-i*Math.max(Math.min(r-3,9-r,1),-1);return[s(0),s(8),s(4)]}function Eg(n,t,e){const i=(s,o=(s+n/60)%6)=>e-e*t*Math.max(Math.min(o,4-o,1),0);return[i(5),i(3),i(1)]}function Tg(n,t,e){const i=Su(n,1,.5);let s;for(t+e>1&&(s=1/(t+e),t*=s,e*=s),s=0;s<3;s++)i[s]*=1-t-e,i[s]+=t;return i}function kg(n,t,e,i,s){return n===s?(t-e)/i+(t<e?6:0):t===s?(e-n)/i+2:(n-t)/i+4}function Ia(n){const e=n.r/255,i=n.g/255,s=n.b/255,o=Math.max(e,i,s),r=Math.min(e,i,s),a=(o+r)/2;let l,c,h;return o!==r&&(h=o-r,c=a>.5?h/(2-o-r):h/(o+r),l=kg(e,i,s,h,o),l=l*60+.5),[l|0,c||0,a]}function Ma(n,t,e,i){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,i)).map(Ke)}function Aa(n,t,e){return Ma(Su,n,t,e)}function Ig(n,t,e){return Ma(Tg,n,t,e)}function Mg(n,t,e){return Ma(Eg,n,t,e)}function Eu(n){return(n%360+360)%360}function Ag(n){const t=Sg.exec(n);let e=255,i;if(!t)return;t[5]!==i&&(e=t[6]?Mi(+t[5]):Ke(+t[5]));const s=Eu(+t[2]),o=+t[3]/100,r=+t[4]/100;return t[1]==="hwb"?i=Ig(s,o,r):t[1]==="hsv"?i=Mg(s,o,r):i=Aa(s,o,r),{r:i[0],g:i[1],b:i[2],a:e}}function Pg(n,t){var e=Ia(n);e[0]=Eu(e[0]+t),e=Aa(e),n.r=e[0],n.g=e[1],n.b=e[2]}function Dg(n){if(!n)return;const t=Ia(n),e=t[0],i=zl(t[1]),s=zl(t[2]);return n.a<255?`hsla(${e}, ${i}%, ${s}%, ${Me(n.a)})`:`hsl(${e}, ${i}%, ${s}%)`}const Vl={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},$l={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Rg(){const n={},t=Object.keys($l),e=Object.keys(Vl);let i,s,o,r,a;for(i=0;i<t.length;i++){for(r=a=t[i],s=0;s<e.length;s++)o=e[s],a=a.replace(o,Vl[o]);o=parseInt($l[r],16),n[a]=[o>>16&255,o>>8&255,o&255]}return n}let Ms;function Og(n){Ms||(Ms=Rg(),Ms.transparent=[0,0,0,0]);const t=Ms[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const Ng=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Lg(n){const t=Ng.exec(n);let e=255,i,s,o;if(t){if(t[7]!==i){const r=+t[7];e=t[8]?Mi(r):$e(r*255,0,255)}return i=+t[1],s=+t[3],o=+t[5],i=255&(t[2]?Mi(i):$e(i,0,255)),s=255&(t[4]?Mi(s):$e(s,0,255)),o=255&(t[6]?Mi(o):$e(o,0,255)),{r:i,g:s,b:o,a:e}}}function Fg(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Me(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const ir=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Vn=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function Bg(n,t,e){const i=Vn(Me(n.r)),s=Vn(Me(n.g)),o=Vn(Me(n.b));return{r:Ke(ir(i+e*(Vn(Me(t.r))-i))),g:Ke(ir(s+e*(Vn(Me(t.g))-s))),b:Ke(ir(o+e*(Vn(Me(t.b))-o))),a:n.a+e*(t.a-n.a)}}function As(n,t,e){if(n){let i=Ia(n);i[t]=Math.max(0,Math.min(i[t]+i[t]*e,t===0?360:1)),i=Aa(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function Tu(n,t){return n&&Object.assign(t||{},n)}function jl(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=Ke(n[3]))):(t=Tu(n,{r:0,g:0,b:0,a:1}),t.a=Ke(t.a)),t}function Hg(n){return n.charAt(0)==="r"?Lg(n):Ag(n)}class Ki{constructor(t){if(t instanceof Ki)return t;const e=typeof t;let i;e==="object"?i=jl(t):e==="string"&&(i=xg(t)||Og(t)||Hg(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Tu(this._rgb);return t&&(t.a=Me(t.a)),t}set rgb(t){this._rgb=jl(t)}rgbString(){return this._valid?Fg(this._rgb):void 0}hexString(){return this._valid?Cg(this._rgb):void 0}hslString(){return this._valid?Dg(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,s=t.rgb;let o;const r=e===o?.5:e,a=2*r-1,l=i.a-s.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;o=1-c,i.r=255&c*i.r+o*s.r+.5,i.g=255&c*i.g+o*s.g+.5,i.b=255&c*i.b+o*s.b+.5,i.a=r*i.a+(1-r)*s.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=Bg(this._rgb,t._rgb,e)),this}clone(){return new Ki(this.rgb)}alpha(t){return this._rgb.a=Ke(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=ds(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return As(this._rgb,2,t),this}darken(t){return As(this._rgb,2,-t),this}saturate(t){return As(this._rgb,1,t),this}desaturate(t){return As(this._rgb,1,-t),this}rotate(t){return Pg(this._rgb,t),this}}/*!
 * Chart.js v4.4.2
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */function Ee(){}const Wg=(()=>{let n=0;return()=>n++})();function V(n){return n===null||typeof n>"u"}function lt(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function j(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function pt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Xt(n,t){return pt(n)?n:t}function O(n,t){return typeof n>"u"?t:n}const zg=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,ku=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function et(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function Z(n,t,e,i){let s,o,r;if(lt(n))if(o=n.length,i)for(s=o-1;s>=0;s--)t.call(e,n[s],s);else for(s=0;s<o;s++)t.call(e,n[s],s);else if(j(n))for(r=Object.keys(n),o=r.length,s=0;s<o;s++)t.call(e,n[r[s]],r[s])}function so(n,t){let e,i,s,o;if(!n||!t||n.length!==t.length)return!1;for(e=0,i=n.length;e<i;++e)if(s=n[e],o=t[e],s.datasetIndex!==o.datasetIndex||s.index!==o.index)return!1;return!0}function oo(n){if(lt(n))return n.map(oo);if(j(n)){const t=Object.create(null),e=Object.keys(n),i=e.length;let s=0;for(;s<i;++s)t[e[s]]=oo(n[e[s]]);return t}return n}function Iu(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function Vg(n,t,e,i){if(!Iu(n))return;const s=t[n],o=e[n];j(s)&&j(o)?xe(s,o,i):t[n]=oo(o)}function xe(n,t,e){const i=lt(t)?t:[t],s=i.length;if(!j(n))return n;e=e||{};const o=e.merger||Vg;let r;for(let a=0;a<s;++a){if(r=i[a],!j(r))continue;const l=Object.keys(r);for(let c=0,h=l.length;c<h;++c)o(l[c],n,r,e)}return n}function Oi(n,t){return xe(n,t,{merger:$g})}function $g(n,t,e){if(!Iu(n))return;const i=t[n],s=e[n];j(i)&&j(s)?Oi(i,s):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=oo(s))}const Ul={"":n=>n,x:n=>n.x,y:n=>n.y};function jg(n){const t=n.split("."),e=[];let i="";for(const s of t)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(e.push(i),i="");return e}function Ug(n){const t=jg(n);return e=>{for(const i of t){if(i==="")break;e=e&&e[i]}return e}}function Ze(n,t){return(Ul[t]||(Ul[t]=Ug(t)))(n)}function Pa(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Xi=n=>typeof n<"u",tn=n=>typeof n=="function",Yl=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function Yg(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const ht=Math.PI,ct=2*ht,qg=ct+ht,ro=Number.POSITIVE_INFINITY,Gg=ht/180,mt=ht/2,rn=ht/4,ql=ht*2/3,je=Math.log10,be=Math.sign;function Ni(n,t,e){return Math.abs(n-t)<e}function Gl(n){const t=Math.round(n);n=Ni(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(je(n))),i=n/e;return(i<=1?1:i<=2?2:i<=5?5:10)*e}function Kg(n){const t=[],e=Math.sqrt(n);let i;for(i=1;i<e;i++)n%i===0&&(t.push(i),t.push(n/i));return e===(e|0)&&t.push(e),t.sort((s,o)=>s-o).pop(),t}function Zn(n){return!isNaN(parseFloat(n))&&isFinite(n)}function Xg(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function Mu(n,t,e){let i,s,o;for(i=0,s=n.length;i<s;i++)o=n[i][e],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function le(n){return n*(ht/180)}function Da(n){return n*(180/ht)}function Kl(n){if(!pt(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function Au(n,t){const e=t.x-n.x,i=t.y-n.y,s=Math.sqrt(e*e+i*i);let o=Math.atan2(i,e);return o<-.5*ht&&(o+=ct),{angle:o,distance:s}}function Nr(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function Qg(n,t){return(n-t+qg)%ct-ht}function Qt(n){return(n%ct+ct)%ct}function Qi(n,t,e,i){const s=Qt(n),o=Qt(t),r=Qt(e),a=Qt(o-s),l=Qt(r-s),c=Qt(s-o),h=Qt(s-r);return s===o||s===r||i&&o===r||a>l&&c<h}function At(n,t,e){return Math.max(t,Math.min(e,n))}function Jg(n){return At(n,-32768,32767)}function Ae(n,t,e,i=1e-6){return n>=Math.min(t,e)-i&&n<=Math.max(t,e)+i}function Ra(n,t,e){e=e||(r=>n[r]<t);let i=n.length-1,s=0,o;for(;i-s>1;)o=s+i>>1,e(o)?s=o:i=o;return{lo:s,hi:i}}const Pe=(n,t,e,i)=>Ra(n,e,i?s=>{const o=n[s][t];return o<e||o===e&&n[s+1][t]===e}:s=>n[s][t]<e),Zg=(n,t,e)=>Ra(n,e,i=>n[i][t]>=e);function tm(n,t,e){let i=0,s=n.length;for(;i<s&&n[i]<t;)i++;for(;s>i&&n[s-1]>e;)s--;return i>0||s<n.length?n.slice(i,s):n}const Pu=["push","pop","shift","splice","unshift"];function em(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Pu.forEach(e=>{const i="_onData"+Pa(e),s=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...o){const r=s.apply(this,o);return n._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...o)}),r}})})}function Xl(n,t){const e=n._chartjs;if(!e)return;const i=e.listeners,s=i.indexOf(t);s!==-1&&i.splice(s,1),!(i.length>0)&&(Pu.forEach(o=>{delete n[o]}),delete n._chartjs)}function Du(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const Ru=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Ou(n,t){let e=[],i=!1;return function(...s){e=s,i||(i=!0,Ru.call(window,()=>{i=!1,n.apply(t,e)}))}}function nm(n,t){let e;return function(...i){return t?(clearTimeout(e),e=setTimeout(n,t,i)):n.apply(this,i),t}}const Oa=n=>n==="start"?"left":n==="end"?"right":"center",Ft=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,im=(n,t,e,i)=>n===(i?"left":"right")?e:n==="center"?(t+e)/2:t;function Nu(n,t,e){const i=t.length;let s=0,o=i;if(n._sorted){const{iScale:r,_parsed:a}=n,l=r.axis,{min:c,max:h,minDefined:u,maxDefined:d}=r.getUserBounds();u&&(s=At(Math.min(Pe(a,l,c).lo,e?i:Pe(t,l,r.getPixelForValue(c)).lo),0,i-1)),d?o=At(Math.max(Pe(a,r.axis,h,!0).hi+1,e?0:Pe(t,l,r.getPixelForValue(h),!0).hi+1),s,i)-s:o=i-s}return{start:s,count:o}}function Lu(n){const{xScale:t,yScale:e,_scaleRanges:i}=n,s={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!i)return n._scaleRanges=s,!0;const o=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==e.min||i.ymax!==e.max;return Object.assign(i,s),o}const Ps=n=>n===0||n===1,Ql=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*ct/e)),Jl=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*ct/e)+1,Li={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*mt)+1,easeOutSine:n=>Math.sin(n*mt),easeInOutSine:n=>-.5*(Math.cos(ht*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Ps(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Ps(n)?n:Ql(n,.075,.3),easeOutElastic:n=>Ps(n)?n:Jl(n,.075,.3),easeInOutElastic(n){return Ps(n)?n:n<.5?.5*Ql(n*2,.1125,.45):.5+.5*Jl(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Li.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Li.easeInBounce(n*2)*.5:Li.easeOutBounce(n*2-1)*.5+.5};function Na(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Zl(n){return Na(n)?n:new Ki(n)}function sr(n){return Na(n)?n:new Ki(n).saturate(.5).darken(.1).hexString()}const sm=["x","y","borderWidth","radius","tension"],om=["color","borderColor","backgroundColor"];function rm(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:om},numbers:{type:"number",properties:sm}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function am(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const tc=new Map;function lm(n,t){t=t||{};const e=n+JSON.stringify(t);let i=tc.get(e);return i||(i=new Intl.NumberFormat(n,t),tc.set(e,i)),i}function fs(n,t,e){return lm(t,e).format(n)}const Fu={values(n){return lt(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const i=this.chart.options.locale;let s,o=n;if(e.length>1){const c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(s="scientific"),o=cm(n,e)}const r=je(Math.abs(o)),a=isNaN(r)?1:Math.max(Math.min(-1*Math.floor(r),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),fs(n,i,l)},logarithmic(n,t,e){if(n===0)return"0";const i=e[t].significand||n/Math.pow(10,Math.floor(je(n)));return[1,2,3,5,10,15].includes(i)||t>.8*e.length?Fu.numeric.call(this,n,t,e):""}};function cm(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var Do={formatters:Fu};function hm(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Do.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Sn=Object.create(null),Lr=Object.create(null);function Fi(n,t){if(!t)return n;const e=t.split(".");for(let i=0,s=e.length;i<s;++i){const o=e[i];n=n[o]||(n[o]=Object.create(null))}return n}function or(n,t,e){return typeof t=="string"?xe(Fi(n,t),e):xe(Fi(n,""),t)}class um{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,s)=>sr(s.backgroundColor),this.hoverBorderColor=(i,s)=>sr(s.borderColor),this.hoverColor=(i,s)=>sr(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return or(this,t,e)}get(t){return Fi(this,t)}describe(t,e){return or(Lr,t,e)}override(t,e){return or(Sn,t,e)}route(t,e,i,s){const o=Fi(this,t),r=Fi(this,i),a="_"+e;Object.defineProperties(o,{[a]:{value:o[e],writable:!0},[e]:{enumerable:!0,get(){const l=this[a],c=r[s];return j(l)?Object.assign({},c,l):O(l,c)},set(l){this[a]=l}}})}apply(t){t.forEach(e=>e(this))}}var ft=new um({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[rm,am,hm]);function dm(n){return!n||V(n.size)||V(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function ao(n,t,e,i,s){let o=t[s];return o||(o=t[s]=n.measureText(s).width,e.push(s)),o>i&&(i=o),i}function fm(n,t,e,i){i=i||{};let s=i.data=i.data||{},o=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(s=i.data={},o=i.garbageCollect=[],i.font=t),n.save(),n.font=t;let r=0;const a=e.length;let l,c,h,u,d;for(l=0;l<a;l++)if(u=e[l],u!=null&&!lt(u))r=ao(n,s,o,r,u);else if(lt(u))for(c=0,h=u.length;c<h;c++)d=u[c],d!=null&&!lt(d)&&(r=ao(n,s,o,r,d));n.restore();const f=o.length/2;if(f>e.length){for(l=0;l<f;l++)delete s[o[l]];o.splice(0,f)}return r}function an(n,t,e){const i=n.currentDevicePixelRatio,s=e!==0?Math.max(e/2,.5):0;return Math.round((t-s)*i)/i+s}function ec(n,t){t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore()}function Fr(n,t,e,i){Bu(n,t,e,i,null)}function Bu(n,t,e,i,s){let o,r,a,l,c,h,u,d;const f=t.pointStyle,p=t.rotation,g=t.radius;let m=(p||0)*Gg;if(f&&typeof f=="object"&&(o=f.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){n.save(),n.translate(e,i),n.rotate(m),n.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),n.restore();return}if(!(isNaN(g)||g<=0)){switch(n.beginPath(),f){default:s?n.ellipse(e,i,s/2,g,0,0,ct):n.arc(e,i,g,0,ct),n.closePath();break;case"triangle":h=s?s/2:g,n.moveTo(e+Math.sin(m)*h,i-Math.cos(m)*g),m+=ql,n.lineTo(e+Math.sin(m)*h,i-Math.cos(m)*g),m+=ql,n.lineTo(e+Math.sin(m)*h,i-Math.cos(m)*g),n.closePath();break;case"rectRounded":c=g*.516,l=g-c,r=Math.cos(m+rn)*l,u=Math.cos(m+rn)*(s?s/2-c:l),a=Math.sin(m+rn)*l,d=Math.sin(m+rn)*(s?s/2-c:l),n.arc(e-u,i-a,c,m-ht,m-mt),n.arc(e+d,i-r,c,m-mt,m),n.arc(e+u,i+a,c,m,m+mt),n.arc(e-d,i+r,c,m+mt,m+ht),n.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*g,h=s?s/2:l,n.rect(e-h,i-l,2*h,2*l);break}m+=rn;case"rectRot":u=Math.cos(m)*(s?s/2:g),r=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),n.moveTo(e-u,i-a),n.lineTo(e+d,i-r),n.lineTo(e+u,i+a),n.lineTo(e-d,i+r),n.closePath();break;case"crossRot":m+=rn;case"cross":u=Math.cos(m)*(s?s/2:g),r=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),n.moveTo(e-u,i-a),n.lineTo(e+u,i+a),n.moveTo(e+d,i-r),n.lineTo(e-d,i+r);break;case"star":u=Math.cos(m)*(s?s/2:g),r=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),n.moveTo(e-u,i-a),n.lineTo(e+u,i+a),n.moveTo(e+d,i-r),n.lineTo(e-d,i+r),m+=rn,u=Math.cos(m)*(s?s/2:g),r=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),n.moveTo(e-u,i-a),n.lineTo(e+u,i+a),n.moveTo(e+d,i-r),n.lineTo(e-d,i+r);break;case"line":r=s?s/2:Math.cos(m)*g,a=Math.sin(m)*g,n.moveTo(e-r,i-a),n.lineTo(e+r,i+a);break;case"dash":n.moveTo(e,i),n.lineTo(e+Math.cos(m)*(s?s/2:g),i+Math.sin(m)*g);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function De(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function Ro(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function Oo(n){n.restore()}function pm(n,t,e,i,s){if(!t)return n.lineTo(e.x,e.y);if(s==="middle"){const o=(t.x+e.x)/2;n.lineTo(o,t.y),n.lineTo(o,e.y)}else s==="after"!=!!i?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function gm(n,t,e,i){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?e.cp2x:e.cp1x,i?e.cp2y:e.cp1y,e.x,e.y)}function mm(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),V(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function _m(n,t,e,i,s){if(s.strikethrough||s.underline){const o=n.measureText(i),r=t-o.actualBoundingBoxLeft,a=t+o.actualBoundingBoxRight,l=e-o.actualBoundingBoxAscent,c=e+o.actualBoundingBoxDescent,h=s.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(r,h),n.lineTo(a,h),n.stroke()}}function bm(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function En(n,t,e,i,s,o={}){const r=lt(t)?t:[t],a=o.strokeWidth>0&&o.strokeColor!=="";let l,c;for(n.save(),n.font=s.string,mm(n,o),l=0;l<r.length;++l)c=r[l],o.backdrop&&bm(n,o.backdrop),a&&(o.strokeColor&&(n.strokeStyle=o.strokeColor),V(o.strokeWidth)||(n.lineWidth=o.strokeWidth),n.strokeText(c,e,i,o.maxWidth)),n.fillText(c,e,i,o.maxWidth),_m(n,e,i,c,o),i+=Number(s.lineHeight);n.restore()}function Ji(n,t){const{x:e,y:i,w:s,h:o,radius:r}=t;n.arc(e+r.topLeft,i+r.topLeft,r.topLeft,1.5*ht,ht,!0),n.lineTo(e,i+o-r.bottomLeft),n.arc(e+r.bottomLeft,i+o-r.bottomLeft,r.bottomLeft,ht,mt,!0),n.lineTo(e+s-r.bottomRight,i+o),n.arc(e+s-r.bottomRight,i+o-r.bottomRight,r.bottomRight,mt,0,!0),n.lineTo(e+s,i+r.topRight),n.arc(e+s-r.topRight,i+r.topRight,r.topRight,0,-mt,!0),n.lineTo(e+r.topLeft,i)}const ym=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,vm=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function xm(n,t){const e=(""+n).match(ym);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const wm=n=>+n||0;function La(n,t){const e={},i=j(t),s=i?Object.keys(t):t,o=j(n)?i?r=>O(n[r],n[t[r]]):r=>n[r]:()=>n;for(const r of s)e[r]=wm(o(r));return e}function Hu(n){return La(n,{top:"y",right:"x",bottom:"y",left:"x"})}function vn(n){return La(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Nt(n){const t=Hu(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function vt(n,t){n=n||{},t=t||ft.font;let e=O(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let i=O(n.style,t.style);i&&!(""+i).match(vm)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const s={family:O(n.family,t.family),lineHeight:xm(O(n.lineHeight,t.lineHeight),e),size:e,style:i,weight:O(n.weight,t.weight),string:""};return s.string=dm(s),s}function rt(n,t,e,i){let s=!0,o,r,a;for(o=0,r=n.length;o<r;++o)if(a=n[o],a!==void 0&&(t!==void 0&&typeof a=="function"&&(a=a(t),s=!1),e!==void 0&&lt(a)&&(a=a[e%a.length],s=!1),a!==void 0))return i&&!s&&(i.cacheable=!1),a}function Cm(n,t,e){const{min:i,max:s}=n,o=ku(t,(s-i)/2),r=(a,l)=>e&&a===0?0:a+l;return{min:r(i,-Math.abs(o)),max:r(s,o)}}function on(n,t){return Object.assign(Object.create(n),t)}function Fa(n,t=[""],e,i,s=()=>n[0]){const o=e||n;typeof i>"u"&&(i=$u("_fallback",n));const r={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:o,_fallback:i,_getTarget:s,override:a=>Fa([a,...n],t,o,i)};return new Proxy(r,{deleteProperty(a,l){return delete a[l],delete a._keys,delete n[0][l],!0},get(a,l){return zu(a,l,()=>Pm(l,t,n,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,l){return ic(a).includes(l)},ownKeys(a){return ic(a)},set(a,l,c){const h=a._storage||(a._storage=s());return a[l]=h[l]=c,delete a._keys,!0}})}function ti(n,t,e,i){const s={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:Wu(n,i),setContext:o=>ti(n,o,e,i),override:o=>ti(n.override(o),t,e,i)};return new Proxy(s,{deleteProperty(o,r){return delete o[r],delete n[r],!0},get(o,r,a){return zu(o,r,()=>Em(o,r,a))},getOwnPropertyDescriptor(o,r){return o._descriptors.allKeys?Reflect.has(n,r)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,r)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(o,r){return Reflect.has(n,r)},ownKeys(){return Reflect.ownKeys(n)},set(o,r,a){return n[r]=a,delete o[r],!0}})}function Wu(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:i=t.indexable,_allKeys:s=t.allKeys}=n;return{allKeys:s,scriptable:e,indexable:i,isScriptable:tn(e)?e:()=>e,isIndexable:tn(i)?i:()=>i}}const Sm=(n,t)=>n?n+Pa(t):t,Ba=(n,t)=>j(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function zu(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t))return n[t];const i=e();return n[t]=i,i}function Em(n,t,e){const{_proxy:i,_context:s,_subProxy:o,_descriptors:r}=n;let a=i[t];return tn(a)&&r.isScriptable(t)&&(a=Tm(t,a,n,e)),lt(a)&&a.length&&(a=km(t,a,n,r.isIndexable)),Ba(t,a)&&(a=ti(a,s,o&&o[t],r)),a}function Tm(n,t,e,i){const{_proxy:s,_context:o,_subProxy:r,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=t(o,r||i);return a.delete(n),Ba(n,l)&&(l=Ha(s._scopes,s,n,l)),l}function km(n,t,e,i){const{_proxy:s,_context:o,_subProxy:r,_descriptors:a}=e;if(typeof o.index<"u"&&i(n))return t[o.index%t.length];if(j(t[0])){const l=t,c=s._scopes.filter(h=>h!==l);t=[];for(const h of l){const u=Ha(c,s,n,h);t.push(ti(u,o,r&&r[n],a))}}return t}function Vu(n,t,e){return tn(n)?n(t,e):n}const Im=(n,t)=>n===!0?t:typeof n=="string"?Ze(t,n):void 0;function Mm(n,t,e,i,s){for(const o of t){const r=Im(e,o);if(r){n.add(r);const a=Vu(r._fallback,e,s);if(typeof a<"u"&&a!==e&&a!==i)return a}else if(r===!1&&typeof i<"u"&&e!==i)return null}return!1}function Ha(n,t,e,i){const s=t._rootScopes,o=Vu(t._fallback,e,i),r=[...n,...s],a=new Set;a.add(i);let l=nc(a,r,e,o||e,i);return l===null||typeof o<"u"&&o!==e&&(l=nc(a,r,o,l,i),l===null)?!1:Fa(Array.from(a),[""],s,o,()=>Am(t,e,i))}function nc(n,t,e,i,s){for(;e;)e=Mm(n,t,e,i,s);return e}function Am(n,t,e){const i=n._getTarget();t in i||(i[t]={});const s=i[t];return lt(s)&&j(e)?e:s||{}}function Pm(n,t,e,i){let s;for(const o of t)if(s=$u(Sm(o,n),e),typeof s<"u")return Ba(n,s)?Ha(e,i,n,s):s}function $u(n,t){for(const e of t){if(!e)continue;const i=e[n];if(typeof i<"u")return i}}function ic(n){let t=n._keys;return t||(t=n._keys=Dm(n._scopes)),t}function Dm(n){const t=new Set;for(const e of n)for(const i of Object.keys(e).filter(s=>!s.startsWith("_")))t.add(i);return Array.from(t)}function ju(n,t,e,i){const{iScale:s}=n,{key:o="r"}=this._parsing,r=new Array(i);let a,l,c,h;for(a=0,l=i;a<l;++a)c=a+e,h=t[c],r[a]={r:s.parse(Ze(h,o),c)};return r}const Rm=Number.EPSILON||1e-14,ei=(n,t)=>t<n.length&&!n[t].skip&&n[t],Uu=n=>n==="x"?"y":"x";function Om(n,t,e,i){const s=n.skip?t:n,o=t,r=e.skip?t:e,a=Nr(o,s),l=Nr(r,o);let c=a/(a+l),h=l/(a+l);c=isNaN(c)?0:c,h=isNaN(h)?0:h;const u=i*c,d=i*h;return{previous:{x:o.x-u*(r.x-s.x),y:o.y-u*(r.y-s.y)},next:{x:o.x+d*(r.x-s.x),y:o.y+d*(r.y-s.y)}}}function Nm(n,t,e){const i=n.length;let s,o,r,a,l,c=ei(n,0);for(let h=0;h<i-1;++h)if(l=c,c=ei(n,h+1),!(!l||!c)){if(Ni(t[h],0,Rm)){e[h]=e[h+1]=0;continue}s=e[h]/t[h],o=e[h+1]/t[h],a=Math.pow(s,2)+Math.pow(o,2),!(a<=9)&&(r=3/Math.sqrt(a),e[h]=s*r*t[h],e[h+1]=o*r*t[h])}}function Lm(n,t,e="x"){const i=Uu(e),s=n.length;let o,r,a,l=ei(n,0);for(let c=0;c<s;++c){if(r=a,a=l,l=ei(n,c+1),!a)continue;const h=a[e],u=a[i];r&&(o=(h-r[e])/3,a[`cp1${e}`]=h-o,a[`cp1${i}`]=u-o*t[c]),l&&(o=(l[e]-h)/3,a[`cp2${e}`]=h+o,a[`cp2${i}`]=u+o*t[c])}}function Fm(n,t="x"){const e=Uu(t),i=n.length,s=Array(i).fill(0),o=Array(i);let r,a,l,c=ei(n,0);for(r=0;r<i;++r)if(a=l,l=c,c=ei(n,r+1),!!l){if(c){const h=c[t]-l[t];s[r]=h!==0?(c[e]-l[e])/h:0}o[r]=a?c?be(s[r-1])!==be(s[r])?0:(s[r-1]+s[r])/2:s[r-1]:s[r]}Nm(n,s,o),Lm(n,o,t)}function Ds(n,t,e){return Math.max(Math.min(n,e),t)}function Bm(n,t){let e,i,s,o,r,a=De(n[0],t);for(e=0,i=n.length;e<i;++e)r=o,o=a,a=e<i-1&&De(n[e+1],t),o&&(s=n[e],r&&(s.cp1x=Ds(s.cp1x,t.left,t.right),s.cp1y=Ds(s.cp1y,t.top,t.bottom)),a&&(s.cp2x=Ds(s.cp2x,t.left,t.right),s.cp2y=Ds(s.cp2y,t.top,t.bottom)))}function Hm(n,t,e,i,s){let o,r,a,l;if(t.spanGaps&&(n=n.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")Fm(n,s);else{let c=i?n[n.length-1]:n[0];for(o=0,r=n.length;o<r;++o)a=n[o],l=Om(c,a,n[Math.min(o+1,r-(i?0:1))%r],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}t.capBezierPoints&&Bm(n,e)}function Wa(){return typeof window<"u"&&typeof document<"u"}function za(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function lo(n,t,e){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*t.parentNode[e])):i=n,i}const No=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function Wm(n,t){return No(n).getPropertyValue(t)}const zm=["top","right","bottom","left"];function xn(n,t,e){const i={};e=e?"-"+e:"";for(let s=0;s<4;s++){const o=zm[s];i[o]=parseFloat(n[t+"-"+o+e])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const Vm=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function $m(n,t){const e=n.touches,i=e&&e.length?e[0]:n,{offsetX:s,offsetY:o}=i;let r=!1,a,l;if(Vm(s,o,n.target))a=s,l=o;else{const c=t.getBoundingClientRect();a=i.clientX-c.left,l=i.clientY-c.top,r=!0}return{x:a,y:l,box:r}}function un(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:i}=t,s=No(e),o=s.boxSizing==="border-box",r=xn(s,"padding"),a=xn(s,"border","width"),{x:l,y:c,box:h}=$m(n,e),u=r.left+(h&&a.left),d=r.top+(h&&a.top);let{width:f,height:p}=t;return o&&(f-=r.width+a.width,p-=r.height+a.height),{x:Math.round((l-u)/f*e.width/i),y:Math.round((c-d)/p*e.height/i)}}function jm(n,t,e){let i,s;if(t===void 0||e===void 0){const o=za(n);if(!o)t=n.clientWidth,e=n.clientHeight;else{const r=o.getBoundingClientRect(),a=No(o),l=xn(a,"border","width"),c=xn(a,"padding");t=r.width-c.width-l.width,e=r.height-c.height-l.height,i=lo(a.maxWidth,o,"clientWidth"),s=lo(a.maxHeight,o,"clientHeight")}}return{width:t,height:e,maxWidth:i||ro,maxHeight:s||ro}}const Rs=n=>Math.round(n*10)/10;function Um(n,t,e,i){const s=No(n),o=xn(s,"margin"),r=lo(s.maxWidth,n,"clientWidth")||ro,a=lo(s.maxHeight,n,"clientHeight")||ro,l=jm(n,t,e);let{width:c,height:h}=l;if(s.boxSizing==="content-box"){const d=xn(s,"border","width"),f=xn(s,"padding");c-=f.width+d.width,h-=f.height+d.height}return c=Math.max(0,c-o.width),h=Math.max(0,i?c/i:h-o.height),c=Rs(Math.min(c,r,l.maxWidth)),h=Rs(Math.min(h,a,l.maxHeight)),c&&!h&&(h=Rs(c/2)),(t!==void 0||e!==void 0)&&i&&l.height&&h>l.height&&(h=l.height,c=Rs(Math.floor(h*i))),{width:c,height:h}}function sc(n,t,e){const i=t||1,s=Math.floor(n.height*i),o=Math.floor(n.width*i);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const r=n.canvas;return r.style&&(e||!r.style.height&&!r.style.width)&&(r.style.height=`${n.height}px`,r.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||r.height!==s||r.width!==o?(n.currentDevicePixelRatio=i,r.height=s,r.width=o,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const Ym=function(){let n=!1;try{const t={get passive(){return n=!0,!1}};Wa()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n}();function oc(n,t){const e=Wm(n,t),i=e&&e.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function dn(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function qm(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:i==="middle"?e<.5?n.y:t.y:i==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function Gm(n,t,e,i){const s={x:n.cp2x,y:n.cp2y},o={x:t.cp1x,y:t.cp1y},r=dn(n,s,e),a=dn(s,o,e),l=dn(o,t,e),c=dn(r,a,e),h=dn(a,l,e);return dn(c,h,e)}const Km=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,i){return e-i},leftForLtr(e,i){return e-i}}},Xm=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function Gn(n,t,e){return n?Km(t,e):Xm()}function Yu(n,t){let e,i;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,i=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=i)}function qu(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function Gu(n){return n==="angle"?{between:Qi,compare:Qg,normalize:Qt}:{between:Ae,compare:(t,e)=>t-e,normalize:t=>t}}function rc({start:n,end:t,count:e,loop:i,style:s}){return{start:n%e,end:t%e,loop:i&&(t-n+1)%e===0,style:s}}function Qm(n,t,e){const{property:i,start:s,end:o}=e,{between:r,normalize:a}=Gu(i),l=t.length;let{start:c,end:h,loop:u}=n,d,f;if(u){for(c+=l,h+=l,d=0,f=l;d<f&&r(a(t[c%l][i]),s,o);++d)c--,h--;c%=l,h%=l}return h<c&&(h+=l),{start:c,end:h,loop:u,style:n.style}}function Ku(n,t,e){if(!e)return[n];const{property:i,start:s,end:o}=e,r=t.length,{compare:a,between:l,normalize:c}=Gu(i),{start:h,end:u,loop:d,style:f}=Qm(n,t,e),p=[];let g=!1,m=null,_,b,x;const C=()=>l(s,x,_)&&a(s,x)!==0,v=()=>a(o,_)===0||l(o,x,_),w=()=>g||C(),E=()=>!g||v();for(let T=h,M=h;T<=u;++T)b=t[T%r],!b.skip&&(_=c(b[i]),_!==x&&(g=l(_,s,o),m===null&&w()&&(m=a(_,s)===0?T:M),m!==null&&E()&&(p.push(rc({start:m,end:T,loop:d,count:r,style:f})),m=null),M=T,x=_));return m!==null&&p.push(rc({start:m,end:u,loop:d,count:r,style:f})),p}function Xu(n,t){const e=[],i=n.segments;for(let s=0;s<i.length;s++){const o=Ku(i[s],n.points,t);o.length&&e.push(...o)}return e}function Jm(n,t,e,i){let s=0,o=t-1;if(e&&!i)for(;s<t&&!n[s].skip;)s++;for(;s<t&&n[s].skip;)s++;for(s%=t,e&&(o+=s);o>s&&n[o%t].skip;)o--;return o%=t,{start:s,end:o}}function Zm(n,t,e,i){const s=n.length,o=[];let r=t,a=n[t],l;for(l=t+1;l<=e;++l){const c=n[l%s];c.skip||c.stop?a.skip||(i=!1,o.push({start:t%s,end:(l-1)%s,loop:i}),t=r=c.stop?l:null):(r=l,a.skip&&(t=l)),a=c}return r!==null&&o.push({start:t%s,end:r%s,loop:i}),o}function t_(n,t){const e=n.points,i=n.options.spanGaps,s=e.length;if(!s)return[];const o=!!n._loop,{start:r,end:a}=Jm(e,s,o,i);if(i===!0)return ac(n,[{start:r,end:a,loop:o}],e,t);const l=a<r?a+s:a,c=!!n._fullLoop&&r===0&&a===s-1;return ac(n,Zm(e,r,l,c),e,t)}function ac(n,t,e,i){return!i||!i.setContext||!e?t:e_(n,t,e,i)}function e_(n,t,e,i){const s=n._chart.getContext(),o=lc(n.options),{_datasetIndex:r,options:{spanGaps:a}}=n,l=e.length,c=[];let h=o,u=t[0].start,d=u;function f(p,g,m,_){const b=a?-1:1;if(p!==g){for(p+=l;e[p%l].skip;)p-=b;for(;e[g%l].skip;)g+=b;p%l!==g%l&&(c.push({start:p%l,end:g%l,loop:m,style:_}),h=_,u=g%l)}}for(const p of t){u=a?u:p.start;let g=e[u%l],m;for(d=u+1;d<=p.end;d++){const _=e[d%l];m=lc(i.setContext(on(s,{type:"segment",p0:g,p1:_,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:r}))),n_(m,h)&&f(u,d-1,p.loop,h),g=_,h=m}u<d-1&&f(u,d-1,p.loop,h)}return c}function lc(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function n_(n,t){if(!t)return!1;const e=[],i=function(s,o){return Na(o)?(e.includes(o)||e.push(o),e.indexOf(o)):o};return JSON.stringify(n,i)!==JSON.stringify(t,i)}/*!
 * Chart.js v4.4.2
 * https://www.chartjs.org
 * (c) 2024 Chart.js Contributors
 * Released under the MIT License
 */class i_{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,s){const o=e.listeners[s],r=e.duration;o.forEach(a=>a({chart:t,initial:e.initial,numSteps:r,currentStep:Math.min(i-e.start,r)}))}_refresh(){this._request||(this._running=!0,this._request=Ru.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const o=i.items;let r=o.length-1,a=!1,l;for(;r>=0;--r)l=o[r],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(t),a=!0):(o[r]=o[o.length-1],o.pop());a&&(s.draw(),this._notify(s,i,t,"progress")),o.length||(i.running=!1,this._notify(s,i,t,"complete"),i.initial=!1),e+=o.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var ke=new i_;const cc="transparent",s_={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const i=Zl(n||cc),s=i.valid&&Zl(t||cc);return s&&s.valid?s.mix(i,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class o_{constructor(t,e,i,s){const o=e[i];s=rt([t.to,s,o,t.from]);const r=rt([t.from,o,s]);this._active=!0,this._fn=t.fn||s_[t.type||typeof r],this._easing=Li[t.easing]||Li.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=r,this._to=s,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const s=this._target[this._prop],o=i-this._start,r=this._duration-o;this._start=i,this._duration=Math.floor(Math.max(r,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=rt([t.to,e,s,t.from]),this._from=rt([t.from,s,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,s=this._prop,o=this._from,r=this._loop,a=this._to;let l;if(this._active=o!==a&&(r||e<i),!this._active){this._target[s]=a,this._notify(!0);return}if(e<0){this._target[s]=o;return}l=e/i%2,l=r&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[s]=this._fn(o,a,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,i)=>{t.push({res:e,rej:i})})}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][e]()}}class Qu{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!j(t))return;const e=Object.keys(ft.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const o=t[s];if(!j(o))return;const r={};for(const a of e)r[a]=o[a];(lt(o.properties)&&o.properties||[s]).forEach(a=>{(a===s||!i.has(a))&&i.set(a,r)})})}_animateOptions(t,e){const i=e.options,s=a_(t,i);if(!s)return[];const o=this._createAnimations(s,i);return i.$shared&&r_(t.options.$animations,i).then(()=>{t.options=i},()=>{}),o}_createAnimations(t,e){const i=this._properties,s=[],o=t.$animations||(t.$animations={}),r=Object.keys(e),a=Date.now();let l;for(l=r.length-1;l>=0;--l){const c=r[l];if(c.charAt(0)==="$")continue;if(c==="options"){s.push(...this._animateOptions(t,e));continue}const h=e[c];let u=o[c];const d=i.get(c);if(u)if(d&&u.active()){u.update(d,h,a);continue}else u.cancel();if(!d||!d.duration){t[c]=h;continue}o[c]=u=new o_(d,t,c,h),s.push(u)}return s}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const i=this._createAnimations(t,e);if(i.length)return ke.add(this._chart,i),!0}}function r_(n,t){const e=[],i=Object.keys(t);for(let s=0;s<i.length;s++){const o=n[i[s]];o&&o.active()&&e.push(o.wait())}return Promise.all(e)}function a_(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function hc(n,t){const e=n&&n.options||{},i=e.reverse,s=e.min===void 0?t:0,o=e.max===void 0?t:0;return{start:i?o:s,end:i?s:o}}function l_(n,t,e){if(e===!1)return!1;const i=hc(n,e),s=hc(t,e);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function c_(n){let t,e,i,s;return j(n)?(t=n.top,e=n.right,i=n.bottom,s=n.left):t=e=i=s=n,{top:t,right:e,bottom:i,left:s,disabled:n===!1}}function Ju(n,t){const e=[],i=n._getSortedDatasetMetas(t);let s,o;for(s=0,o=i.length;s<o;++s)e.push(i[s].index);return e}function uc(n,t,e,i={}){const s=n.keys,o=i.mode==="single";let r,a,l,c;if(t!==null){for(r=0,a=s.length;r<a;++r){if(l=+s[r],l===e){if(i.all)continue;break}c=n.values[l],pt(c)&&(o||t===0||be(t)===be(c))&&(t+=c)}return t}}function h_(n){const t=Object.keys(n),e=new Array(t.length);let i,s,o;for(i=0,s=t.length;i<s;++i)o=t[i],e[i]={x:o,y:n[o]};return e}function dc(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function u_(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function d_(n){const{min:t,max:e,minDefined:i,maxDefined:s}=n.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:s?e:Number.POSITIVE_INFINITY}}function f_(n,t,e){const i=n[t]||(n[t]={});return i[e]||(i[e]={})}function fc(n,t,e,i){for(const s of t.getMatchingVisibleMetas(i).reverse()){const o=n[s.index];if(e&&o>0||!e&&o<0)return s.index}return null}function pc(n,t){const{chart:e,_cachedMeta:i}=n,s=e._stacks||(e._stacks={}),{iScale:o,vScale:r,index:a}=i,l=o.axis,c=r.axis,h=u_(o,r,i),u=t.length;let d;for(let f=0;f<u;++f){const p=t[f],{[l]:g,[c]:m}=p,_=p._stacks||(p._stacks={});d=_[c]=f_(s,h,g),d[a]=m,d._top=fc(d,r,!0,i.type),d._bottom=fc(d,r,!1,i.type);const b=d._visualValues||(d._visualValues={});b[a]=m}}function rr(n,t){const e=n.scales;return Object.keys(e).filter(i=>e[i].axis===t).shift()}function p_(n,t){return on(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function g_(n,t,e){return on(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function gi(n,t){const e=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){t=t||n._parsed;for(const s of t){const o=s._stacks;if(!o||o[i]===void 0||o[i][e]===void 0)return;delete o[i][e],o[i]._visualValues!==void 0&&o[i]._visualValues[e]!==void 0&&delete o[i]._visualValues[e]}}}const ar=n=>n==="reset"||n==="none",gc=(n,t)=>t?n:Object.assign({},n),m_=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:Ju(e,!0),values:null};class ue{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=dc(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&gi(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),s=(u,d,f,p)=>u==="x"?d:u==="r"?p:f,o=e.xAxisID=O(i.xAxisID,rr(t,"x")),r=e.yAxisID=O(i.yAxisID,rr(t,"y")),a=e.rAxisID=O(i.rAxisID,rr(t,"r")),l=e.indexAxis,c=e.iAxisID=s(l,o,r,a),h=e.vAxisID=s(l,r,o,a);e.xScale=this.getScaleForId(o),e.yScale=this.getScaleForId(r),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Xl(this._data,this),t._stacked&&gi(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(j(e))this._data=h_(e);else if(i!==e){if(i){Xl(i,this);const s=this._cachedMeta;gi(s),s._parsed=[]}e&&Object.isExtensible(e)&&em(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const o=e._stacked;e._stacked=dc(e.vScale,e),e.stack!==i.stack&&(s=!0,gi(e),e.stack=i.stack),this._resyncElements(t),(s||o!==e._stacked)&&pc(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:s}=this,{iScale:o,_stacked:r}=i,a=o.axis;let l=t===0&&e===s.length?!0:i._sorted,c=t>0&&i._parsed[t-1],h,u,d;if(this._parsing===!1)i._parsed=s,i._sorted=!0,d=s;else{lt(s[t])?d=this.parseArrayData(i,s,t,e):j(s[t])?d=this.parseObjectData(i,s,t,e):d=this.parsePrimitiveData(i,s,t,e);const f=()=>u[a]===null||c&&u[a]<c[a];for(h=0;h<e;++h)i._parsed[h+t]=u=d[h],l&&(f()&&(l=!1),c=u);i._sorted=l}r&&pc(this,d)}parsePrimitiveData(t,e,i,s){const{iScale:o,vScale:r}=t,a=o.axis,l=r.axis,c=o.getLabels(),h=o===r,u=new Array(s);let d,f,p;for(d=0,f=s;d<f;++d)p=d+i,u[d]={[a]:h||o.parse(c[p],p),[l]:r.parse(e[p],p)};return u}parseArrayData(t,e,i,s){const{xScale:o,yScale:r}=t,a=new Array(s);let l,c,h,u;for(l=0,c=s;l<c;++l)h=l+i,u=e[h],a[l]={x:o.parse(u[0],h),y:r.parse(u[1],h)};return a}parseObjectData(t,e,i,s){const{xScale:o,yScale:r}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(s);let h,u,d,f;for(h=0,u=s;h<u;++h)d=h+i,f=e[d],c[h]={x:o.parse(Ze(f,a),d),y:r.parse(Ze(f,l),d)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const s=this.chart,o=this._cachedMeta,r=e[t.axis],a={keys:Ju(s,!0),values:e._stacks[t.axis]._visualValues};return uc(a,r,o.index,{mode:i})}updateRangeFromParsed(t,e,i,s){const o=i[e.axis];let r=o===null?NaN:o;const a=s&&i._stacks[e.axis];s&&a&&(s.values=a,r=uc(s,o,this._cachedMeta.index)),t.min=Math.min(t.min,r),t.max=Math.max(t.max,r)}getMinMax(t,e){const i=this._cachedMeta,s=i._parsed,o=i._sorted&&t===i.iScale,r=s.length,a=this._getOtherScale(t),l=m_(e,i,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:u}=d_(a);let d,f;function p(){f=s[d];const g=f[a.axis];return!pt(f[t.axis])||h>g||u<g}for(d=0;d<r&&!(!p()&&(this.updateRangeFromParsed(c,t,f,l),o));++d);if(o){for(d=r-1;d>=0;--d)if(!p()){this.updateRangeFromParsed(c,t,f,l);break}}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let s,o,r;for(s=0,o=e.length;s<o;++s)r=e[s][t.axis],pt(r)&&i.push(r);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,s=e.vScale,o=this.getParsed(t);return{label:i?""+i.getLabelForValue(o[i.axis]):"",value:s?""+s.getLabelForValue(o[s.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=c_(O(this.options.clip,l_(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,s=i.data||[],o=e.chartArea,r=[],a=this._drawStart||0,l=this._drawCount||s.length-a,c=this.options.drawActiveElementsOnTop;let h;for(i.dataset&&i.dataset.draw(t,o,a,l),h=a;h<a+l;++h){const u=s[h];u.hidden||(u.active&&c?r.push(u):u.draw(t,o))}for(h=0;h<r.length;++h)r[h].draw(t,o)}getStyle(t,e){const i=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const s=this.getDataset();let o;if(t>=0&&t<this._cachedMeta.data.length){const r=this._cachedMeta.data[t];o=r.$context||(r.$context=g_(this.getContext(),t,r)),o.parsed=this.getParsed(t),o.raw=s.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=p_(this.chart.getContext(),this.index)),o.dataset=s,o.index=o.datasetIndex=this.index;return o.active=!!e,o.mode=i,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){const s=e==="active",o=this._cachedDataOpts,r=t+"-"+e,a=o[r],l=this.enableOptionSharing&&Xi(i);if(a)return gc(a,l);const c=this.chart.config,h=c.datasetElementScopeKeys(this._type,t),u=s?[`${t}Hover`,"hover",t,""]:[t,""],d=c.getOptionScopes(this.getDataset(),h),f=Object.keys(ft.elements[t]),p=()=>this.getContext(i,s,e),g=c.resolveNamedOptions(d,f,p,u);return g.$shared&&(g.$shared=l,o[r]=Object.freeze(gc(g,l))),g}_resolveAnimations(t,e,i){const s=this.chart,o=this._cachedDataOpts,r=`animation-${e}`,a=o[r];if(a)return a;let l;if(s.options.animation!==!1){const h=this.chart.config,u=h.datasetAnimationScopeKeys(this._type,e),d=h.getOptionScopes(this.getDataset(),u);l=h.createResolver(d,this.getContext(t,i,e))}const c=new Qu(s,l&&l.animations);return l&&l._cacheable&&(o[r]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||ar(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),s=this._sharedOptions,o=this.getSharedOptions(i),r=this.includeOptions(e,o)||o!==s;return this.updateSharedOptions(o,e,i),{sharedOptions:o,includeOptions:r}}updateElement(t,e,i,s){ar(s)?Object.assign(t,i):this._resolveAnimations(e,s).update(t,i)}updateSharedOptions(t,e,i){t&&!ar(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,s){t.active=s;const o=this.getStyle(e,s);this._resolveAnimations(e,i,s).update(t,{options:!s&&this.getSharedOptions(o)||o})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const s=i.length,o=e.length,r=Math.min(o,s);r&&this.parse(0,r),o>s?this._insertElements(s,o-s,t):o<s&&this._removeElements(o,s-o)}_insertElements(t,e,i=!0){const s=this._cachedMeta,o=s.data,r=t+e;let a;const l=c=>{for(c.length+=e,a=c.length-1;a>=r;a--)c[a]=c[a-e]};for(l(o),a=t;a<r;++a)o[a]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(t,e),i&&this.updateElements(o,t,e,"reset")}updateElements(t,e,i,s){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(t,e);i._stacked&&gi(i,s)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,s]=t;this[e](i,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}I(ue,"defaults",{}),I(ue,"datasetElementType",null),I(ue,"dataElementType",null);function __(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let i=[];for(let s=0,o=e.length;s<o;s++)i=i.concat(e[s].controller.getAllParsedValues(n));n._cache.$bar=Du(i.sort((s,o)=>s-o))}return n._cache.$bar}function b_(n){const t=n.iScale,e=__(t,n.type);let i=t._length,s,o,r,a;const l=()=>{r===32767||r===-32768||(Xi(a)&&(i=Math.min(i,Math.abs(r-a)||i)),a=r)};for(s=0,o=e.length;s<o;++s)r=t.getPixelForValue(e[s]),l();for(a=void 0,s=0,o=t.ticks.length;s<o;++s)r=t.getPixelForTick(s),l();return i}function y_(n,t,e,i){const s=e.barThickness;let o,r;return V(s)?(o=t.min*e.categoryPercentage,r=e.barPercentage):(o=s*i,r=1),{chunk:o/i,ratio:r,start:t.pixels[n]-o/2}}function v_(n,t,e,i){const s=t.pixels,o=s[n];let r=n>0?s[n-1]:null,a=n<s.length-1?s[n+1]:null;const l=e.categoryPercentage;r===null&&(r=o-(a===null?t.end-t.start:a-o)),a===null&&(a=o+o-r);const c=o-(o-Math.min(r,a))/2*l;return{chunk:Math.abs(a-r)/2*l/i,ratio:e.barPercentage,start:c}}function x_(n,t,e,i){const s=e.parse(n[0],i),o=e.parse(n[1],i),r=Math.min(s,o),a=Math.max(s,o);let l=r,c=a;Math.abs(r)>Math.abs(a)&&(l=a,c=r),t[e.axis]=c,t._custom={barStart:l,barEnd:c,start:s,end:o,min:r,max:a}}function Zu(n,t,e,i){return lt(n)?x_(n,t,e,i):t[e.axis]=e.parse(n,i),t}function mc(n,t,e,i){const s=n.iScale,o=n.vScale,r=s.getLabels(),a=s===o,l=[];let c,h,u,d;for(c=e,h=e+i;c<h;++c)d=t[c],u={},u[s.axis]=a||s.parse(r[c],c),l.push(Zu(d,u,o,c));return l}function lr(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function w_(n,t,e){return n!==0?be(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function C_(n){let t,e,i,s,o;return n.horizontal?(t=n.base>n.x,e="left",i="right"):(t=n.base<n.y,e="bottom",i="top"),t?(s="end",o="start"):(s="start",o="end"),{start:e,end:i,reverse:t,top:s,bottom:o}}function S_(n,t,e,i){let s=t.borderSkipped;const o={};if(!s){n.borderSkipped=o;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:r,end:a,reverse:l,top:c,bottom:h}=C_(n);s==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===i?s=c:(e._bottom||0)===i?s=h:(o[_c(h,r,a,l)]=!0,s=c)),o[_c(s,r,a,l)]=!0,n.borderSkipped=o}function _c(n,t,e,i){return i?(n=E_(n,t,e),n=bc(n,e,t)):n=bc(n,t,e),n}function E_(n,t,e){return n===t?e:n===e?t:n}function bc(n,t,e){return n==="start"?t:n==="end"?e:n}function T_(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}class Qs extends ue{parsePrimitiveData(t,e,i,s){return mc(t,e,i,s)}parseArrayData(t,e,i,s){return mc(t,e,i,s)}parseObjectData(t,e,i,s){const{iScale:o,vScale:r}=t,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=o.axis==="x"?a:l,h=r.axis==="x"?a:l,u=[];let d,f,p,g;for(d=i,f=i+s;d<f;++d)g=e[d],p={},p[o.axis]=o.parse(Ze(g,c),d),u.push(Zu(Ze(g,h),p,r,d));return u}updateRangeFromParsed(t,e,i,s){super.updateRangeFromParsed(t,e,i,s);const o=i._custom;o&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:s}=e,o=this.getParsed(t),r=o._custom,a=lr(r)?"["+r.start+", "+r.end+"]":""+s.getLabelForValue(o[s.axis]);return{label:""+i.getLabelForValue(o[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,s){const o=s==="reset",{index:r,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),h=this._getRuler(),{sharedOptions:u,includeOptions:d}=this._getSharedOptions(e,s);for(let f=e;f<e+i;f++){const p=this.getParsed(f),g=o||V(p[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),m=this._calculateBarIndexPixels(f,h),_=(p._stacks||{})[a.axis],b={horizontal:c,base:g.base,enableBorderRadius:!_||lr(p._custom)||r===_._top||r===_._bottom,x:c?g.head:m.center,y:c?m.center:g.head,height:c?m.size:Math.abs(g.size),width:c?Math.abs(g.size):m.size};d&&(b.options=u||this.resolveDataElementOptions(f,t[f].active?"active":s));const x=b.options||t[f].options;S_(b,x,_,r),T_(b,x,h.ratio),this.updateElement(t[f],f,b,s)}}_getStacks(t,e){const{iScale:i}=this._cachedMeta,s=i.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),o=i.options.stacked,r=[],a=l=>{const c=l.controller.getParsed(e),h=c&&c[l.vScale.axis];if(V(h)||isNaN(h))return!0};for(const l of s)if(!(e!==void 0&&a(l))&&((o===!1||r.indexOf(l.stack)===-1||o===void 0&&l.stack===void 0)&&r.push(l.stack),l.index===t))break;return r.length||r.push(void 0),r}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,i){const s=this._getStacks(t,i),o=e!==void 0?s.indexOf(e):-1;return o===-1?s.length-1:o}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,s=[];let o,r;for(o=0,r=e.data.length;o<r;++o)s.push(i.getPixelForValue(this.getParsed(o)[i.axis],o));const a=t.barThickness;return{min:a||b_(e),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:i,index:s},options:{base:o,minBarLength:r}}=this,a=o||0,l=this.getParsed(t),c=l._custom,h=lr(c);let u=l[e.axis],d=0,f=i?this.applyStack(e,l,i):u,p,g;f!==u&&(d=f-u,f=u),h&&(u=c.barStart,f=c.barEnd-c.barStart,u!==0&&be(u)!==be(c.barEnd)&&(d=0),d+=u);const m=!V(o)&&!h?o:d;let _=e.getPixelForValue(m);if(this.chart.getDataVisibility(t)?p=e.getPixelForValue(d+f):p=_,g=p-_,Math.abs(g)<r){g=w_(g,e,a)*r,u===a&&(_-=g/2);const b=e.getPixelForDecimal(0),x=e.getPixelForDecimal(1),C=Math.min(b,x),v=Math.max(b,x);_=Math.max(Math.min(_,v),C),p=_+g,i&&!h&&(l._stacks[e.axis]._visualValues[s]=e.getValueForPixel(p)-e.getValueForPixel(_))}if(_===e.getPixelForValue(a)){const b=be(g)*e.getLineWidthForValue(a)/2;_+=b,g-=b}return{size:g,base:_,head:p,center:p+g/2}}_calculateBarIndexPixels(t,e){const i=e.scale,s=this.options,o=s.skipNull,r=O(s.maxBarThickness,1/0);let a,l;if(e.grouped){const c=o?this._getStackCount(t):e.stackCount,h=s.barThickness==="flex"?v_(t,e,s,c):y_(t,e,s,c),u=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0);a=h.start+h.chunk*u+h.chunk/2,l=Math.min(r,h.chunk*h.ratio)}else a=i.getPixelForValue(this.getParsed(t)[i.axis],t),l=Math.min(r,e.min*e.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,s=i.length;let o=0;for(;o<s;++o)this.getParsed(o)[e.axis]!==null&&i[o].draw(this._ctx)}}I(Qs,"id","bar"),I(Qs,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),I(Qs,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class Js extends ue{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,i,s){const o=super.parsePrimitiveData(t,e,i,s);for(let r=0;r<o.length;r++)o[r]._custom=this.resolveDataElementOptions(r+i).radius;return o}parseArrayData(t,e,i,s){const o=super.parseArrayData(t,e,i,s);for(let r=0;r<o.length;r++){const a=e[i+r];o[r]._custom=O(a[2],this.resolveDataElementOptions(r+i).radius)}return o}parseObjectData(t,e,i,s){const o=super.parseObjectData(t,e,i,s);for(let r=0;r<o.length;r++){const a=e[i+r];o[r]._custom=O(a&&a.r&&+a.r,this.resolveDataElementOptions(r+i).radius)}return o}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let i=t.length-1;i>=0;--i)e=Math.max(e,t[i].size(this.resolveDataElementOptions(i))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:o}=e,r=this.getParsed(t),a=s.getLabelForValue(r.x),l=o.getLabelForValue(r.y),c=r._custom;return{label:i[t]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,i,s){const o=s==="reset",{iScale:r,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(e,s),h=r.axis,u=a.axis;for(let d=e;d<e+i;d++){const f=t[d],p=!o&&this.getParsed(d),g={},m=g[h]=o?r.getPixelForDecimal(.5):r.getPixelForValue(p[h]),_=g[u]=o?a.getBasePixel():a.getPixelForValue(p[u]);g.skip=isNaN(m)||isNaN(_),c&&(g.options=l||this.resolveDataElementOptions(d,f.active?"active":s),o&&(g.options.radius=0)),this.updateElement(f,d,g,s)}}resolveDataElementOptions(t,e){const i=this.getParsed(t);let s=super.resolveDataElementOptions(t,e);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const o=s.radius;return e!=="active"&&(s.radius=0),s.radius+=O(i&&i._custom,o),s}}I(Js,"id","bubble"),I(Js,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),I(Js,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function k_(n,t,e){let i=1,s=1,o=0,r=0;if(t<ct){const a=n,l=a+t,c=Math.cos(a),h=Math.sin(a),u=Math.cos(l),d=Math.sin(l),f=(x,C,v)=>Qi(x,a,l,!0)?1:Math.max(C,C*e,v,v*e),p=(x,C,v)=>Qi(x,a,l,!0)?-1:Math.min(C,C*e,v,v*e),g=f(0,c,u),m=f(mt,h,d),_=p(ht,c,u),b=p(ht+mt,h,d);i=(g-_)/2,s=(m-b)/2,o=-(g+_)/2,r=-(m+b)/2}return{ratioX:i,ratioY:s,offsetX:o,offsetY:r}}class Ue extends ue{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const i=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=i;else{let o=l=>+i[l];if(j(i[t])){const{key:l="value"}=this._parsing;o=c=>+Ze(i[c],l)}let r,a;for(r=t,a=t+e;r<a;++r)s._parsed[r]=o(r)}}_getRotation(){return le(this.options.rotation-90)}_getCircumference(){return le(this.options.circumference)}_getRotationExtents(){let t=ct,e=-ct;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const s=this.chart.getDatasetMeta(i).controller,o=s._getRotation(),r=s._getCircumference();t=Math.min(t,o),e=Math.max(e,o+r)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:i}=e,s=this._cachedMeta,o=s.data,r=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-r)/2,0),l=Math.min(zg(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:h,rotation:u}=this._getRotationExtents(),{ratioX:d,ratioY:f,offsetX:p,offsetY:g}=k_(u,h,l),m=(i.width-r)/d,_=(i.height-r)/f,b=Math.max(Math.min(m,_)/2,0),x=ku(this.options.radius,b),C=Math.max(x*l,0),v=(x-C)/this._getVisibleDatasetWeightTotal();this.offsetX=p*x,this.offsetY=g*x,s.total=this.calculateTotal(),this.outerRadius=x-v*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-v*c,0),this.updateElements(o,0,o.length,t)}_circumference(t,e){const i=this.options,s=this._cachedMeta,o=this._getCircumference();return e&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*o/ct)}updateElements(t,e,i,s){const o=s==="reset",r=this.chart,a=r.chartArea,c=r.options.animation,h=(a.left+a.right)/2,u=(a.top+a.bottom)/2,d=o&&c.animateScale,f=d?0:this.innerRadius,p=d?0:this.outerRadius,{sharedOptions:g,includeOptions:m}=this._getSharedOptions(e,s);let _=this._getRotation(),b;for(b=0;b<e;++b)_+=this._circumference(b,o);for(b=e;b<e+i;++b){const x=this._circumference(b,o),C=t[b],v={x:h+this.offsetX,y:u+this.offsetY,startAngle:_,endAngle:_+x,circumference:x,outerRadius:p,innerRadius:f};m&&(v.options=g||this.resolveDataElementOptions(b,C.active?"active":s)),_+=x,this.updateElement(C,b,v,s)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let i=0,s;for(s=0;s<e.length;s++){const o=t._parsed[s];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(s)&&!e[s].hidden&&(i+=Math.abs(o))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?ct*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],o=fs(e._parsed[t],i.options.locale);return{label:s[t]||"",value:o}}getMaxBorderWidth(t){let e=0;const i=this.chart;let s,o,r,a,l;if(!t){for(s=0,o=i.data.datasets.length;s<o;++s)if(i.isDatasetVisible(s)){r=i.getDatasetMeta(s),t=r.data,a=r.controller;break}}if(!t)return 0;for(s=0,o=t.length;s<o;++s)l=a.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(e=Math.max(e,l.borderWidth||0,l.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let i=0,s=t.length;i<s;++i){const o=this.resolveDataElementOptions(i);e=Math.max(e,o.offset||0,o.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e}_getRingWeight(t){return Math.max(O(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}I(Ue,"id","doughnut"),I(Ue,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),I(Ue,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),I(Ue,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return e.labels.map((o,r)=>{const l=t.getDatasetMeta(0).controller.getStyle(r);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(r),index:r}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}});class Bi extends ue{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:i,data:s=[],_dataset:o}=e,r=this.chart._animationsDisabled;let{start:a,count:l}=Nu(e,s,r);this._drawStart=a,this._drawCount=l,Lu(e)&&(a=0,l=s.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=s;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(i,void 0,{animated:!r,options:c},t),this.updateElements(s,a,l,t)}updateElements(t,e,i,s){const o=s==="reset",{iScale:r,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:h,includeOptions:u}=this._getSharedOptions(e,s),d=r.axis,f=a.axis,{spanGaps:p,segment:g}=this.options,m=Zn(p)?p:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||o||s==="none",b=e+i,x=t.length;let C=e>0&&this.getParsed(e-1);for(let v=0;v<x;++v){const w=t[v],E=_?w:{};if(v<e||v>=b){E.skip=!0;continue}const T=this.getParsed(v),M=V(T[f]),A=E[d]=r.getPixelForValue(T[d],v),P=E[f]=o||M?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,T,l):T[f],v);E.skip=isNaN(A)||isNaN(P)||M,E.stop=v>0&&Math.abs(T[d]-C[d])>m,g&&(E.parsed=T,E.raw=c.data[v]),u&&(E.options=h||this.resolveDataElementOptions(v,w.active?"active":s)),_||this.updateElement(w,v,E,s),C=T}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,i=e.options&&e.options.borderWidth||0,s=t.data||[];if(!s.length)return i;const o=s[0].size(this.resolveDataElementOptions(0)),r=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,o,r)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}I(Bi,"id","line"),I(Bi,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),I(Bi,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Hi extends ue{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],o=fs(e._parsed[t].r,i.options.locale);return{label:s[t]||"",value:o}}parseObjectData(t,e,i,s){return ju.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,s)=>{const o=this.getParsed(s).r;!isNaN(o)&&this.chart.getDataVisibility(s)&&(o<e.min&&(e.min=o),o>e.max&&(e.max=o))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,i=t.options,s=Math.min(e.right-e.left,e.bottom-e.top),o=Math.max(s/2,0),r=Math.max(i.cutoutPercentage?o/100*i.cutoutPercentage:1,0),a=(o-r)/t.getVisibleDatasetCount();this.outerRadius=o-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,i,s){const o=s==="reset",r=this.chart,l=r.options.animation,c=this._cachedMeta.rScale,h=c.xCenter,u=c.yCenter,d=c.getIndexAngle(0)-.5*ht;let f=d,p;const g=360/this.countVisibleElements();for(p=0;p<e;++p)f+=this._computeAngle(p,s,g);for(p=e;p<e+i;p++){const m=t[p];let _=f,b=f+this._computeAngle(p,s,g),x=r.getDataVisibility(p)?c.getDistanceFromCenterForValue(this.getParsed(p).r):0;f=b,o&&(l.animateScale&&(x=0),l.animateRotate&&(_=b=d));const C={x:h,y:u,innerRadius:0,outerRadius:x,startAngle:_,endAngle:b,options:this.resolveDataElementOptions(p,m.active?"active":s)};this.updateElement(m,p,C,s)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((i,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&e++}),e}_computeAngle(t,e,i){return this.chart.getDataVisibility(t)?le(this.resolveDataElementOptions(t,e).angle||i):0}}I(Hi,"id","polarArea"),I(Hi,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),I(Hi,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return e.labels.map((o,r)=>{const l=t.getDatasetMeta(0).controller.getStyle(r);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(r),index:r}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class Br extends Ue{}I(Br,"id","pie"),I(Br,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Zs extends ue{getLabelAndValue(t){const e=this._cachedMeta.vScale,i=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(i[e.axis])}}parseObjectData(t,e,i,s){return ju.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta,i=e.dataset,s=e.data||[],o=e.iScale.getLabels();if(i.points=s,t!=="resize"){const r=this.resolveDatasetElementOptions(t);this.options.showLine||(r.borderWidth=0);const a={_loop:!0,_fullLoop:o.length===s.length,options:r};this.updateElement(i,void 0,a,t)}this.updateElements(s,0,s.length,t)}updateElements(t,e,i,s){const o=this._cachedMeta.rScale,r=s==="reset";for(let a=e;a<e+i;a++){const l=t[a],c=this.resolveDataElementOptions(a,l.active?"active":s),h=o.getPointPositionForValue(a,this.getParsed(a).r),u=r?o.xCenter:h.x,d=r?o.yCenter:h.y,f={x:u,y:d,angle:h.angle,skip:isNaN(u)||isNaN(d),options:c};this.updateElement(l,a,f,s)}}}I(Zs,"id","radar"),I(Zs,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),I(Zs,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class to extends ue{getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:o}=e,r=this.getParsed(t),a=s.getLabelForValue(r.x),l=o.getLabelForValue(r.y);return{label:i[t]||"",value:"("+a+", "+l+")"}}update(t){const e=this._cachedMeta,{data:i=[]}=e,s=this.chart._animationsDisabled;let{start:o,count:r}=Nu(e,i,s);if(this._drawStart=o,this._drawCount=r,Lu(e)&&(o=0,r=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=e;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=i;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!s,options:c},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(i,o,r,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,i,s){const o=s==="reset",{iScale:r,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,h=this.resolveDataElementOptions(e,s),u=this.getSharedOptions(h),d=this.includeOptions(s,u),f=r.axis,p=a.axis,{spanGaps:g,segment:m}=this.options,_=Zn(g)?g:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||o||s==="none";let x=e>0&&this.getParsed(e-1);for(let C=e;C<e+i;++C){const v=t[C],w=this.getParsed(C),E=b?v:{},T=V(w[p]),M=E[f]=r.getPixelForValue(w[f],C),A=E[p]=o||T?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,w,l):w[p],C);E.skip=isNaN(M)||isNaN(A)||T,E.stop=C>0&&Math.abs(w[f]-x[f])>_,m&&(E.parsed=w,E.raw=c.data[C]),d&&(E.options=u||this.resolveDataElementOptions(C,v.active?"active":s)),b||this.updateElement(v,C,E,s),x=w}this.updateSharedOptions(u,s,h)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let a=0;for(let l=e.length-1;l>=0;--l)a=Math.max(a,e[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const i=t.dataset,s=i.options&&i.options.borderWidth||0;if(!e.length)return s;const o=e[0].size(this.resolveDataElementOptions(0)),r=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(s,o,r)/2}}I(to,"id","scatter"),I(to,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),I(to,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var I_=Object.freeze({__proto__:null,BarController:Qs,BubbleController:Js,DoughnutController:Ue,LineController:Bi,PieController:Br,PolarAreaController:Hi,RadarController:Zs,ScatterController:to});function ln(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Va{constructor(t){I(this,"options");this.options=t||{}}static override(t){Object.assign(Va.prototype,t)}init(){}formats(){return ln()}parse(){return ln()}format(){return ln()}add(){return ln()}diff(){return ln()}startOf(){return ln()}endOf(){return ln()}}var M_={_date:Va};function A_(n,t,e,i){const{controller:s,data:o,_sorted:r}=n,a=s._cachedMeta.iScale;if(a&&t===a.axis&&t!=="r"&&r&&o.length){const l=a._reversePixels?Zg:Pe;if(i){if(s._sharedOptions){const c=o[0],h=typeof c.getRange=="function"&&c.getRange(t);if(h){const u=l(o,t,e-h),d=l(o,t,e+h);return{lo:u.lo,hi:d.hi}}}}else return l(o,t,e)}return{lo:0,hi:o.length-1}}function ps(n,t,e,i,s){const o=n.getSortedVisibleDatasetMetas(),r=e[t];for(let a=0,l=o.length;a<l;++a){const{index:c,data:h}=o[a],{lo:u,hi:d}=A_(o[a],t,r,s);for(let f=u;f<=d;++f){const p=h[f];p.skip||i(p,c,f)}}}function P_(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(i,s){const o=t?Math.abs(i.x-s.x):0,r=e?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(r,2))}}function cr(n,t,e,i,s){const o=[];return!s&&!n.isPointInArea(t)||ps(n,e,t,function(a,l,c){!s&&!De(a,n.chartArea,0)||a.inRange(t.x,t.y,i)&&o.push({element:a,datasetIndex:l,index:c})},!0),o}function D_(n,t,e,i){let s=[];function o(r,a,l){const{startAngle:c,endAngle:h}=r.getProps(["startAngle","endAngle"],i),{angle:u}=Au(r,{x:t.x,y:t.y});Qi(u,c,h)&&s.push({element:r,datasetIndex:a,index:l})}return ps(n,e,t,o),s}function R_(n,t,e,i,s,o){let r=[];const a=P_(e);let l=Number.POSITIVE_INFINITY;function c(h,u,d){const f=h.inRange(t.x,t.y,s);if(i&&!f)return;const p=h.getCenterPoint(s);if(!(!!o||n.isPointInArea(p))&&!f)return;const m=a(t,p);m<l?(r=[{element:h,datasetIndex:u,index:d}],l=m):m===l&&r.push({element:h,datasetIndex:u,index:d})}return ps(n,e,t,c),r}function hr(n,t,e,i,s,o){return!o&&!n.isPointInArea(t)?[]:e==="r"&&!i?D_(n,t,e,s):R_(n,t,e,i,s,o)}function yc(n,t,e,i,s){const o=[],r=e==="x"?"inXRange":"inYRange";let a=!1;return ps(n,e,t,(l,c,h)=>{l[r](t[e],s)&&(o.push({element:l,datasetIndex:c,index:h}),a=a||l.inRange(t.x,t.y,s))}),i&&!a?[]:o}var O_={evaluateInteractionItems:ps,modes:{index(n,t,e,i){const s=un(t,n),o=e.axis||"x",r=e.includeInvisible||!1,a=e.intersect?cr(n,s,o,i,r):hr(n,s,o,!1,i,r),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const h=a[0].index,u=c.data[h];u&&!u.skip&&l.push({element:u,datasetIndex:c.index,index:h})}),l):[]},dataset(n,t,e,i){const s=un(t,n),o=e.axis||"xy",r=e.includeInvisible||!1;let a=e.intersect?cr(n,s,o,i,r):hr(n,s,o,!1,i,r);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let h=0;h<c.length;++h)a.push({element:c[h],datasetIndex:l,index:h})}return a},point(n,t,e,i){const s=un(t,n),o=e.axis||"xy",r=e.includeInvisible||!1;return cr(n,s,o,i,r)},nearest(n,t,e,i){const s=un(t,n),o=e.axis||"xy",r=e.includeInvisible||!1;return hr(n,s,o,e.intersect,i,r)},x(n,t,e,i){const s=un(t,n);return yc(n,s,"x",e.intersect,i)},y(n,t,e,i){const s=un(t,n);return yc(n,s,"y",e.intersect,i)}}};const td=["left","top","right","bottom"];function mi(n,t){return n.filter(e=>e.pos===t)}function vc(n,t){return n.filter(e=>td.indexOf(e.pos)===-1&&e.box.axis===t)}function _i(n,t){return n.sort((e,i)=>{const s=t?i:e,o=t?e:i;return s.weight===o.weight?s.index-o.index:s.weight-o.weight})}function N_(n){const t=[];let e,i,s,o,r,a;for(e=0,i=(n||[]).length;e<i;++e)s=n[e],{position:o,options:{stack:r,stackWeight:a=1}}=s,t.push({index:e,box:s,pos:o,horizontal:s.isHorizontal(),weight:s.weight,stack:r&&o+r,stackWeight:a});return t}function L_(n){const t={};for(const e of n){const{stack:i,pos:s,stackWeight:o}=e;if(!i||!td.includes(s))continue;const r=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});r.count++,r.weight+=o}return t}function F_(n,t){const e=L_(n),{vBoxMaxWidth:i,hBoxMaxHeight:s}=t;let o,r,a;for(o=0,r=n.length;o<r;++o){a=n[o];const{fullSize:l}=a.box,c=e[a.stack],h=c&&a.stackWeight/c.weight;a.horizontal?(a.width=h?h*i:l&&t.availableWidth,a.height=s):(a.width=i,a.height=h?h*s:l&&t.availableHeight)}return e}function B_(n){const t=N_(n),e=_i(t.filter(c=>c.box.fullSize),!0),i=_i(mi(t,"left"),!0),s=_i(mi(t,"right")),o=_i(mi(t,"top"),!0),r=_i(mi(t,"bottom")),a=vc(t,"x"),l=vc(t,"y");return{fullSize:e,leftAndTop:i.concat(o),rightAndBottom:s.concat(l).concat(r).concat(a),chartArea:mi(t,"chartArea"),vertical:i.concat(s).concat(l),horizontal:o.concat(r).concat(a)}}function xc(n,t,e,i){return Math.max(n[e],t[e])+Math.max(n[i],t[i])}function ed(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function H_(n,t,e,i){const{pos:s,box:o}=e,r=n.maxPadding;if(!j(s)){e.size&&(n[s]-=e.size);const u=i[e.stack]||{size:0,count:1};u.size=Math.max(u.size,e.horizontal?o.height:o.width),e.size=u.size/u.count,n[s]+=e.size}o.getPadding&&ed(r,o.getPadding());const a=Math.max(0,t.outerWidth-xc(r,n,"left","right")),l=Math.max(0,t.outerHeight-xc(r,n,"top","bottom")),c=a!==n.w,h=l!==n.h;return n.w=a,n.h=l,e.horizontal?{same:c,other:h}:{same:h,other:c}}function W_(n){const t=n.maxPadding;function e(i){const s=Math.max(t[i]-n[i],0);return n[i]+=s,s}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function z_(n,t){const e=t.maxPadding;function i(s){const o={left:0,top:0,right:0,bottom:0};return s.forEach(r=>{o[r]=Math.max(t[r],e[r])}),o}return i(n?["left","right"]:["top","bottom"])}function Ai(n,t,e,i){const s=[];let o,r,a,l,c,h;for(o=0,r=n.length,c=0;o<r;++o){a=n[o],l=a.box,l.update(a.width||t.w,a.height||t.h,z_(a.horizontal,t));const{same:u,other:d}=H_(t,e,a,i);c|=u&&s.length,h=h||d,l.fullSize||s.push(a)}return c&&Ai(s,t,e,i)||h}function Os(n,t,e,i,s){n.top=e,n.left=t,n.right=t+i,n.bottom=e+s,n.width=i,n.height=s}function wc(n,t,e,i){const s=e.padding;let{x:o,y:r}=t;for(const a of n){const l=a.box,c=i[a.stack]||{count:1,placed:0,weight:1},h=a.stackWeight/c.weight||1;if(a.horizontal){const u=t.w*h,d=c.size||l.height;Xi(c.start)&&(r=c.start),l.fullSize?Os(l,s.left,r,e.outerWidth-s.right-s.left,d):Os(l,t.left+c.placed,r,u,d),c.start=r,c.placed+=u,r=l.bottom}else{const u=t.h*h,d=c.size||l.width;Xi(c.start)&&(o=c.start),l.fullSize?Os(l,o,s.top,d,e.outerHeight-s.bottom-s.top):Os(l,o,t.top+c.placed,d,u),c.start=o,c.placed+=u,o=l.right}}t.x=o,t.y=r}var Ht={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,i){if(!n)return;const s=Nt(n.options.layout.padding),o=Math.max(t-s.width,0),r=Math.max(e-s.height,0),a=B_(n.boxes),l=a.vertical,c=a.horizontal;Z(n.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const h=l.reduce((g,m)=>m.box.options&&m.box.options.display===!1?g:g+1,0)||1,u=Object.freeze({outerWidth:t,outerHeight:e,padding:s,availableWidth:o,availableHeight:r,vBoxMaxWidth:o/2/h,hBoxMaxHeight:r/2}),d=Object.assign({},s);ed(d,Nt(i));const f=Object.assign({maxPadding:d,w:o,h:r,x:s.left,y:s.top},s),p=F_(l.concat(c),u);Ai(a.fullSize,f,u,p),Ai(l,f,u,p),Ai(c,f,u,p)&&Ai(l,f,u,p),W_(f),wc(a.leftAndTop,f,u,p),f.x+=f.w,f.y+=f.h,wc(a.rightAndBottom,f,u,p),n.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},Z(a.chartArea,g=>{const m=g.box;Object.assign(m,n.chartArea),m.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class nd{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,s){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,s?Math.floor(e/s):i)}}isAttached(t){return!0}updateConfig(t){}}class V_ extends nd{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const eo="$chartjs",$_={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Cc=n=>n===null||n==="";function j_(n,t){const e=n.style,i=n.getAttribute("height"),s=n.getAttribute("width");if(n[eo]={initial:{height:i,width:s,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Cc(s)){const o=oc(n,"width");o!==void 0&&(n.width=o)}if(Cc(i))if(n.style.height==="")n.height=n.width/(t||2);else{const o=oc(n,"height");o!==void 0&&(n.height=o)}return n}const id=Ym?{passive:!0}:!1;function U_(n,t,e){n&&n.addEventListener(t,e,id)}function Y_(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,id)}function q_(n,t){const e=$_[n.type]||n.type,{x:i,y:s}=un(n,t);return{type:e,chart:t,native:n,x:i!==void 0?i:null,y:s!==void 0?s:null}}function co(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function G_(n,t,e){const i=n.canvas,s=new MutationObserver(o=>{let r=!1;for(const a of o)r=r||co(a.addedNodes,i),r=r&&!co(a.removedNodes,i);r&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}function K_(n,t,e){const i=n.canvas,s=new MutationObserver(o=>{let r=!1;for(const a of o)r=r||co(a.removedNodes,i),r=r&&!co(a.addedNodes,i);r&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}const Zi=new Map;let Sc=0;function sd(){const n=window.devicePixelRatio;n!==Sc&&(Sc=n,Zi.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function X_(n,t){Zi.size||window.addEventListener("resize",sd),Zi.set(n,t)}function Q_(n){Zi.delete(n),Zi.size||window.removeEventListener("resize",sd)}function J_(n,t,e){const i=n.canvas,s=i&&za(i);if(!s)return;const o=Ou((a,l)=>{const c=s.clientWidth;e(a,l),c<s.clientWidth&&e()},window),r=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,h=l.contentRect.height;c===0&&h===0||o(c,h)});return r.observe(s),X_(n,o),r}function ur(n,t,e){e&&e.disconnect(),t==="resize"&&Q_(n)}function Z_(n,t,e){const i=n.canvas,s=Ou(o=>{n.ctx!==null&&e(q_(o,n))},n);return U_(i,t,s),s}class tb extends nd{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(j_(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e[eo])return!1;const i=e[eo].initial;["height","width"].forEach(o=>{const r=i[o];V(r)?e.removeAttribute(o):e.setAttribute(o,r)});const s=i.style||{};return Object.keys(s).forEach(o=>{e.style[o]=s[o]}),e.width=e.width,delete e[eo],!0}addEventListener(t,e,i){this.removeEventListener(t,e);const s=t.$proxies||(t.$proxies={}),r={attach:G_,detach:K_,resize:J_}[e]||Z_;s[e]=r(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),s=i[e];if(!s)return;({attach:ur,detach:ur,resize:ur}[e]||Y_)(t,e,s),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,s){return Um(t,e,i,s)}isAttached(t){const e=za(t);return!!(e&&e.isConnected)}}function eb(n){return!Wa()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?V_:tb}class pe{constructor(){I(this,"x");I(this,"y");I(this,"active",!1);I(this,"options");I(this,"$animations")}tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return Zn(this.x)&&Zn(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const s={};return t.forEach(o=>{s[o]=i[o]&&i[o].active()?i[o]._to:this[o]}),s}}I(pe,"defaults",{}),I(pe,"defaultRoutes");function nb(n,t){const e=n.options.ticks,i=ib(n),s=Math.min(e.maxTicksLimit||i,i),o=e.major.enabled?ob(t):[],r=o.length,a=o[0],l=o[r-1],c=[];if(r>s)return rb(t,c,o,r/s),c;const h=sb(o,t,s);if(r>0){let u,d;const f=r>1?Math.round((l-a)/(r-1)):null;for(Ns(t,c,h,V(f)?0:a-f,a),u=0,d=r-1;u<d;u++)Ns(t,c,h,o[u],o[u+1]);return Ns(t,c,h,l,V(f)?t.length:l+f),c}return Ns(t,c,h),c}function ib(n){const t=n.options.offset,e=n._tickSize(),i=n._length/e+(t?0:1),s=n._maxLength/e;return Math.floor(Math.min(i,s))}function sb(n,t,e){const i=ab(n),s=t.length/e;if(!i)return Math.max(s,1);const o=Kg(i);for(let r=0,a=o.length-1;r<a;r++){const l=o[r];if(l>s)return l}return Math.max(s,1)}function ob(n){const t=[];let e,i;for(e=0,i=n.length;e<i;e++)n[e].major&&t.push(e);return t}function rb(n,t,e,i){let s=0,o=e[0],r;for(i=Math.ceil(i),r=0;r<n.length;r++)r===o&&(t.push(n[r]),s++,o=e[s*i])}function Ns(n,t,e,i,s){const o=O(i,0),r=Math.min(O(s,n.length),n.length);let a=0,l,c,h;for(e=Math.ceil(e),s&&(l=s-i,e=l/Math.floor(l/e)),h=o;h<0;)a++,h=Math.round(o+a*e);for(c=Math.max(o,0);c<r;c++)c===h&&(t.push(n[c]),a++,h=Math.round(o+a*e))}function ab(n){const t=n.length;let e,i;if(t<2)return!1;for(i=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==i)return!1;return i}const lb=n=>n==="left"?"right":n==="right"?"left":n,Ec=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,Tc=(n,t)=>Math.min(t||n,n);function kc(n,t){const e=[],i=n.length/t,s=n.length;let o=0;for(;o<s;o+=i)e.push(n[Math.floor(o)]);return e}function cb(n,t,e){const i=n.ticks.length,s=Math.min(t,i-1),o=n._startPixel,r=n._endPixel,a=1e-6;let l=n.getPixelForTick(s),c;if(!(e&&(i===1?c=Math.max(l-o,r-l):t===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(s-1))/2,l+=s<t?c:-c,l<o-a||l>r+a)))return l}function hb(n,t){Z(n,e=>{const i=e.gc,s=i.length/2;let o;if(s>t){for(o=0;o<s;++o)delete e.data[i[o]];i.splice(0,s)}})}function bi(n){return n.drawTicks?n.tickLength:0}function Ic(n,t){if(!n.display)return 0;const e=vt(n.font,t),i=Nt(n.padding);return(lt(n.text)?n.text.length:1)*e.lineHeight+i.height}function ub(n,t){return on(n,{scale:t,type:"scale"})}function db(n,t,e){return on(n,{tick:e,index:t,type:"tick"})}function fb(n,t,e){let i=Oa(n);return(e&&t!=="right"||!e&&t==="right")&&(i=lb(i)),i}function pb(n,t,e,i){const{top:s,left:o,bottom:r,right:a,chart:l}=n,{chartArea:c,scales:h}=l;let u=0,d,f,p;const g=r-s,m=a-o;if(n.isHorizontal()){if(f=Ft(i,o,a),j(e)){const _=Object.keys(e)[0],b=e[_];p=h[_].getPixelForValue(b)+g-t}else e==="center"?p=(c.bottom+c.top)/2+g-t:p=Ec(n,e,t);d=a-o}else{if(j(e)){const _=Object.keys(e)[0],b=e[_];f=h[_].getPixelForValue(b)-m+t}else e==="center"?f=(c.left+c.right)/2-m+t:f=Ec(n,e,t);p=Ft(i,r,s),u=e==="left"?-mt:mt}return{titleX:f,titleY:p,maxWidth:d,rotation:u}}class On extends pe{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:s}=this;return t=Xt(t,Number.POSITIVE_INFINITY),e=Xt(e,Number.NEGATIVE_INFINITY),i=Xt(i,Number.POSITIVE_INFINITY),s=Xt(s,Number.NEGATIVE_INFINITY),{min:Xt(t,i),max:Xt(e,s),minDefined:pt(t),maxDefined:pt(e)}}getMinMax(t){let{min:e,max:i,minDefined:s,maxDefined:o}=this.getUserBounds(),r;if(s&&o)return{min:e,max:i};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)r=a[l].controller.getMinMax(this,t),s||(e=Math.min(e,r.min)),o||(i=Math.max(i,r.max));return e=o&&e>i?i:e,i=s&&e>i?e:i,{min:Xt(e,Xt(i,e)),max:Xt(i,Xt(e,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){et(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:s,grace:o,ticks:r}=this.options,a=r.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Cm(this,o,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?kc(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),r.display&&(r.autoSkip||r.source==="auto")&&(this.ticks=nb(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,i;this.isHorizontal()?(e=this.left,i=this.right):(e=this.top,i=this.bottom,t=!t),this._startPixel=e,this._endPixel=i,this._reversePixels=t,this._length=i-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){et(this.options.afterUpdate,[this])}beforeSetDimensions(){et(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){et(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),et(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){et(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,s,o;for(i=0,s=t.length;i<s;i++)o=t[i],o.label=et(e.callback,[o.value,i,t],this)}afterTickToLabelConversion(){et(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){et(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=Tc(this.ticks.length,t.ticks.maxTicksLimit),s=e.minRotation||0,o=e.maxRotation;let r=s,a,l,c;if(!this._isVisible()||!e.display||s>=o||i<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),u=h.widest.width,d=h.highest.height,f=At(this.chart.width-u,0,this.maxWidth);a=t.offset?this.maxWidth/i:f/(i-1),u+6>a&&(a=f/(i-(t.offset?.5:1)),l=this.maxHeight-bi(t.grid)-e.padding-Ic(t.title,this.chart.options.font),c=Math.sqrt(u*u+d*d),r=Da(Math.min(Math.asin(At((h.highest.height+6)/a,-1,1)),Math.asin(At(l/c,-1,1))-Math.asin(At(d/c,-1,1)))),r=Math.max(s,Math.min(o,r))),this.labelRotation=r}afterCalculateLabelRotation(){et(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){et(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:s,grid:o}}=this,r=this._isVisible(),a=this.isHorizontal();if(r){const l=Ic(s,e.options.font);if(a?(t.width=this.maxWidth,t.height=bi(o)+l):(t.height=this.maxHeight,t.width=bi(o)+l),i.display&&this.ticks.length){const{first:c,last:h,widest:u,highest:d}=this._getLabelSizes(),f=i.padding*2,p=le(this.labelRotation),g=Math.cos(p),m=Math.sin(p);if(a){const _=i.mirror?0:m*u.width+g*d.height;t.height=Math.min(this.maxHeight,t.height+_+f)}else{const _=i.mirror?0:g*u.width+m*d.height;t.width=Math.min(this.maxWidth,t.width+_+f)}this._calculatePadding(c,h,m,g)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,s){const{ticks:{align:o,padding:r},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,u=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,f=0;l?c?(d=s*t.width,f=i*e.height):(d=i*t.height,f=s*e.width):o==="start"?f=e.width:o==="end"?d=t.width:o!=="inner"&&(d=t.width/2,f=e.width/2),this.paddingLeft=Math.max((d-h+r)*this.width/(this.width-h),0),this.paddingRight=Math.max((f-u+r)*this.width/(this.width-u),0)}else{let h=e.height/2,u=t.height/2;o==="start"?(h=0,u=t.height):o==="end"&&(h=e.height,u=0),this.paddingTop=h+r,this.paddingBottom=u+r}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){et(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,i;for(e=0,i=t.length;e<i;e++)V(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=kc(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:s,_longestTextCache:o}=this,r=[],a=[],l=Math.floor(e/Tc(e,i));let c=0,h=0,u,d,f,p,g,m,_,b,x,C,v;for(u=0;u<e;u+=l){if(p=t[u].label,g=this._resolveTickFontOptions(u),s.font=m=g.string,_=o[m]=o[m]||{data:{},gc:[]},b=g.lineHeight,x=C=0,!V(p)&&!lt(p))x=ao(s,_.data,_.gc,x,p),C=b;else if(lt(p))for(d=0,f=p.length;d<f;++d)v=p[d],!V(v)&&!lt(v)&&(x=ao(s,_.data,_.gc,x,v),C+=b);r.push(x),a.push(C),c=Math.max(x,c),h=Math.max(C,h)}hb(o,e);const w=r.indexOf(c),E=a.indexOf(h),T=M=>({width:r[M]||0,height:a[M]||0});return{first:T(0),last:T(e-1),widest:T(w),highest:T(E),widths:r,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Jg(this._alignToPixels?an(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=db(this.getContext(),t,i))}return this.$context||(this.$context=ub(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=le(this.labelRotation),i=Math.abs(Math.cos(e)),s=Math.abs(Math.sin(e)),o=this._getLabelSizes(),r=t.autoSkipPadding||0,a=o?o.widest.width+r:0,l=o?o.highest.height+r:0;return this.isHorizontal()?l*i>a*s?a/i:l/s:l*s<a*i?l/i:a/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,s=this.options,{grid:o,position:r,border:a}=s,l=o.offset,c=this.isHorizontal(),u=this.ticks.length+(l?1:0),d=bi(o),f=[],p=a.setContext(this.getContext()),g=p.display?p.width:0,m=g/2,_=function(B){return an(i,B,g)};let b,x,C,v,w,E,T,M,A,P,N,q;if(r==="top")b=_(this.bottom),E=this.bottom-d,M=b-m,P=_(t.top)+m,q=t.bottom;else if(r==="bottom")b=_(this.top),P=t.top,q=_(t.bottom)-m,E=b+m,M=this.top+d;else if(r==="left")b=_(this.right),w=this.right-d,T=b-m,A=_(t.left)+m,N=t.right;else if(r==="right")b=_(this.left),A=t.left,N=_(t.right)-m,w=b+m,T=this.left+d;else if(e==="x"){if(r==="center")b=_((t.top+t.bottom)/2+.5);else if(j(r)){const B=Object.keys(r)[0],U=r[B];b=_(this.chart.scales[B].getPixelForValue(U))}P=t.top,q=t.bottom,E=b+m,M=E+d}else if(e==="y"){if(r==="center")b=_((t.left+t.right)/2);else if(j(r)){const B=Object.keys(r)[0],U=r[B];b=_(this.chart.scales[B].getPixelForValue(U))}w=b-m,T=w-d,A=t.left,N=t.right}const dt=O(s.ticks.maxTicksLimit,u),R=Math.max(1,Math.ceil(u/dt));for(x=0;x<u;x+=R){const B=this.getContext(x),U=o.setContext(B),_t=a.setContext(B),it=U.lineWidth,Lt=U.color,H=_t.dash||[],Y=_t.dashOffset,ut=U.tickWidth,K=U.tickColor,St=U.tickBorderDash||[],Pt=U.tickBorderDashOffset;C=cb(this,x,l),C!==void 0&&(v=an(i,C,it),c?w=T=A=N=v:E=M=P=q=v,f.push({tx1:w,ty1:E,tx2:T,ty2:M,x1:A,y1:P,x2:N,y2:q,width:it,color:Lt,borderDash:H,borderDashOffset:Y,tickWidth:ut,tickColor:K,tickBorderDash:St,tickBorderDashOffset:Pt}))}return this._ticksLength=u,this._borderValue=b,f}_computeLabelItems(t){const e=this.axis,i=this.options,{position:s,ticks:o}=i,r=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:h,mirror:u}=o,d=bi(i.grid),f=d+h,p=u?-h:f,g=-le(this.labelRotation),m=[];let _,b,x,C,v,w,E,T,M,A,P,N,q="middle";if(s==="top")w=this.bottom-p,E=this._getXAxisLabelAlignment();else if(s==="bottom")w=this.top+p,E=this._getXAxisLabelAlignment();else if(s==="left"){const R=this._getYAxisLabelAlignment(d);E=R.textAlign,v=R.x}else if(s==="right"){const R=this._getYAxisLabelAlignment(d);E=R.textAlign,v=R.x}else if(e==="x"){if(s==="center")w=(t.top+t.bottom)/2+f;else if(j(s)){const R=Object.keys(s)[0],B=s[R];w=this.chart.scales[R].getPixelForValue(B)+f}E=this._getXAxisLabelAlignment()}else if(e==="y"){if(s==="center")v=(t.left+t.right)/2-f;else if(j(s)){const R=Object.keys(s)[0],B=s[R];v=this.chart.scales[R].getPixelForValue(B)}E=this._getYAxisLabelAlignment(d).textAlign}e==="y"&&(l==="start"?q="top":l==="end"&&(q="bottom"));const dt=this._getLabelSizes();for(_=0,b=a.length;_<b;++_){x=a[_],C=x.label;const R=o.setContext(this.getContext(_));T=this.getPixelForTick(_)+o.labelOffset,M=this._resolveTickFontOptions(_),A=M.lineHeight,P=lt(C)?C.length:1;const B=P/2,U=R.color,_t=R.textStrokeColor,it=R.textStrokeWidth;let Lt=E;r?(v=T,E==="inner"&&(_===b-1?Lt=this.options.reverse?"left":"right":_===0?Lt=this.options.reverse?"right":"left":Lt="center"),s==="top"?c==="near"||g!==0?N=-P*A+A/2:c==="center"?N=-dt.highest.height/2-B*A+A:N=-dt.highest.height+A/2:c==="near"||g!==0?N=A/2:c==="center"?N=dt.highest.height/2-B*A:N=dt.highest.height-P*A,u&&(N*=-1),g!==0&&!R.showLabelBackdrop&&(v+=A/2*Math.sin(g))):(w=T,N=(1-P)*A/2);let H;if(R.showLabelBackdrop){const Y=Nt(R.backdropPadding),ut=dt.heights[_],K=dt.widths[_];let St=N-Y.top,Pt=0-Y.left;switch(q){case"middle":St-=ut/2;break;case"bottom":St-=ut;break}switch(E){case"center":Pt-=K/2;break;case"right":Pt-=K;break;case"inner":_===b-1?Pt-=K:_>0&&(Pt-=K/2);break}H={left:Pt,top:St,width:K+Y.width,height:ut+Y.height,color:R.backdropColor}}m.push({label:C,font:M,textOffset:N,options:{rotation:g,color:U,strokeColor:_t,strokeWidth:it,textAlign:Lt,textBaseline:q,translation:[v,w],backdrop:H}})}return m}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-le(this.labelRotation))return t==="top"?"left":"right";let s="center";return e.align==="start"?s="left":e.align==="end"?s="right":e.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:s,padding:o}}=this.options,r=this._getLabelSizes(),a=t+o,l=r.widest.width;let c,h;return e==="left"?s?(h=this.right+o,i==="near"?c="left":i==="center"?(c="center",h+=l/2):(c="right",h+=l)):(h=this.right-a,i==="near"?c="right":i==="center"?(c="center",h-=l/2):(c="left",h=this.left)):e==="right"?s?(h=this.left+o,i==="near"?c="right":i==="center"?(c="center",h-=l/2):(c="left",h-=l)):(h=this.left+a,i==="near"?c="left":i==="center"?(c="center",h+=l/2):(c="right",h=this.right)):c="right",{textAlign:c,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:s,width:o,height:r}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,s,o,r),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const s=this.ticks.findIndex(o=>o.value===t);return s>=0?e.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const e=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let o,r;const a=(l,c,h)=>{!h.width||!h.color||(i.save(),i.lineWidth=h.width,i.strokeStyle=h.color,i.setLineDash(h.borderDash||[]),i.lineDashOffset=h.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(c.x,c.y),i.stroke(),i.restore())};if(e.display)for(o=0,r=s.length;o<r;++o){const l=s[o];e.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:s}}=this,o=i.setContext(this.getContext()),r=i.display?o.width:0;if(!r)return;const a=s.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,h,u,d;this.isHorizontal()?(c=an(t,this.left,r)-r/2,h=an(t,this.right,a)+a/2,u=d=l):(u=an(t,this.top,r)-r/2,d=an(t,this.bottom,a)+a/2,c=h=l),e.save(),e.lineWidth=o.width,e.strokeStyle=o.color,e.beginPath(),e.moveTo(c,u),e.lineTo(h,d),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&Ro(i,s);const o=this.getLabelItems(t);for(const r of o){const a=r.options,l=r.font,c=r.label,h=r.textOffset;En(i,c,0,h,l,a)}s&&Oo(i)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:s}}=this;if(!i.display)return;const o=vt(i.font),r=Nt(i.padding),a=i.align;let l=o.lineHeight/2;e==="bottom"||e==="center"||j(e)?(l+=r.bottom,lt(i.text)&&(l+=o.lineHeight*(i.text.length-1))):l+=r.top;const{titleX:c,titleY:h,maxWidth:u,rotation:d}=pb(this,l,e,a);En(t,i.text,0,0,o,{color:i.color,maxWidth:u,rotation:d,textAlign:fb(a,e,s),textBaseline:"middle",translation:[c,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=O(t.grid&&t.grid.z,-1),s=O(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==On.prototype.draw?[{z:e,draw:o=>{this.draw(o)}}]:[{z:i,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:e,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let o,r;for(o=0,r=e.length;o<r;++o){const a=e[o];a[i]===this.id&&(!t||a.type===t)&&s.push(a)}return s}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return vt(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Ls{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;_b(e)&&(i=this.register(e));const s=this.items,o=t.id,r=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in s||(s[o]=t,gb(t,r,i),this.override&&ft.override(t.id,t.overrides)),r}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,s=this.scope;i in e&&delete e[i],s&&i in ft[s]&&(delete ft[s][i],this.override&&delete Sn[i])}}function gb(n,t,e){const i=xe(Object.create(null),[e?ft.get(e):{},ft.get(t),n.defaults]);ft.set(t,i),n.defaultRoutes&&mb(t,n.defaultRoutes),n.descriptors&&ft.describe(t,n.descriptors)}function mb(n,t){Object.keys(t).forEach(e=>{const i=e.split("."),s=i.pop(),o=[n].concat(i).join("."),r=t[e].split("."),a=r.pop(),l=r.join(".");ft.route(o,s,l,a)})}function _b(n){return"id"in n&&"defaults"in n}class bb{constructor(){this.controllers=new Ls(ue,"datasets",!0),this.elements=new Ls(pe,"elements"),this.plugins=new Ls(Object,"plugins"),this.scales=new Ls(On,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach(s=>{const o=i||this._getRegistryForType(s);i||o.isForType(s)||o===this.plugins&&s.id?this._exec(t,o,s):Z(s,r=>{const a=i||this._getRegistryForType(r);this._exec(t,a,r)})})}_exec(t,e,i){const s=Pa(t);et(i["before"+s],[],i),e[t](i),et(i["after"+s],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const s=e.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return s}}var _e=new bb;class yb{constructor(){this._init=[]}notify(t,e,i,s){e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const o=s?this._descriptors(t).filter(s):this._descriptors(t),r=this._notify(o,t,e,i);return e==="afterDestroy"&&(this._notify(o,t,"stop"),this._notify(this._init,t,"uninstall")),r}_notify(t,e,i,s){s=s||{};for(const o of t){const r=o.plugin,a=r[i],l=[e,s,o.options];if(et(a,l,r)===!1&&s.cancelable)return!1}return!0}invalidate(){V(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,s=O(i.options&&i.options.plugins,{}),o=vb(i);return s===!1&&!e?[]:wb(t,o,s,e)}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,s=(o,r)=>o.filter(a=>!r.some(l=>a.plugin.id===l.plugin.id));this._notify(s(e,i),t,"stop"),this._notify(s(i,e),t,"start")}}function vb(n){const t={},e=[],i=Object.keys(_e.plugins.items);for(let o=0;o<i.length;o++)e.push(_e.getPlugin(i[o]));const s=n.plugins||[];for(let o=0;o<s.length;o++){const r=s[o];e.indexOf(r)===-1&&(e.push(r),t[r.id]=!0)}return{plugins:e,localIds:t}}function xb(n,t){return!t&&n===!1?null:n===!0?{}:n}function wb(n,{plugins:t,localIds:e},i,s){const o=[],r=n.getContext();for(const a of t){const l=a.id,c=xb(i[l],s);c!==null&&o.push({plugin:a,options:Cb(n.config,{plugin:a,local:e[l]},c,r)})}return o}function Cb(n,{plugin:t,local:e},i,s){const o=n.pluginScopeKeys(t),r=n.getOptionScopes(i,o);return e&&t.defaults&&r.push(t.defaults),n.createResolver(r,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Hr(n,t){const e=ft.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function Sb(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function Eb(n,t){return n===t?"_index_":"_value_"}function Mc(n){if(n==="x"||n==="y"||n==="r")return n}function Tb(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function Wr(n,...t){if(Mc(n))return n;for(const e of t){const i=e.axis||Tb(e.position)||n.length>1&&Mc(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function Ac(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function kb(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(e.length)return Ac(n,"x",e[0])||Ac(n,"y",e[0])}return{}}function Ib(n,t){const e=Sn[n.type]||{scales:{}},i=t.scales||{},s=Hr(n.type,t),o=Object.create(null);return Object.keys(i).forEach(r=>{const a=i[r];if(!j(a))return console.error(`Invalid scale configuration for scale: ${r}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${r}`);const l=Wr(r,a,kb(r,n),ft.scales[a.type]),c=Eb(l,s),h=e.scales||{};o[r]=Oi(Object.create(null),[{axis:l},a,h[l],h[c]])}),n.data.datasets.forEach(r=>{const a=r.type||n.type,l=r.indexAxis||Hr(a,t),h=(Sn[a]||{}).scales||{};Object.keys(h).forEach(u=>{const d=Sb(u,l),f=r[d+"AxisID"]||d;o[f]=o[f]||Object.create(null),Oi(o[f],[{axis:d},i[f],h[u]])})}),Object.keys(o).forEach(r=>{const a=o[r];Oi(a,[ft.scales[a.type],ft.scale])}),o}function od(n){const t=n.options||(n.options={});t.plugins=O(t.plugins,{}),t.scales=Ib(n,t)}function rd(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function Mb(n){return n=n||{},n.data=rd(n.data),od(n),n}const Pc=new Map,ad=new Set;function Fs(n,t){let e=Pc.get(n);return e||(e=t(),Pc.set(n,e),ad.add(e)),e}const yi=(n,t,e)=>{const i=Ze(t,e);i!==void 0&&n.add(i)};class Ab{constructor(t){this._config=Mb(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=rd(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),od(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Fs(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Fs(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Fs(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,i=this.type;return Fs(`${i}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const i=this._scopeCache;let s=i.get(t);return(!s||e)&&(s=new Map,i.set(t,s)),s}getOptionScopes(t,e,i){const{options:s,type:o}=this,r=this._cachedScopes(t,i),a=r.get(e);if(a)return a;const l=new Set;e.forEach(h=>{t&&(l.add(t),h.forEach(u=>yi(l,t,u))),h.forEach(u=>yi(l,s,u)),h.forEach(u=>yi(l,Sn[o]||{},u)),h.forEach(u=>yi(l,ft,u)),h.forEach(u=>yi(l,Lr,u))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),ad.has(e)&&r.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,Sn[e]||{},ft.datasets[e]||{},{type:e},ft,Lr]}resolveNamedOptions(t,e,i,s=[""]){const o={$shared:!0},{resolver:r,subPrefixes:a}=Dc(this._resolverCache,t,s);let l=r;if(Db(r,e)){o.$shared=!1,i=tn(i)?i():i;const c=this.createResolver(t,i,a);l=ti(r,i,c)}for(const c of e)o[c]=l[c];return o}createResolver(t,e,i=[""],s){const{resolver:o}=Dc(this._resolverCache,t,i);return j(e)?ti(o,e,void 0,s):o}}function Dc(n,t,e){let i=n.get(t);i||(i=new Map,n.set(t,i));const s=e.join();let o=i.get(s);return o||(o={resolver:Fa(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},i.set(s,o)),o}const Pb=n=>j(n)&&Object.getOwnPropertyNames(n).some(t=>tn(n[t]));function Db(n,t){const{isScriptable:e,isIndexable:i}=Wu(n);for(const s of t){const o=e(s),r=i(s),a=(r||o)&&n[s];if(o&&(tn(a)||Pb(a))||r&&lt(a))return!0}return!1}var Rb="4.4.2";const Ob=["top","bottom","left","right","chartArea"];function Rc(n,t){return n==="top"||n==="bottom"||Ob.indexOf(n)===-1&&t==="x"}function Oc(n,t){return function(e,i){return e[n]===i[n]?e[t]-i[t]:e[n]-i[n]}}function Nc(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),et(e&&e.onComplete,[n],t)}function Nb(n){const t=n.chart,e=t.options.animation;et(e&&e.onProgress,[n],t)}function ld(n){return Wa()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const no={},Lc=n=>{const t=ld(n);return Object.values(no).filter(e=>e.canvas===t).pop()};function Lb(n,t,e){const i=Object.keys(n);for(const s of i){const o=+s;if(o>=t){const r=n[s];delete n[s],(e>0||o>t)&&(n[o+e]=r)}}}function Fb(n,t,e,i){return!e||n.type==="mouseout"?null:i?t:n}function Bs(n,t,e){return n.options.clip?n[e]:t[e]}function Bb(n,t){const{xScale:e,yScale:i}=n;return e&&i?{left:Bs(e,t,"left"),right:Bs(e,t,"right"),top:Bs(i,t,"top"),bottom:Bs(i,t,"bottom")}:t}var ze;let gs=(ze=class{static register(...t){_e.add(...t),Fc()}static unregister(...t){_e.remove(...t),Fc()}constructor(t,e){const i=this.config=new Ab(e),s=ld(t),o=Lc(s);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const r=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||eb(s)),this.platform.updateConfig(i);const a=this.platform.acquireContext(s,r.aspectRatio),l=a&&a.canvas,c=l&&l.height,h=l&&l.width;if(this.id=Wg(),this.ctx=a,this.canvas=l,this.width=h,this.height=c,this._options=r,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new yb,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=nm(u=>this.update(u),r.resizeDelay||0),this._dataChanges=[],no[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}ke.listen(this,"complete",Nc),ke.listen(this,"progress",Nb),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:s,_aspectRatio:o}=this;return V(t)?e&&o?o:s?i/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return _e}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():sc(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ec(this.canvas,this.ctx),this}stop(){return ke.stop(this),this}resize(t,e){ke.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,s=this.canvas,o=i.maintainAspectRatio&&this.aspectRatio,r=this.platform.getMaximumSize(s,t,e,o),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=r.width,this.height=r.height,this._aspectRatio=this.aspectRatio,sc(this,a,!0)&&(this.notifyPlugins("resize",{size:r}),et(i.onResize,[this,r],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};Z(e,(i,s)=>{i.id=s})}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,s=Object.keys(i).reduce((r,a)=>(r[a]=!1,r),{});let o=[];e&&(o=o.concat(Object.keys(e).map(r=>{const a=e[r],l=Wr(r,a),c=l==="r",h=l==="x";return{options:a,dposition:c?"chartArea":h?"bottom":"left",dtype:c?"radialLinear":h?"category":"linear"}}))),Z(o,r=>{const a=r.options,l=a.id,c=Wr(l,a),h=O(a.type,r.dtype);(a.position===void 0||Rc(a.position,c)!==Rc(r.dposition))&&(a.position=r.dposition),s[l]=!0;let u=null;if(l in i&&i[l].type===h)u=i[l];else{const d=_e.getScale(h);u=new d({id:l,type:h,ctx:this.ctx,chart:this}),i[u.id]=u}u.init(a,t)}),Z(s,(r,a)=>{r||delete i[a]}),Z(i,r=>{Ht.configure(this,r,r.options),Ht.addBox(this,r)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort((s,o)=>s.index-o.index),i>e){for(let s=e;s<i;++s)this._destroyDatasetMeta(s);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(Oc("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((i,s)=>{e.filter(o=>o===i._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=e.length;i<s;i++){const o=e[i];let r=this.getDatasetMeta(i);const a=o.type||this.config.type;if(r.type&&r.type!==a&&(this._destroyDatasetMeta(i),r=this.getDatasetMeta(i)),r.type=a,r.indexAxis=o.indexAxis||Hr(a,this.options),r.order=o.order||0,r.index=i,r.label=""+o.label,r.visible=this.isDatasetVisible(i),r.controller)r.controller.updateIndex(i),r.controller.linkScales();else{const l=_e.getController(a),{datasetElementType:c,dataElementType:h}=ft.datasets[a];Object.assign(l,{dataElementType:_e.getElement(h),datasetElementType:c&&_e.getElement(c)}),r.controller=new l(this,i),t.push(r.controller)}}return this._updateMetasets(),t}_resetElements(){Z(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let r=0;for(let c=0,h=this.data.datasets.length;c<h;c++){const{controller:u}=this.getDatasetMeta(c),d=!s&&o.indexOf(u)===-1;u.buildOrUpdateElements(d),r=Math.max(+u.getMaxOverflow(),r)}r=this._minPadding=i.layout.autoPadding?r:0,this._updateLayout(r),s||Z(o,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Oc("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Z(this.scales,t=>{Ht.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!Yl(e,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:o}of e){const r=i==="_removeElements"?-o:o;Lb(t,s,r)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=o=>new Set(t.filter(r=>r[0]===o).map((r,a)=>a+","+r.splice(1).join(","))),s=i(0);for(let o=1;o<e;o++)if(!Yl(s,i(o)))return;return Array.from(s).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ht.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],Z(this.boxes,s=>{i&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,o)=>{s._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,i=this.data.datasets.length;e<i;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,tn(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),s={meta:i,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(i.controller._update(e),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ke.has(this)?this.attached&&!ke.running(this)&&ke.start(this):(this.draw(),Nc({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:s}=this._resizeBeforeDraw;this._resize(i,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let s,o;for(s=0,o=e.length;s<o;++s){const r=e[s];(!t||r.visible)&&i.push(r)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i=t._clip,s=!i.disabled,o=Bb(t,this.chartArea),r={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&Ro(e,{left:i.left===!1?0:o.left-i.left,right:i.right===!1?this.width:o.right+i.right,top:i.top===!1?0:o.top-i.top,bottom:i.bottom===!1?this.height:o.bottom+i.bottom}),t.controller.draw(),s&&Oo(e),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return De(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,s){const o=O_.modes[e];return typeof o=="function"?o(this,t,i,s):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let s=i.filter(o=>o&&o._dataset===e).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=on(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!e.hidden}setDatasetVisibility(t,e){const i=this.getDatasetMeta(t);i.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const s=i?"show":"hide",o=this.getDatasetMeta(t),r=o.controller._resolveAnimations(void 0,s);Xi(e)?(o.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),r.update(o,{visible:i}),this.update(a=>a.datasetIndex===t?s:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),ke.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),ec(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete no[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(o,r)=>{e.addEventListener(this,o,r),t[o]=r},s=(o,r,a)=>{o.offsetX=r,o.offsetY=a,this._eventHandler(o)};Z(this.options.events,o=>i(o,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(l,c)=>{e.addEventListener(this,l,c),t[l]=c},s=(l,c)=>{t[l]&&(e.removeEventListener(this,l,c),delete t[l])},o=(l,c)=>{this.canvas&&this.resize(l,c)};let r;const a=()=>{s("attach",a),this.attached=!0,this.resize(),i("resize",o),i("detach",r)};r=()=>{this.attached=!1,s("resize",o),this._stop(),this._resize(0,0),i("attach",a)},e.isAttached(this.canvas)?a():r()}unbindEvents(){Z(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},Z(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const s=i?"set":"remove";let o,r,a,l;for(e==="dataset"&&(o=this.getDatasetMeta(t[0].datasetIndex),o.controller["_"+s+"DatasetHoverStyle"]()),a=0,l=t.length;a<l;++a){r=t[a];const c=r&&this.getDatasetMeta(r.datasetIndex).controller;c&&c[s+"HoverStyle"](r.element,r.datasetIndex,r.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map(({datasetIndex:o,index:r})=>{const a=this.getDatasetMeta(o);if(!a)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:a.data[r],index:r}});!so(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,i){const s=this.options.hover,o=(l,c)=>l.filter(h=>!c.some(u=>h.datasetIndex===u.datasetIndex&&h.index===u.index)),r=o(e,t),a=i?t:o(t,e);r.length&&this.updateHoverStyle(r,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},s=r=>(r.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,s)===!1)return;const o=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(o||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:s=[],options:o}=this,r=e,a=this._getActiveElements(t,s,i,r),l=Yg(t),c=Fb(t,this._lastEvent,i,l);i&&(this._lastEvent=null,et(o.onHover,[t,a,this],this),l&&et(o.onClick,[t,a,this],this));const h=!so(a,s);return(h||e)&&(this._active=a,this._updateHoverStyles(a,s,e)),this._lastEvent=c,h}_getActiveElements(t,e,i,s){if(t.type==="mouseout")return[];if(!i)return e;const o=this.options.hover;return this.getElementsAtEventForMode(t,o.mode,o,s)}},I(ze,"defaults",ft),I(ze,"instances",no),I(ze,"overrides",Sn),I(ze,"registry",_e),I(ze,"version",Rb),I(ze,"getChart",Lc),ze);function Fc(){return Z(gs.instances,n=>n._plugins.invalidate())}function Hb(n,t,e){const{startAngle:i,pixelMargin:s,x:o,y:r,outerRadius:a,innerRadius:l}=t;let c=s/a;n.beginPath(),n.arc(o,r,a,i-c,e+c),l>s?(c=s/l,n.arc(o,r,l,e+c,i-c,!0)):n.arc(o,r,s,e+mt,i-mt),n.closePath(),n.clip()}function Wb(n){return La(n,["outerStart","outerEnd","innerStart","innerEnd"])}function zb(n,t,e,i){const s=Wb(n.options.borderRadius),o=(e-t)/2,r=Math.min(o,i*t/2),a=l=>{const c=(e-Math.min(o,l))*i/2;return At(l,0,Math.min(o,c))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:At(s.innerStart,0,r),innerEnd:At(s.innerEnd,0,r)}}function $n(n,t,e,i){return{x:e+n*Math.cos(t),y:i+n*Math.sin(t)}}function ho(n,t,e,i,s,o){const{x:r,y:a,startAngle:l,pixelMargin:c,innerRadius:h}=t,u=Math.max(t.outerRadius+i+e-c,0),d=h>0?h+i+e+c:0;let f=0;const p=s-l;if(i){const R=h>0?h-i:0,B=u>0?u-i:0,U=(R+B)/2,_t=U!==0?p*U/(U+i):p;f=(p-_t)/2}const g=Math.max(.001,p*u-e/ht)/u,m=(p-g)/2,_=l+m+f,b=s-m-f,{outerStart:x,outerEnd:C,innerStart:v,innerEnd:w}=zb(t,d,u,b-_),E=u-x,T=u-C,M=_+x/E,A=b-C/T,P=d+v,N=d+w,q=_+v/P,dt=b-w/N;if(n.beginPath(),o){const R=(M+A)/2;if(n.arc(r,a,u,M,R),n.arc(r,a,u,R,A),C>0){const it=$n(T,A,r,a);n.arc(it.x,it.y,C,A,b+mt)}const B=$n(N,b,r,a);if(n.lineTo(B.x,B.y),w>0){const it=$n(N,dt,r,a);n.arc(it.x,it.y,w,b+mt,dt+Math.PI)}const U=(b-w/d+(_+v/d))/2;if(n.arc(r,a,d,b-w/d,U,!0),n.arc(r,a,d,U,_+v/d,!0),v>0){const it=$n(P,q,r,a);n.arc(it.x,it.y,v,q+Math.PI,_-mt)}const _t=$n(E,_,r,a);if(n.lineTo(_t.x,_t.y),x>0){const it=$n(E,M,r,a);n.arc(it.x,it.y,x,_-mt,M)}}else{n.moveTo(r,a);const R=Math.cos(M)*u+r,B=Math.sin(M)*u+a;n.lineTo(R,B);const U=Math.cos(A)*u+r,_t=Math.sin(A)*u+a;n.lineTo(U,_t)}n.closePath()}function Vb(n,t,e,i,s){const{fullCircles:o,startAngle:r,circumference:a}=t;let l=t.endAngle;if(o){ho(n,t,e,i,l,s);for(let c=0;c<o;++c)n.fill();isNaN(a)||(l=r+(a%ct||ct))}return ho(n,t,e,i,l,s),n.fill(),l}function $b(n,t,e,i,s){const{fullCircles:o,startAngle:r,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:h,borderDash:u,borderDashOffset:d}=l,f=l.borderAlign==="inner";if(!c)return;n.setLineDash(u||[]),n.lineDashOffset=d,f?(n.lineWidth=c*2,n.lineJoin=h||"round"):(n.lineWidth=c,n.lineJoin=h||"bevel");let p=t.endAngle;if(o){ho(n,t,e,i,p,s);for(let g=0;g<o;++g)n.stroke();isNaN(a)||(p=r+(a%ct||ct))}f&&Hb(n,t,p),o||(ho(n,t,e,i,p,s),n.stroke())}class Yn extends pe{constructor(e){super();I(this,"circumference");I(this,"endAngle");I(this,"fullCircles");I(this,"innerRadius");I(this,"outerRadius");I(this,"pixelMargin");I(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,i,s){const o=this.getProps(["x","y"],s),{angle:r,distance:a}=Au(o,{x:e,y:i}),{startAngle:l,endAngle:c,innerRadius:h,outerRadius:u,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),f=(this.options.spacing+this.options.borderWidth)/2,g=O(d,c-l)>=ct||Qi(r,l,c),m=Ae(a,h+f,u+f);return g&&m}getCenterPoint(e){const{x:i,y:s,startAngle:o,endAngle:r,innerRadius:a,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:h}=this.options,u=(o+r)/2,d=(a+l+h+c)/2;return{x:i+Math.cos(u)*d,y:s+Math.sin(u)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:i,circumference:s}=this,o=(i.offset||0)/4,r=(i.spacing||0)/2,a=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=s>ct?Math.floor(s/ct):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*o,Math.sin(l)*o);const c=1-Math.sin(Math.min(ht,s||0)),h=o*c;e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,Vb(e,this,h,r,a),$b(e,this,h,r,a),e.restore()}}I(Yn,"id","arc"),I(Yn,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),I(Yn,"defaultRoutes",{backgroundColor:"backgroundColor"}),I(Yn,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"});function cd(n,t,e=t){n.lineCap=O(e.borderCapStyle,t.borderCapStyle),n.setLineDash(O(e.borderDash,t.borderDash)),n.lineDashOffset=O(e.borderDashOffset,t.borderDashOffset),n.lineJoin=O(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=O(e.borderWidth,t.borderWidth),n.strokeStyle=O(e.borderColor,t.borderColor)}function jb(n,t,e){n.lineTo(e.x,e.y)}function Ub(n){return n.stepped?pm:n.tension||n.cubicInterpolationMode==="monotone"?gm:jb}function hd(n,t,e={}){const i=n.length,{start:s=0,end:o=i-1}=e,{start:r,end:a}=t,l=Math.max(s,r),c=Math.min(o,a),h=s<r&&o<r||s>a&&o>a;return{count:i,start:l,loop:t.loop,ilen:c<l&&!h?i+c-l:c-l}}function Yb(n,t,e,i){const{points:s,options:o}=t,{count:r,start:a,loop:l,ilen:c}=hd(s,e,i),h=Ub(o);let{move:u=!0,reverse:d}=i||{},f,p,g;for(f=0;f<=c;++f)p=s[(a+(d?c-f:f))%r],!p.skip&&(u?(n.moveTo(p.x,p.y),u=!1):h(n,g,p,d,o.stepped),g=p);return l&&(p=s[(a+(d?c:0))%r],h(n,g,p,d,o.stepped)),!!l}function qb(n,t,e,i){const s=t.points,{count:o,start:r,ilen:a}=hd(s,e,i),{move:l=!0,reverse:c}=i||{};let h=0,u=0,d,f,p,g,m,_;const b=C=>(r+(c?a-C:C))%o,x=()=>{g!==m&&(n.lineTo(h,m),n.lineTo(h,g),n.lineTo(h,_))};for(l&&(f=s[b(0)],n.moveTo(f.x,f.y)),d=0;d<=a;++d){if(f=s[b(d)],f.skip)continue;const C=f.x,v=f.y,w=C|0;w===p?(v<g?g=v:v>m&&(m=v),h=(u*h+C)/++u):(x(),n.lineTo(C,v),p=w,u=0,g=m=v),_=v}x()}function zr(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?qb:Yb}function Gb(n){return n.stepped?qm:n.tension||n.cubicInterpolationMode==="monotone"?Gm:dn}function Kb(n,t,e,i){let s=t._path;s||(s=t._path=new Path2D,t.path(s,e,i)&&s.closePath()),cd(n,t.options),n.stroke(s)}function Xb(n,t,e,i){const{segments:s,options:o}=t,r=zr(t);for(const a of s)cd(n,o,a.style),n.beginPath(),r(n,t,a,{start:e,end:e+i-1})&&n.closePath(),n.stroke()}const Qb=typeof Path2D=="function";function Jb(n,t,e,i){Qb&&!t.options.segment?Kb(n,t,e,i):Xb(n,t,e,i)}class Ye extends pe{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;Hm(this._points,i,t,s,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=t_(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,i=t.length;return i&&e[t[i-1].end]}interpolate(t,e){const i=this.options,s=t[e],o=this.points,r=Xu(this,{property:e,start:s,end:s});if(!r.length)return;const a=[],l=Gb(i);let c,h;for(c=0,h=r.length;c<h;++c){const{start:u,end:d}=r[c],f=o[u],p=o[d];if(f===p){a.push(f);continue}const g=Math.abs((s-f[e])/(p[e]-f[e])),m=l(f,p,g,i.stepped);m[e]=t[e],a.push(m)}return a.length===1?a[0]:a}pathSegment(t,e,i){return zr(this)(t,this,e,i)}path(t,e,i){const s=this.segments,o=zr(this);let r=this._loop;e=e||0,i=i||this.points.length-e;for(const a of s)r&=o(t,this,a,{start:e,end:e+i-1});return!!r}draw(t,e,i,s){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(t.save(),Jb(t,this,i,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}I(Ye,"id","line"),I(Ye,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),I(Ye,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),I(Ye,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function Bc(n,t,e,i){const s=n.options,{[e]:o}=n.getProps([e],i);return Math.abs(t-o)<s.radius+s.hitRadius}class Wi extends pe{constructor(e){super();I(this,"parsed");I(this,"skip");I(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,i,s){const o=this.options,{x:r,y:a}=this.getProps(["x","y"],s);return Math.pow(e-r,2)+Math.pow(i-a,2)<Math.pow(o.hitRadius+o.radius,2)}inXRange(e,i){return Bc(this,e,"x",i)}inYRange(e,i){return Bc(this,e,"y",i)}getCenterPoint(e){const{x:i,y:s}=this.getProps(["x","y"],e);return{x:i,y:s}}size(e){e=e||this.options||{};let i=e.radius||0;i=Math.max(i,i&&e.hoverRadius||0);const s=i&&e.borderWidth||0;return(i+s)*2}draw(e,i){const s=this.options;this.skip||s.radius<.1||!De(this,i,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,Fr(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}I(Wi,"id","point"),I(Wi,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),I(Wi,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function ud(n,t){const{x:e,y:i,base:s,width:o,height:r}=n.getProps(["x","y","base","width","height"],t);let a,l,c,h,u;return n.horizontal?(u=r/2,a=Math.min(e,s),l=Math.max(e,s),c=i-u,h=i+u):(u=o/2,a=e-u,l=e+u,c=Math.min(i,s),h=Math.max(i,s)),{left:a,top:c,right:l,bottom:h}}function qe(n,t,e,i){return n?0:At(t,e,i)}function Zb(n,t,e){const i=n.options.borderWidth,s=n.borderSkipped,o=Hu(i);return{t:qe(s.top,o.top,0,e),r:qe(s.right,o.right,0,t),b:qe(s.bottom,o.bottom,0,e),l:qe(s.left,o.left,0,t)}}function ty(n,t,e){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,o=vn(s),r=Math.min(t,e),a=n.borderSkipped,l=i||j(s);return{topLeft:qe(!l||a.top||a.left,o.topLeft,0,r),topRight:qe(!l||a.top||a.right,o.topRight,0,r),bottomLeft:qe(!l||a.bottom||a.left,o.bottomLeft,0,r),bottomRight:qe(!l||a.bottom||a.right,o.bottomRight,0,r)}}function ey(n){const t=ud(n),e=t.right-t.left,i=t.bottom-t.top,s=Zb(n,e/2,i/2),o=ty(n,e/2,i/2);return{outer:{x:t.left,y:t.top,w:e,h:i,radius:o},inner:{x:t.left+s.l,y:t.top+s.t,w:e-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,o.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(s.b,s.r))}}}}function dr(n,t,e,i){const s=t===null,o=e===null,a=n&&!(s&&o)&&ud(n,i);return a&&(s||Ae(t,a.left,a.right))&&(o||Ae(e,a.top,a.bottom))}function ny(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function iy(n,t){n.rect(t.x,t.y,t.w,t.h)}function fr(n,t,e={}){const i=n.x!==e.x?-t:0,s=n.y!==e.y?-t:0,o=(n.x+n.w!==e.x+e.w?t:0)-i,r=(n.y+n.h!==e.y+e.h?t:0)-s;return{x:n.x+i,y:n.y+s,w:n.w+o,h:n.h+r,radius:n.radius}}class zi extends pe{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:s}}=this,{inner:o,outer:r}=ey(this),a=ny(r.radius)?Ji:iy;t.save(),(r.w!==o.w||r.h!==o.h)&&(t.beginPath(),a(t,fr(r,e,o)),t.clip(),a(t,fr(o,-e,r)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,fr(o,e)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,e,i){return dr(this,t,e,i)}inXRange(t,e){return dr(this,t,null,e)}inYRange(t,e){return dr(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:s,horizontal:o}=this.getProps(["x","y","base","horizontal"],t);return{x:o?(e+s)/2:e,y:o?i:(i+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}I(zi,"id","bar"),I(zi,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),I(zi,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var sy=Object.freeze({__proto__:null,ArcElement:Yn,BarElement:zi,LineElement:Ye,PointElement:Wi});const Vr=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Hc=Vr.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function dd(n){return Vr[n%Vr.length]}function fd(n){return Hc[n%Hc.length]}function oy(n,t){return n.borderColor=dd(t),n.backgroundColor=fd(t),++t}function ry(n,t){return n.backgroundColor=n.data.map(()=>dd(t++)),t}function ay(n,t){return n.backgroundColor=n.data.map(()=>fd(t++)),t}function ly(n){let t=0;return(e,i)=>{const s=n.getDatasetMeta(i).controller;s instanceof Ue?t=ry(e,t):s instanceof Hi?t=ay(e,t):s&&(t=oy(e,t))}}function Wc(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function cy(n){return n&&(n.borderColor||n.backgroundColor)}var hy={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:i},options:s}=n.config,{elements:o}=s;if(!e.forceOverride&&(Wc(i)||cy(s)||o&&Wc(o)))return;const r=ly(n);i.forEach(r)}};function uy(n,t,e,i,s){const o=s.samples||i;if(o>=e)return n.slice(t,t+e);const r=[],a=(e-2)/(o-2);let l=0;const c=t+e-1;let h=t,u,d,f,p,g;for(r[l++]=n[h],u=0;u<o-2;u++){let m=0,_=0,b;const x=Math.floor((u+1)*a)+1+t,C=Math.min(Math.floor((u+2)*a)+1,e)+t,v=C-x;for(b=x;b<C;b++)m+=n[b].x,_+=n[b].y;m/=v,_/=v;const w=Math.floor(u*a)+1+t,E=Math.min(Math.floor((u+1)*a)+1,e)+t,{x:T,y:M}=n[h];for(f=p=-1,b=w;b<E;b++)p=.5*Math.abs((T-m)*(n[b].y-M)-(T-n[b].x)*(_-M)),p>f&&(f=p,d=n[b],g=b);r[l++]=d,h=g}return r[l++]=n[c],r}function dy(n,t,e,i){let s=0,o=0,r,a,l,c,h,u,d,f,p,g;const m=[],_=t+e-1,b=n[t].x,C=n[_].x-b;for(r=t;r<t+e;++r){a=n[r],l=(a.x-b)/C*i,c=a.y;const v=l|0;if(v===h)c<p?(p=c,u=r):c>g&&(g=c,d=r),s=(o*s+a.x)/++o;else{const w=r-1;if(!V(u)&&!V(d)){const E=Math.min(u,d),T=Math.max(u,d);E!==f&&E!==w&&m.push({...n[E],x:s}),T!==f&&T!==w&&m.push({...n[T],x:s})}r>0&&w!==f&&m.push(n[w]),m.push(a),h=v,o=0,p=g=c,u=d=f=r}}return m}function pd(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function zc(n){n.data.datasets.forEach(t=>{pd(t)})}function fy(n,t){const e=t.length;let i=0,s;const{iScale:o}=n,{min:r,max:a,minDefined:l,maxDefined:c}=o.getUserBounds();return l&&(i=At(Pe(t,o.axis,r).lo,0,e-1)),c?s=At(Pe(t,o.axis,a).hi+1,i,e)-i:s=e-i,{start:i,count:s}}var py={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){zc(n);return}const i=n.width;n.data.datasets.forEach((s,o)=>{const{_data:r,indexAxis:a}=s,l=n.getDatasetMeta(o),c=r||s.data;if(rt([a,n.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const h=n.scales[l.xAxisID];if(h.type!=="linear"&&h.type!=="time"||n.options.parsing)return;let{start:u,count:d}=fy(l,c);const f=e.threshold||4*i;if(d<=f){pd(s);return}V(r)&&(s._data=c,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(g){this._data=g}}));let p;switch(e.algorithm){case"lttb":p=uy(c,u,d,i,e);break;case"min-max":p=dy(c,u,d,i);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}s._decimated=p})},destroy(n){zc(n)}};function gy(n,t,e){const i=n.segments,s=n.points,o=t.points,r=[];for(const a of i){let{start:l,end:c}=a;c=$a(l,c,s);const h=$r(e,s[l],s[c],a.loop);if(!t.segments){r.push({source:a,target:h,start:s[l],end:s[c]});continue}const u=Xu(t,h);for(const d of u){const f=$r(e,o[d.start],o[d.end],d.loop),p=Ku(a,s,f);for(const g of p)r.push({source:g,target:d,start:{[e]:Vc(h,f,"start",Math.max)},end:{[e]:Vc(h,f,"end",Math.min)}})}}return r}function $r(n,t,e,i){if(i)return;let s=t[n],o=e[n];return n==="angle"&&(s=Qt(s),o=Qt(o)),{property:n,start:s,end:o}}function my(n,t){const{x:e=null,y:i=null}=n||{},s=t.points,o=[];return t.segments.forEach(({start:r,end:a})=>{a=$a(r,a,s);const l=s[r],c=s[a];i!==null?(o.push({x:l.x,y:i}),o.push({x:c.x,y:i})):e!==null&&(o.push({x:e,y:l.y}),o.push({x:e,y:c.y}))}),o}function $a(n,t,e){for(;t>n;t--){const i=e[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function Vc(n,t,e,i){return n&&t?i(n[e],t[e]):n?n[e]:t?t[e]:0}function gd(n,t){let e=[],i=!1;return lt(n)?(i=!0,e=n):e=my(n,t),e.length?new Ye({points:e,options:{tension:0},_loop:i,_fullLoop:i}):null}function $c(n){return n&&n.fill!==!1}function _y(n,t,e){let s=n[t].fill;const o=[t];let r;if(!e)return s;for(;s!==!1&&o.indexOf(s)===-1;){if(!pt(s))return s;if(r=n[s],!r)return!1;if(r.visible)return s;o.push(s),s=r.fill}return!1}function by(n,t,e){const i=wy(n);if(j(i))return isNaN(i.value)?!1:i;let s=parseFloat(i);return pt(s)&&Math.floor(s)===s?yy(i[0],t,s,e):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function yy(n,t,e,i){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=i?!1:e}function vy(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:j(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function xy(n,t,e){let i;return n==="start"?i=e:n==="end"?i=t.options.reverse?t.min:t.max:j(n)?i=n.value:i=t.getBaseValue(),i}function wy(n){const t=n.options,e=t.fill;let i=O(e&&e.target,e);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function Cy(n){const{scale:t,index:e,line:i}=n,s=[],o=i.segments,r=i.points,a=Sy(t,e);a.push(gd({x:null,y:t.bottom},i));for(let l=0;l<o.length;l++){const c=o[l];for(let h=c.start;h<=c.end;h++)Ey(s,r[h],a)}return new Ye({points:s,options:{}})}function Sy(n,t){const e=[],i=n.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const o=i[s];if(o.index===t)break;o.hidden||e.unshift(o.dataset)}return e}function Ey(n,t,e){const i=[];for(let s=0;s<e.length;s++){const o=e[s],{first:r,last:a,point:l}=Ty(o,t,"x");if(!(!l||r&&a)){if(r)i.unshift(l);else if(n.push(l),!a)break}}n.push(...i)}function Ty(n,t,e){const i=n.interpolate(t,e);if(!i)return{};const s=i[e],o=n.segments,r=n.points;let a=!1,l=!1;for(let c=0;c<o.length;c++){const h=o[c],u=r[h.start][e],d=r[h.end][e];if(Ae(s,u,d)){a=s===u,l=s===d;break}}return{first:a,last:l,point:i}}class md{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){const{x:s,y:o,radius:r}=this;return e=e||{start:0,end:ct},t.arc(s,o,r,e.end,e.start,!0),!i.bounds}interpolate(t){const{x:e,y:i,radius:s}=this,o=t.angle;return{x:e+Math.cos(o)*s,y:i+Math.sin(o)*s,angle:o}}}function ky(n){const{chart:t,fill:e,line:i}=n;if(pt(e))return Iy(t,e);if(e==="stack")return Cy(n);if(e==="shape")return!0;const s=My(n);return s instanceof md?s:gd(s,i)}function Iy(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function My(n){return(n.scale||{}).getPointPositionForValue?Py(n):Ay(n)}function Ay(n){const{scale:t={},fill:e}=n,i=vy(e,t);if(pt(i)){const s=t.isHorizontal();return{x:s?i:null,y:s?null:i}}return null}function Py(n){const{scale:t,fill:e}=n,i=t.options,s=t.getLabels().length,o=i.reverse?t.max:t.min,r=xy(e,t,o),a=[];if(i.grid.circular){const l=t.getPointPositionForValue(0,o);return new md({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(r)})}for(let l=0;l<s;++l)a.push(t.getPointPositionForValue(l,r));return a}function pr(n,t,e){const i=ky(t),{line:s,scale:o,axis:r}=t,a=s.options,l=a.fill,c=a.backgroundColor,{above:h=c,below:u=c}=l||{};i&&s.points.length&&(Ro(n,e),Dy(n,{line:s,target:i,above:h,below:u,area:e,scale:o,axis:r}),Oo(n))}function Dy(n,t){const{line:e,target:i,above:s,below:o,area:r,scale:a}=t,l=e._loop?"angle":t.axis;n.save(),l==="x"&&o!==s&&(jc(n,i,r.top),Uc(n,{line:e,target:i,color:s,scale:a,property:l}),n.restore(),n.save(),jc(n,i,r.bottom)),Uc(n,{line:e,target:i,color:o,scale:a,property:l}),n.restore()}function jc(n,t,e){const{segments:i,points:s}=t;let o=!0,r=!1;n.beginPath();for(const a of i){const{start:l,end:c}=a,h=s[l],u=s[$a(l,c,s)];o?(n.moveTo(h.x,h.y),o=!1):(n.lineTo(h.x,e),n.lineTo(h.x,h.y)),r=!!t.pathSegment(n,a,{move:r}),r?n.closePath():n.lineTo(u.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function Uc(n,t){const{line:e,target:i,property:s,color:o,scale:r}=t,a=gy(e,i,s);for(const{source:l,target:c,start:h,end:u}of a){const{style:{backgroundColor:d=o}={}}=l,f=i!==!0;n.save(),n.fillStyle=d,Ry(n,r,f&&$r(s,h,u)),n.beginPath();const p=!!e.pathSegment(n,l);let g;if(f){p?n.closePath():Yc(n,i,u,s);const m=!!i.pathSegment(n,c,{move:p,reverse:!0});g=p&&m,g||Yc(n,i,h,s)}n.closePath(),n.fill(g?"evenodd":"nonzero"),n.restore()}}function Ry(n,t,e){const{top:i,bottom:s}=t.chart.chartArea,{property:o,start:r,end:a}=e||{};o==="x"&&(n.beginPath(),n.rect(r,i,a-r,s-i),n.clip())}function Yc(n,t,e,i){const s=t.interpolate(e,i);s&&n.lineTo(s.x,s.y)}var Oy={id:"filler",afterDatasetsUpdate(n,t,e){const i=(n.data.datasets||[]).length,s=[];let o,r,a,l;for(r=0;r<i;++r)o=n.getDatasetMeta(r),a=o.dataset,l=null,a&&a.options&&a instanceof Ye&&(l={visible:n.isDatasetVisible(r),index:r,fill:by(a,r,i),chart:n,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=l,s.push(l);for(r=0;r<i;++r)l=s[r],!(!l||l.fill===!1)&&(l.fill=_y(s,r,e.propagate))},beforeDraw(n,t,e){const i=e.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),o=n.chartArea;for(let r=s.length-1;r>=0;--r){const a=s[r].$filler;a&&(a.line.updateControlPoints(o,a.axis),i&&a.fill&&pr(n.ctx,a,o))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const i=n.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const o=i[s].$filler;$c(o)&&pr(n.ctx,o,n.chartArea)}},beforeDatasetDraw(n,t,e){const i=t.meta.$filler;!$c(i)||e.drawTime!=="beforeDatasetDraw"||pr(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const qc=(n,t)=>{let{boxHeight:e=t,boxWidth:i=t}=n;return n.usePointStyle&&(e=Math.min(e,t),i=n.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:e,itemHeight:Math.max(t,e)}},Ny=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class Gc extends pe{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=et(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(i=>t.filter(i,this.chart.data))),t.sort&&(e=e.sort((i,s)=>t.sort(i,s,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,s=vt(i.font),o=s.size,r=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=qc(i,o);let c,h;e.font=s.string,this.isHorizontal()?(c=this.maxWidth,h=this._fitRows(r,o,a,l)+10):(h=this.maxHeight,c=this._fitCols(r,s,a,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,s){const{ctx:o,maxWidth:r,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],h=s+a;let u=t;o.textAlign="left",o.textBaseline="middle";let d=-1,f=-h;return this.legendItems.forEach((p,g)=>{const m=i+e/2+o.measureText(p.text).width;(g===0||c[c.length-1]+m+2*a>r)&&(u+=h,c[c.length-(g>0?0:1)]=0,f+=h,d++),l[g]={left:0,top:f,row:d,width:m,height:s},c[c.length-1]+=m+a}),u}_fitCols(t,e,i,s){const{ctx:o,maxHeight:r,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],h=r-t;let u=a,d=0,f=0,p=0,g=0;return this.legendItems.forEach((m,_)=>{const{itemWidth:b,itemHeight:x}=Ly(i,e,o,m,s);_>0&&f+x+2*a>h&&(u+=d+a,c.push({width:d,height:f}),p+=d+a,g++,d=f=0),l[_]={left:p,top:f,col:g,width:b,height:x},d=Math.max(d,b),f+=x+a}),u+=d,c.push({width:d,height:f}),u}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:s},rtl:o}}=this,r=Gn(o,this.left,this.width);if(this.isHorizontal()){let a=0,l=Ft(i,this.left+s,this.right-this.lineWidths[a]);for(const c of e)a!==c.row&&(a=c.row,l=Ft(i,this.left+s,this.right-this.lineWidths[a])),c.top+=this.top+t+s,c.left=r.leftForLtr(r.x(l),c.width),l+=c.width+s}else{let a=0,l=Ft(i,this.top+t+s,this.bottom-this.columnSizes[a].height);for(const c of e)c.col!==a&&(a=c.col,l=Ft(i,this.top+t+s,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+s,c.left=r.leftForLtr(r.x(c.left),c.width),l+=c.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Ro(t,this),this._draw(),Oo(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:s}=this,{align:o,labels:r}=t,a=ft.color,l=Gn(t.rtl,this.left,this.width),c=vt(r.font),{padding:h}=r,u=c.size,d=u/2;let f;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=c.string;const{boxWidth:p,boxHeight:g,itemHeight:m}=qc(r,u),_=function(w,E,T){if(isNaN(p)||p<=0||isNaN(g)||g<0)return;s.save();const M=O(T.lineWidth,1);if(s.fillStyle=O(T.fillStyle,a),s.lineCap=O(T.lineCap,"butt"),s.lineDashOffset=O(T.lineDashOffset,0),s.lineJoin=O(T.lineJoin,"miter"),s.lineWidth=M,s.strokeStyle=O(T.strokeStyle,a),s.setLineDash(O(T.lineDash,[])),r.usePointStyle){const A={radius:g*Math.SQRT2/2,pointStyle:T.pointStyle,rotation:T.rotation,borderWidth:M},P=l.xPlus(w,p/2),N=E+d;Bu(s,A,P,N,r.pointStyleWidth&&p)}else{const A=E+Math.max((u-g)/2,0),P=l.leftForLtr(w,p),N=vn(T.borderRadius);s.beginPath(),Object.values(N).some(q=>q!==0)?Ji(s,{x:P,y:A,w:p,h:g,radius:N}):s.rect(P,A,p,g),s.fill(),M!==0&&s.stroke()}s.restore()},b=function(w,E,T){En(s,T.text,w,E+m/2,c,{strikethrough:T.hidden,textAlign:l.textAlign(T.textAlign)})},x=this.isHorizontal(),C=this._computeTitleHeight();x?f={x:Ft(o,this.left+h,this.right-i[0]),y:this.top+h+C,line:0}:f={x:this.left+h,y:Ft(o,this.top+C+h,this.bottom-e[0].height),line:0},Yu(this.ctx,t.textDirection);const v=m+h;this.legendItems.forEach((w,E)=>{s.strokeStyle=w.fontColor,s.fillStyle=w.fontColor;const T=s.measureText(w.text).width,M=l.textAlign(w.textAlign||(w.textAlign=r.textAlign)),A=p+d+T;let P=f.x,N=f.y;l.setWidth(this.width),x?E>0&&P+A+h>this.right&&(N=f.y+=v,f.line++,P=f.x=Ft(o,this.left+h,this.right-i[f.line])):E>0&&N+v>this.bottom&&(P=f.x=P+e[f.line].width+h,f.line++,N=f.y=Ft(o,this.top+C+h,this.bottom-e[f.line].height));const q=l.x(P);if(_(q,N,w),P=im(M,P+p+d,x?P+A:this.right,t.rtl),b(l.x(P),N,w),x)f.x+=A+h;else if(typeof w.text!="string"){const dt=c.lineHeight;f.y+=_d(w,dt)+h}else f.y+=v}),qu(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=vt(e.font),s=Nt(e.padding);if(!e.display)return;const o=Gn(t.rtl,this.left,this.width),r=this.ctx,a=e.position,l=i.size/2,c=s.top+l;let h,u=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),h=this.top+c,u=Ft(t.align,u,this.right-d);else{const p=this.columnSizes.reduce((g,m)=>Math.max(g,m.height),0);h=c+Ft(t.align,this.top,this.bottom-p-t.labels.padding-this._computeTitleHeight())}const f=Ft(a,u,u+d);r.textAlign=o.textAlign(Oa(a)),r.textBaseline="middle",r.strokeStyle=e.color,r.fillStyle=e.color,r.font=i.string,En(r,e.text,f,h,i)}_computeTitleHeight(){const t=this.options.title,e=vt(t.font),i=Nt(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,s,o;if(Ae(t,this.left,this.right)&&Ae(e,this.top,this.bottom)){for(o=this.legendHitBoxes,i=0;i<o.length;++i)if(s=o[i],Ae(t,s.left,s.left+s.width)&&Ae(e,s.top,s.top+s.height))return this.legendItems[i]}return null}handleEvent(t){const e=this.options;if(!Hy(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,o=Ny(s,i);s&&!o&&et(e.onLeave,[t,s,this],this),this._hoveredItem=i,i&&!o&&et(e.onHover,[t,i,this],this)}else i&&et(e.onClick,[t,i,this],this)}}function Ly(n,t,e,i,s){const o=Fy(i,n,t,e),r=By(s,i,t.lineHeight);return{itemWidth:o,itemHeight:r}}function Fy(n,t,e,i){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((o,r)=>o.length>r.length?o:r)),t+e.size/2+i.measureText(s).width}function By(n,t,e){let i=n;return typeof t.text!="string"&&(i=_d(t,e)),i}function _d(n,t){const e=n.text?n.text.length:0;return t*e}function Hy(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var Wy={id:"legend",_element:Gc,start(n,t,e){const i=n.legend=new Gc({ctx:n.ctx,options:e,chart:n});Ht.configure(n,i,e),Ht.addBox(n,i)},stop(n){Ht.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const i=n.legend;Ht.configure(n,i,e),i.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const i=t.datasetIndex,s=e.chart;s.isDatasetVisible(i)?(s.hide(i),t.hidden=!0):(s.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:i,textAlign:s,color:o,useBorderRadius:r,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(e?0:void 0),h=Nt(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:o,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:c.borderColor,pointStyle:i||c.pointStyle,rotation:c.rotation,textAlign:s||c.textAlign,borderRadius:r&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class ja extends pe{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const s=lt(i.text)?i.text.length:1;this._padding=Nt(i.padding);const o=s*vt(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:i,bottom:s,right:o,options:r}=this,a=r.align;let l=0,c,h,u;return this.isHorizontal()?(h=Ft(a,i,o),u=e+t,c=o-i):(r.position==="left"?(h=i+t,u=Ft(a,s,e),l=ht*-.5):(h=o-t,u=Ft(a,e,s),l=ht*.5),c=s-e),{titleX:h,titleY:u,maxWidth:c,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=vt(e.font),o=i.lineHeight/2+this._padding.top,{titleX:r,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(o);En(t,e.text,0,0,i,{color:e.color,maxWidth:l,rotation:c,textAlign:Oa(e.align),textBaseline:"middle",translation:[r,a]})}}function zy(n,t){const e=new ja({ctx:n.ctx,options:t,chart:n});Ht.configure(n,e,t),Ht.addBox(n,e),n.titleBlock=e}var Vy={id:"title",_element:ja,start(n,t,e){zy(n,e)},stop(n){const t=n.titleBlock;Ht.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const i=n.titleBlock;Ht.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Hs=new WeakMap;var $y={id:"subtitle",start(n,t,e){const i=new ja({ctx:n.ctx,options:e,chart:n});Ht.configure(n,i,e),Ht.addBox(n,i),Hs.set(n,i)},stop(n){Ht.removeBox(n,Hs.get(n)),Hs.delete(n)},beforeUpdate(n,t,e){const i=Hs.get(n);Ht.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Pi={average(n){if(!n.length)return!1;let t,e,i=new Set,s=0,o=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const l=a.tooltipPosition();i.add(l.x),s+=l.y,++o}}return{x:[...i].reduce((a,l)=>a+l)/i.size,y:s/o}},nearest(n,t){if(!n.length)return!1;let e=t.x,i=t.y,s=Number.POSITIVE_INFINITY,o,r,a;for(o=0,r=n.length;o<r;++o){const l=n[o].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),h=Nr(t,c);h<s&&(s=h,a=l)}}if(a){const l=a.tooltipPosition();e=l.x,i=l.y}return{x:e,y:i}}};function me(n,t){return t&&(lt(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function Ie(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function jy(n,t){const{element:e,datasetIndex:i,index:s}=t,o=n.getDatasetMeta(i).controller,{label:r,value:a}=o.getLabelAndValue(s);return{chart:n,label:r,parsed:o.getParsed(s),raw:n.data.datasets[i].data[s],formattedValue:a,dataset:o.getDataset(),dataIndex:s,datasetIndex:i,element:e}}function Kc(n,t){const e=n.chart.ctx,{body:i,footer:s,title:o}=n,{boxWidth:r,boxHeight:a}=t,l=vt(t.bodyFont),c=vt(t.titleFont),h=vt(t.footerFont),u=o.length,d=s.length,f=i.length,p=Nt(t.padding);let g=p.height,m=0,_=i.reduce((C,v)=>C+v.before.length+v.lines.length+v.after.length,0);if(_+=n.beforeBody.length+n.afterBody.length,u&&(g+=u*c.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),_){const C=t.displayColors?Math.max(a,l.lineHeight):l.lineHeight;g+=f*C+(_-f)*l.lineHeight+(_-1)*t.bodySpacing}d&&(g+=t.footerMarginTop+d*h.lineHeight+(d-1)*t.footerSpacing);let b=0;const x=function(C){m=Math.max(m,e.measureText(C).width+b)};return e.save(),e.font=c.string,Z(n.title,x),e.font=l.string,Z(n.beforeBody.concat(n.afterBody),x),b=t.displayColors?r+2+t.boxPadding:0,Z(i,C=>{Z(C.before,x),Z(C.lines,x),Z(C.after,x)}),b=0,e.font=h.string,Z(n.footer,x),e.restore(),m+=p.width,{width:m,height:g}}function Uy(n,t){const{y:e,height:i}=t;return e<i/2?"top":e>n.height-i/2?"bottom":"center"}function Yy(n,t,e,i){const{x:s,width:o}=i,r=e.caretSize+e.caretPadding;if(n==="left"&&s+o+r>t.width||n==="right"&&s-o-r<0)return!0}function qy(n,t,e,i){const{x:s,width:o}=e,{width:r,chartArea:{left:a,right:l}}=n;let c="center";return i==="center"?c=s<=(a+l)/2?"left":"right":s<=o/2?c="left":s>=r-o/2&&(c="right"),Yy(c,n,t,e)&&(c="center"),c}function Xc(n,t,e){const i=e.yAlign||t.yAlign||Uy(n,e);return{xAlign:e.xAlign||t.xAlign||qy(n,t,e,i),yAlign:i}}function Gy(n,t){let{x:e,width:i}=n;return t==="right"?e-=i:t==="center"&&(e-=i/2),e}function Ky(n,t,e){let{y:i,height:s}=n;return t==="top"?i+=e:t==="bottom"?i-=s+e:i-=s/2,i}function Qc(n,t,e,i){const{caretSize:s,caretPadding:o,cornerRadius:r}=n,{xAlign:a,yAlign:l}=e,c=s+o,{topLeft:h,topRight:u,bottomLeft:d,bottomRight:f}=vn(r);let p=Gy(t,a);const g=Ky(t,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(h,d)+s:a==="right"&&(p+=Math.max(u,f)+s),{x:At(p,0,i.width-t.width),y:At(g,0,i.height-t.height)}}function Ws(n,t,e){const i=Nt(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-i.right:n.x+i.left}function Jc(n){return me([],Ie(n))}function Xy(n,t,e){return on(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function Zc(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const bd={beforeTitle:Ee,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,i=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return e[t.dataIndex]}return""},afterTitle:Ee,beforeBody:Ee,beforeLabel:Ee,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return V(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Ee,afterBody:Ee,beforeFooter:Ee,footer:Ee,afterFooter:Ee};function zt(n,t,e,i){const s=n[t].call(e,i);return typeof s>"u"?bd[t].call(e,i):s}class jr extends pe{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&e.options.animation&&i.animations,o=new Qu(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=Xy(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:i}=e,s=zt(i,"beforeTitle",this,t),o=zt(i,"title",this,t),r=zt(i,"afterTitle",this,t);let a=[];return a=me(a,Ie(s)),a=me(a,Ie(o)),a=me(a,Ie(r)),a}getBeforeBody(t,e){return Jc(zt(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:i}=e,s=[];return Z(t,o=>{const r={before:[],lines:[],after:[]},a=Zc(i,o);me(r.before,Ie(zt(a,"beforeLabel",this,o))),me(r.lines,zt(a,"label",this,o)),me(r.after,Ie(zt(a,"afterLabel",this,o))),s.push(r)}),s}getAfterBody(t,e){return Jc(zt(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:i}=e,s=zt(i,"beforeFooter",this,t),o=zt(i,"footer",this,t),r=zt(i,"afterFooter",this,t);let a=[];return a=me(a,Ie(s)),a=me(a,Ie(o)),a=me(a,Ie(r)),a}_createItems(t){const e=this._active,i=this.chart.data,s=[],o=[],r=[];let a=[],l,c;for(l=0,c=e.length;l<c;++l)a.push(jy(this.chart,e[l]));return t.filter&&(a=a.filter((h,u,d)=>t.filter(h,u,d,i))),t.itemSort&&(a=a.sort((h,u)=>t.itemSort(h,u,i))),Z(a,h=>{const u=Zc(t.callbacks,h);s.push(zt(u,"labelColor",this,h)),o.push(zt(u,"labelPointStyle",this,h)),r.push(zt(u,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=o,this.labelTextColors=r,this.dataPoints=a,a}update(t,e){const i=this.options.setContext(this.getContext()),s=this._active;let o,r=[];if(!s.length)this.opacity!==0&&(o={opacity:0});else{const a=Pi[i.position].call(this,s,this._eventPosition);r=this._createItems(i),this.title=this.getTitle(r,i),this.beforeBody=this.getBeforeBody(r,i),this.body=this.getBody(r,i),this.afterBody=this.getAfterBody(r,i),this.footer=this.getFooter(r,i);const l=this._size=Kc(this,i),c=Object.assign({},a,l),h=Xc(this.chart,i,c),u=Qc(i,c,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,o={opacity:1,x:u.x,y:u.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=r,this.$context=void 0,o&&this._resolveAnimations().update(this,o),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,s){const o=this.getCaretPosition(t,i,s);e.lineTo(o.x1,o.y1),e.lineTo(o.x2,o.y2),e.lineTo(o.x3,o.y3)}getCaretPosition(t,e,i){const{xAlign:s,yAlign:o}=this,{caretSize:r,cornerRadius:a}=i,{topLeft:l,topRight:c,bottomLeft:h,bottomRight:u}=vn(a),{x:d,y:f}=t,{width:p,height:g}=e;let m,_,b,x,C,v;return o==="center"?(C=f+g/2,s==="left"?(m=d,_=m-r,x=C+r,v=C-r):(m=d+p,_=m+r,x=C-r,v=C+r),b=m):(s==="left"?_=d+Math.max(l,h)+r:s==="right"?_=d+p-Math.max(c,u)-r:_=this.caretX,o==="top"?(x=f,C=x-r,m=_-r,b=_+r):(x=f+g,C=x+r,m=_+r,b=_-r),v=x),{x1:m,x2:_,x3:b,y1:x,y2:C,y3:v}}drawTitle(t,e,i){const s=this.title,o=s.length;let r,a,l;if(o){const c=Gn(i.rtl,this.x,this.width);for(t.x=Ws(this,i.titleAlign,i),e.textAlign=c.textAlign(i.titleAlign),e.textBaseline="middle",r=vt(i.titleFont),a=i.titleSpacing,e.fillStyle=i.titleColor,e.font=r.string,l=0;l<o;++l)e.fillText(s[l],c.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+a,l+1===o&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,e,i,s,o){const r=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:l,boxWidth:c}=o,h=vt(o.bodyFont),u=Ws(this,"left",o),d=s.x(u),f=l<h.lineHeight?(h.lineHeight-l)/2:0,p=e.y+f;if(o.usePointStyle){const g={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},m=s.leftForLtr(d,c)+c/2,_=p+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,Fr(t,g,m,_),t.strokeStyle=r.borderColor,t.fillStyle=r.backgroundColor,Fr(t,g,m,_)}else{t.lineWidth=j(r.borderWidth)?Math.max(...Object.values(r.borderWidth)):r.borderWidth||1,t.strokeStyle=r.borderColor,t.setLineDash(r.borderDash||[]),t.lineDashOffset=r.borderDashOffset||0;const g=s.leftForLtr(d,c),m=s.leftForLtr(s.xPlus(d,1),c-2),_=vn(r.borderRadius);Object.values(_).some(b=>b!==0)?(t.beginPath(),t.fillStyle=o.multiKeyBackground,Ji(t,{x:g,y:p,w:c,h:l,radius:_}),t.fill(),t.stroke(),t.fillStyle=r.backgroundColor,t.beginPath(),Ji(t,{x:m,y:p+1,w:c-2,h:l-2,radius:_}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(g,p,c,l),t.strokeRect(g,p,c,l),t.fillStyle=r.backgroundColor,t.fillRect(m,p+1,c-2,l-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:s}=this,{bodySpacing:o,bodyAlign:r,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:h}=i,u=vt(i.bodyFont);let d=u.lineHeight,f=0;const p=Gn(i.rtl,this.x,this.width),g=function(T){e.fillText(T,p.x(t.x+f),t.y+d/2),t.y+=d+o},m=p.textAlign(r);let _,b,x,C,v,w,E;for(e.textAlign=r,e.textBaseline="middle",e.font=u.string,t.x=Ws(this,m,i),e.fillStyle=i.bodyColor,Z(this.beforeBody,g),f=a&&m!=="right"?r==="center"?c/2+h:c+2+h:0,C=0,w=s.length;C<w;++C){for(_=s[C],b=this.labelTextColors[C],e.fillStyle=b,Z(_.before,g),x=_.lines,a&&x.length&&(this._drawColorBox(e,t,C,p,i),d=Math.max(u.lineHeight,l)),v=0,E=x.length;v<E;++v)g(x[v]),d=u.lineHeight;Z(_.after,g)}f=0,d=u.lineHeight,Z(this.afterBody,g),t.y-=o}drawFooter(t,e,i){const s=this.footer,o=s.length;let r,a;if(o){const l=Gn(i.rtl,this.x,this.width);for(t.x=Ws(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=l.textAlign(i.footerAlign),e.textBaseline="middle",r=vt(i.footerFont),e.fillStyle=i.footerColor,e.font=r.string,a=0;a<o;++a)e.fillText(s[a],l.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+i.footerSpacing}}drawBackground(t,e,i,s){const{xAlign:o,yAlign:r}=this,{x:a,y:l}=t,{width:c,height:h}=i,{topLeft:u,topRight:d,bottomLeft:f,bottomRight:p}=vn(s.cornerRadius);e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.beginPath(),e.moveTo(a+u,l),r==="top"&&this.drawCaret(t,e,i,s),e.lineTo(a+c-d,l),e.quadraticCurveTo(a+c,l,a+c,l+d),r==="center"&&o==="right"&&this.drawCaret(t,e,i,s),e.lineTo(a+c,l+h-p),e.quadraticCurveTo(a+c,l+h,a+c-p,l+h),r==="bottom"&&this.drawCaret(t,e,i,s),e.lineTo(a+f,l+h),e.quadraticCurveTo(a,l+h,a,l+h-f),r==="center"&&o==="left"&&this.drawCaret(t,e,i,s),e.lineTo(a,l+u),e.quadraticCurveTo(a,l,a+u,l),e.closePath(),e.fill(),s.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,s=i&&i.x,o=i&&i.y;if(s||o){const r=Pi[t.position].call(this,this._active,this._eventPosition);if(!r)return;const a=this._size=Kc(this,t),l=Object.assign({},r,this._size),c=Xc(e,t,l),h=Qc(t,l,c,e);(s._to!==h.x||o._to!==h.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=r.x,this.caretY=r.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const s={width:this.width,height:this.height},o={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const r=Nt(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(o,t,s,e),Yu(t,e.textDirection),o.y+=r.top,this.drawTitle(o,t,e),this.drawBody(o,t,e),this.drawFooter(o,t,e),qu(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,s=t.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),o=!so(i,s),r=this._positionChanged(s,e);(o||r)&&(this._active=s,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,o=this._active||[],r=this._getActiveElements(t,o,e,i),a=this._positionChanged(r,t),l=e||!so(r,o)||a;return l&&(this._active=r,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,i,s){const o=this.options;if(t.type==="mouseout")return[];if(!s)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const r=this.chart.getElementsAtEventForMode(t,o.mode,o,i);return o.reverse&&r.reverse(),r}_positionChanged(t,e){const{caretX:i,caretY:s,options:o}=this,r=Pi[o.position].call(this,t,e);return r!==!1&&(i!==r.x||s!==r.y)}}I(jr,"positioners",Pi);var Qy={id:"tooltip",_element:jr,positioners:Pi,afterInit(n,t,e){e&&(n.tooltip=new jr({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:bd},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Jy=Object.freeze({__proto__:null,Colors:hy,Decimation:py,Filler:Oy,Legend:Wy,SubTitle:$y,Title:Vy,Tooltip:Qy});const Zy=(n,t,e,i)=>(typeof t=="string"?(e=n.push(t)-1,i.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function tv(n,t,e,i){const s=n.indexOf(t);if(s===-1)return Zy(n,t,e,i);const o=n.lastIndexOf(t);return s!==o?e:s}const ev=(n,t)=>n===null?null:At(Math.round(n),0,t);function th(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class Ur extends On{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const i=this.getLabels();for(const{index:s,label:o}of e)i[s]===o&&i.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(V(t))return null;const i=this.getLabels();return e=isFinite(e)&&i[e]===t?e:tv(i,t,O(e,t),this._addedLabels),ev(e,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),e||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,s=[];let o=this.getLabels();o=t===0&&e===o.length-1?o:o.slice(t,e+1),this._valueRange=Math.max(o.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let r=t;r<=e;r++)s.push({value:r});return s}getLabelForValue(t){return th.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}I(Ur,"id","category"),I(Ur,"defaults",{ticks:{callback:th}});function nv(n,t){const e=[],{bounds:s,step:o,min:r,max:a,precision:l,count:c,maxTicks:h,maxDigits:u,includeBounds:d}=n,f=o||1,p=h-1,{min:g,max:m}=t,_=!V(r),b=!V(a),x=!V(c),C=(m-g)/(u+1);let v=Gl((m-g)/p/f)*f,w,E,T,M;if(v<1e-14&&!_&&!b)return[{value:g},{value:m}];M=Math.ceil(m/v)-Math.floor(g/v),M>p&&(v=Gl(M*v/p/f)*f),V(l)||(w=Math.pow(10,l),v=Math.ceil(v*w)/w),s==="ticks"?(E=Math.floor(g/v)*v,T=Math.ceil(m/v)*v):(E=g,T=m),_&&b&&o&&Xg((a-r)/o,v/1e3)?(M=Math.round(Math.min((a-r)/v,h)),v=(a-r)/M,E=r,T=a):x?(E=_?r:E,T=b?a:T,M=c-1,v=(T-E)/M):(M=(T-E)/v,Ni(M,Math.round(M),v/1e3)?M=Math.round(M):M=Math.ceil(M));const A=Math.max(Kl(v),Kl(E));w=Math.pow(10,V(l)?A:l),E=Math.round(E*w)/w,T=Math.round(T*w)/w;let P=0;for(_&&(d&&E!==r?(e.push({value:r}),E<r&&P++,Ni(Math.round((E+P*v)*w)/w,r,eh(r,C,n))&&P++):E<r&&P++);P<M;++P){const N=Math.round((E+P*v)*w)/w;if(b&&N>a)break;e.push({value:N})}return b&&d&&T!==a?e.length&&Ni(e[e.length-1].value,a,eh(a,C,n))?e[e.length-1].value=a:e.push({value:a}):(!b||T===a)&&e.push({value:T}),e}function eh(n,t,{horizontal:e,minRotation:i}){const s=le(i),o=(e?Math.sin(s):Math.cos(s))||.001,r=.75*t*(""+n).length;return Math.min(t/o,r)}class uo extends On{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return V(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:s,max:o}=this;const r=l=>s=e?s:l,a=l=>o=i?o:l;if(t){const l=be(s),c=be(o);l<0&&c<0?a(0):l>0&&c>0&&r(0)}if(s===o){let l=o===0?1:Math.abs(o*.05);a(o+l),t||r(s-l)}this.min=s,this.max=o}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:i}=t,s;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),e=e||11),e&&(s=Math.min(e,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const s={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},o=this._range||this,r=nv(s,o);return t.bounds==="ticks"&&Mu(r,this,"value"),t.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const s=(i-e)/Math.max(t.length-1,1)/2;e-=s,i+=s}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return fs(t,this.chart.options.locale,this.options.ticks.format)}}class Yr extends uo{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=pt(t)?t:0,this.max=pt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=le(this.options.ticks.minRotation),s=(t?Math.sin(i):Math.cos(i))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,o.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}I(Yr,"id","linear"),I(Yr,"defaults",{ticks:{callback:Do.formatters.numeric}});const ts=n=>Math.floor(je(n)),cn=(n,t)=>Math.pow(10,ts(n)+t);function nh(n){return n/Math.pow(10,ts(n))===1}function ih(n,t,e){const i=Math.pow(10,e),s=Math.floor(n/i);return Math.ceil(t/i)-s}function iv(n,t){const e=t-n;let i=ts(e);for(;ih(n,t,i)>10;)i++;for(;ih(n,t,i)<10;)i--;return Math.min(i,ts(n))}function sv(n,{min:t,max:e}){t=Xt(n.min,t);const i=[],s=ts(t);let o=iv(t,e),r=o<0?Math.pow(10,Math.abs(o)):1;const a=Math.pow(10,o),l=s>o?Math.pow(10,s):0,c=Math.round((t-l)*r)/r,h=Math.floor((t-l)/a/10)*a*10;let u=Math.floor((c-h)/Math.pow(10,o)),d=Xt(n.min,Math.round((l+h+u*Math.pow(10,o))*r)/r);for(;d<e;)i.push({value:d,major:nh(d),significand:u}),u>=10?u=u<15?15:20:u++,u>=20&&(o++,u=2,r=o>=0?1:r),d=Math.round((l+h+u*Math.pow(10,o))*r)/r;const f=Xt(n.max,d);return i.push({value:f,major:nh(f),significand:u}),i}class qr extends On{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const i=uo.prototype.parse.apply(this,[t,e]);if(i===0){this._zero=!0;return}return pt(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=pt(t)?Math.max(0,t):null,this.max=pt(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!pt(this._userMin)&&(this.min=t===cn(this.min,0)?cn(this.min,-1):cn(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let i=this.min,s=this.max;const o=a=>i=t?i:a,r=a=>s=e?s:a;i===s&&(i<=0?(o(1),r(10)):(o(cn(i,-1)),r(cn(s,1)))),i<=0&&o(cn(s,-1)),s<=0&&r(cn(i,1)),this.min=i,this.max=s}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},i=sv(e,this);return t.bounds==="ticks"&&Mu(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":fs(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=je(t),this._valueRange=je(this.max)-je(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(je(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}I(qr,"id","logarithmic"),I(qr,"defaults",{ticks:{callback:Do.formatters.logarithmic,major:{enabled:!0}}});function Gr(n){const t=n.ticks;if(t.display&&n.display){const e=Nt(t.backdropPadding);return O(t.font&&t.font.size,ft.font.size)+e.height}return 0}function ov(n,t,e){return e=lt(e)?e:[e],{w:fm(n,t.string,e),h:e.length*t.lineHeight}}function sh(n,t,e,i,s){return n===i||n===s?{start:t-e/2,end:t+e/2}:n<i||n>s?{start:t-e,end:t}:{start:t,end:t+e}}function rv(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),i=[],s=[],o=n._pointLabels.length,r=n.options.pointLabels,a=r.centerPointLabels?ht/o:0;for(let l=0;l<o;l++){const c=r.setContext(n.getPointLabelContext(l));s[l]=c.padding;const h=n.getPointPosition(l,n.drawingArea+s[l],a),u=vt(c.font),d=ov(n.ctx,u,n._pointLabels[l]);i[l]=d;const f=Qt(n.getIndexAngle(l)+a),p=Math.round(Da(f)),g=sh(p,h.x,d.w,0,180),m=sh(p,h.y,d.h,90,270);av(e,t,f,g,m)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=hv(n,i,s)}function av(n,t,e,i,s){const o=Math.abs(Math.sin(e)),r=Math.abs(Math.cos(e));let a=0,l=0;i.start<t.l?(a=(t.l-i.start)/o,n.l=Math.min(n.l,t.l-a)):i.end>t.r&&(a=(i.end-t.r)/o,n.r=Math.max(n.r,t.r+a)),s.start<t.t?(l=(t.t-s.start)/r,n.t=Math.min(n.t,t.t-l)):s.end>t.b&&(l=(s.end-t.b)/r,n.b=Math.max(n.b,t.b+l))}function lv(n,t,e){const i=n.drawingArea,{extra:s,additionalAngle:o,padding:r,size:a}=e,l=n.getPointPosition(t,i+s+r,o),c=Math.round(Da(Qt(l.angle+mt))),h=fv(l.y,a.h,c),u=uv(c),d=dv(l.x,a.w,u);return{visible:!0,x:l.x,y:h,textAlign:u,left:d,top:h,right:d+a.w,bottom:h+a.h}}function cv(n,t){if(!t)return!0;const{left:e,top:i,right:s,bottom:o}=n;return!(De({x:e,y:i},t)||De({x:e,y:o},t)||De({x:s,y:i},t)||De({x:s,y:o},t))}function hv(n,t,e){const i=[],s=n._pointLabels.length,o=n.options,{centerPointLabels:r,display:a}=o.pointLabels,l={extra:Gr(o)/2,additionalAngle:r?ht/s:0};let c;for(let h=0;h<s;h++){l.padding=e[h],l.size=t[h];const u=lv(n,h,l);i.push(u),a==="auto"&&(u.visible=cv(u,c),u.visible&&(c=u))}return i}function uv(n){return n===0||n===180?"center":n<180?"left":"right"}function dv(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function fv(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function pv(n,t,e){const{left:i,top:s,right:o,bottom:r}=e,{backdropColor:a}=t;if(!V(a)){const l=vn(t.borderRadius),c=Nt(t.backdropPadding);n.fillStyle=a;const h=i-c.left,u=s-c.top,d=o-i+c.width,f=r-s+c.height;Object.values(l).some(p=>p!==0)?(n.beginPath(),Ji(n,{x:h,y:u,w:d,h:f,radius:l}),n.fill()):n.fillRect(h,u,d,f)}}function gv(n,t){const{ctx:e,options:{pointLabels:i}}=n;for(let s=t-1;s>=0;s--){const o=n._pointLabelItems[s];if(!o.visible)continue;const r=i.setContext(n.getPointLabelContext(s));pv(e,r,o);const a=vt(r.font),{x:l,y:c,textAlign:h}=o;En(e,n._pointLabels[s],l,c+a.lineHeight/2,a,{color:r.color,textAlign:h,textBaseline:"middle"})}}function yd(n,t,e,i){const{ctx:s}=n;if(e)s.arc(n.xCenter,n.yCenter,t,0,ct);else{let o=n.getPointPosition(0,t);s.moveTo(o.x,o.y);for(let r=1;r<i;r++)o=n.getPointPosition(r,t),s.lineTo(o.x,o.y)}}function mv(n,t,e,i,s){const o=n.ctx,r=t.circular,{color:a,lineWidth:l}=t;!r&&!i||!a||!l||e<0||(o.save(),o.strokeStyle=a,o.lineWidth=l,o.setLineDash(s.dash),o.lineDashOffset=s.dashOffset,o.beginPath(),yd(n,e,r,i),o.closePath(),o.stroke(),o.restore())}function _v(n,t,e){return on(n,{label:e,index:t,type:"pointLabel"})}class Di extends uo{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=Nt(Gr(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=pt(t)&&!isNaN(t)?t:0,this.max=pt(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Gr(this.options))}generateTickLabels(t){uo.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,i)=>{const s=et(this.options.pointLabels.callback,[e,i],this);return s||s===0?s:""}).filter((e,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?rv(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,s){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,s))}getIndexAngle(t){const e=ct/(this._pointLabels.length||1),i=this.options.startAngle||0;return Qt(t*e+le(i))}getDistanceFromCenterForValue(t){if(V(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(V(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const i=e[t];return _v(this.getContext(),t,i)}}getPointPosition(t,e,i=0){const s=this.getIndexAngle(t)-mt+i;return{x:Math.cos(s)*e+this.xCenter,y:Math.sin(s)*e+this.yCenter,angle:s}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:i,right:s,bottom:o}=this._pointLabelItems[t];return{left:e,top:i,right:s,bottom:o}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),yd(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:i,grid:s,border:o}=e,r=this._pointLabels.length;let a,l,c;if(e.pointLabels.display&&gv(this,r),s.display&&this.ticks.forEach((h,u)=>{if(u!==0||u===0&&this.min<0){l=this.getDistanceFromCenterForValue(h.value);const d=this.getContext(u),f=s.setContext(d),p=o.setContext(d);mv(this,f,l,r,p)}}),i.display){for(t.save(),a=r-1;a>=0;a--){const h=i.setContext(this.getPointLabelContext(a)),{color:u,lineWidth:d}=h;!d||!u||(t.lineWidth=d,t.strokeStyle=u,t.setLineDash(h.borderDash),t.lineDashOffset=h.borderDashOffset,l=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),c=this.getPointPosition(a,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let o,r;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!e.reverse)return;const c=i.setContext(this.getContext(l)),h=vt(c.font);if(o=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=h.string,r=t.measureText(a.label).width,t.fillStyle=c.backdropColor;const u=Nt(c.backdropPadding);t.fillRect(-r/2-u.left,-o-h.size/2-u.top,r+u.width,h.size+u.height)}En(t,a.label,0,-o,h,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}}I(Di,"id","radialLinear"),I(Di,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Do.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),I(Di,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),I(Di,"descriptors",{angleLines:{_fallback:"grid"}});const Lo={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},$t=Object.keys(Lo);function oh(n,t){return n-t}function rh(n,t){if(V(t))return null;const e=n._adapter,{parser:i,round:s,isoWeekday:o}=n._parseOpts;let r=t;return typeof i=="function"&&(r=i(r)),pt(r)||(r=typeof i=="string"?e.parse(r,i):e.parse(r)),r===null?null:(s&&(r=s==="week"&&(Zn(o)||o===!0)?e.startOf(r,"isoWeek",o):e.startOf(r,s)),+r)}function ah(n,t,e,i){const s=$t.length;for(let o=$t.indexOf(n);o<s-1;++o){const r=Lo[$t[o]],a=r.steps?r.steps:Number.MAX_SAFE_INTEGER;if(r.common&&Math.ceil((e-t)/(a*r.size))<=i)return $t[o]}return $t[s-1]}function bv(n,t,e,i,s){for(let o=$t.length-1;o>=$t.indexOf(e);o--){const r=$t[o];if(Lo[r].common&&n._adapter.diff(s,i,r)>=t-1)return r}return $t[e?$t.indexOf(e):0]}function yv(n){for(let t=$t.indexOf(n)+1,e=$t.length;t<e;++t)if(Lo[$t[t]].common)return $t[t]}function lh(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:i,hi:s}=Ra(e,t),o=e[i]>=t?e[i]:e[s];n[o]=!0}}function vv(n,t,e,i){const s=n._adapter,o=+s.startOf(t[0].value,i),r=t[t.length-1].value;let a,l;for(a=o;a<=r;a=+s.add(a,1,i))l=e[a],l>=0&&(t[l].major=!0);return t}function ch(n,t,e){const i=[],s={},o=t.length;let r,a;for(r=0;r<o;++r)a=t[r],s[a]=r,i.push({value:a,major:!1});return o===0||!e?i:vv(n,i,s,e)}class es extends On{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const i=t.time||(t.time={}),s=this._adapter=new M_._date(t.adapters.date);s.init(e),Oi(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:rh(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:s,max:o,minDefined:r,maxDefined:a}=this.getUserBounds();function l(c){!r&&!isNaN(c.min)&&(s=Math.min(s,c.min)),!a&&!isNaN(c.max)&&(o=Math.max(o,c.max))}(!r||!a)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=pt(s)&&!isNaN(s)?s:+e.startOf(Date.now(),i),o=pt(o)&&!isNaN(o)?o:+e.endOf(Date.now(),i)+1,this.min=Math.min(s,o-1),this.max=Math.max(s+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,s=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const o=this.min,r=this.max,a=tm(s,o,r);return this._unit=e.unit||(i.autoSkip?ah(e.minUnit,this.min,this.max,this._getLabelCapacity(o)):bv(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:yv(this._unit),this.initOffsets(s),t.reverse&&a.reverse(),ch(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,i=0,s,o;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?e=1-s:e=(this.getDecimalForValue(t[1])-s)/2,o=this.getDecimalForValue(t[t.length-1]),t.length===1?i=o:i=(o-this.getDecimalForValue(t[t.length-2]))/2);const r=t.length<3?.5:.25;e=At(e,0,r),i=At(i,0,r),this._offsets={start:e,end:i,factor:1/(e+1+i)}}_generate(){const t=this._adapter,e=this.min,i=this.max,s=this.options,o=s.time,r=o.unit||ah(o.minUnit,e,i,this._getLabelCapacity(e)),a=O(s.ticks.stepSize,1),l=r==="week"?o.isoWeekday:!1,c=Zn(l)||l===!0,h={};let u=e,d,f;if(c&&(u=+t.startOf(u,"isoWeek",l)),u=+t.startOf(u,c?"day":r),t.diff(i,e,r)>1e5*a)throw new Error(e+" and "+i+" are too far apart with stepSize of "+a+" "+r);const p=s.ticks.source==="data"&&this.getDataTimestamps();for(d=u,f=0;d<i;d=+t.add(d,a,r),f++)lh(h,d,p);return(d===i||s.bounds==="ticks"||f===1)&&lh(h,d,p),Object.keys(h).sort(oh).map(g=>+g)}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){const s=this.options.time.displayFormats,o=this._unit,r=e||s[o];return this._adapter.format(t,r)}_tickFormatFunction(t,e,i,s){const o=this.options,r=o.ticks.callback;if(r)return et(r,[t,e,i],this);const a=o.time.displayFormats,l=this._unit,c=this._majorUnit,h=l&&a[l],u=c&&a[c],d=i[e],f=c&&u&&d&&d.major;return this._adapter.format(t,s||(f?u:h))}generateTickLabels(t){let e,i,s;for(e=0,i=t.length;e<i;++e)s=t[e],s.label=this._tickFormatFunction(s.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,s=le(this.isHorizontal()?e.maxRotation:e.minRotation),o=Math.cos(s),r=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:i*o+a*r,h:i*r+a*o}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,s=i[e.unit]||i.millisecond,o=this._tickFormatFunction(t,0,ch(this,[t],this._majorUnit),s),r=this._getLabelSize(o),a=Math.floor(this.isHorizontal()?this.width/r.w:this.height/r.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,i;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(e=0,i=s.length;e<i;++e)t=t.concat(s[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const s=this.getLabels();for(e=0,i=s.length;e<i;++e)t.push(rh(this,s[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Du(t.sort(oh))}}I(es,"id","time"),I(es,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function zs(n,t,e){let i=0,s=n.length-1,o,r,a,l;e?(t>=n[i].pos&&t<=n[s].pos&&({lo:i,hi:s}=Pe(n,"pos",t)),{pos:o,time:a}=n[i],{pos:r,time:l}=n[s]):(t>=n[i].time&&t<=n[s].time&&({lo:i,hi:s}=Pe(n,"time",t)),{time:o,pos:a}=n[i],{time:r,pos:l}=n[s]);const c=r-o;return c?a+(l-a)*(t-o)/c:a}class Kr extends es{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=zs(e,this.min),this._tableRange=zs(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,s=[],o=[];let r,a,l,c,h;for(r=0,a=t.length;r<a;++r)c=t[r],c>=e&&c<=i&&s.push(c);if(s.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(r=0,a=s.length;r<a;++r)h=s[r+1],l=s[r-1],c=s[r],Math.round((h+l)/2)!==c&&o.push({time:c,pos:r/(a-1)});return o}_generate(){const t=this.min,e=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(e)||i.length===1)&&i.push(e),i.sort((s,o)=>s-o)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return e.length&&i.length?t=this.normalize(e.concat(i)):t=e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(zs(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return zs(this._table,i*this._tableRange+this._minPos,!0)}}I(Kr,"id","timeseries"),I(Kr,"defaults",es.defaults);var xv=Object.freeze({__proto__:null,CategoryScale:Ur,LinearScale:Yr,LogarithmicScale:qr,RadialLinearScale:Di,TimeScale:es,TimeSeriesScale:Kr});const vd=[I_,sy,Jy,xv],xd={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},wv={ariaLabel:{type:String},ariaDescribedby:{type:String}},Cv={type:{type:String,required:!0},destroyDelay:{type:Number,default:0},...xd,...wv},Sv=sg[0]==="2"?(n,t)=>Object.assign(n,{attrs:t}):(n,t)=>Object.assign(n,t);function jn(n){return wu(n)?Rr(n):n}function Ev(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;return wu(t)?new Proxy(n,{}):n}function Tv(n,t){const e=n.options;e&&t&&Object.assign(e,t)}function wd(n,t){n.labels=t}function Cd(n,t,e){const i=[];n.datasets=t.map(s=>{const o=n.datasets.find(r=>r[e]===s[e]);return!o||!s.data||i.includes(o)?{...s}:(i.push(o),Object.assign(o,s),o)})}function kv(n,t){const e={labels:[],datasets:[]};return wd(e,n.labels),Cd(e,n.datasets,t),e}const Iv=Zt({props:Cv,setup(n,t){let{expose:e,slots:i}=t;const s=S(null),o=Ta(null);e({chart:o});const r=()=>{if(!s.value)return;const{type:c,data:h,options:u,plugins:d,datasetIdKey:f}=n,p=kv(h,f),g=Ev(p,h);o.value=new gs(s.value,{type:c,data:g,options:{...u},plugins:d})},a=()=>{const c=Rr(o.value);c&&(n.destroyDelay>0?setTimeout(()=>{c.destroy(),o.value=null},n.destroyDelay):(c.destroy(),o.value=null))},l=c=>{c.update(n.updateMode)};return Ot(r),fe(a),Rn([()=>n.options,()=>n.data],(c,h)=>{let[u,d]=c,[f,p]=h;const g=Rr(o.value);if(!g)return;let m=!1;if(u){const _=jn(u),b=jn(f);_&&_!==b&&(Tv(g,_),m=!0)}if(d){const _=jn(d.labels),b=jn(p.labels),x=jn(d.datasets),C=jn(p.datasets);_!==b&&(wd(g.config.data,_),m=!0),x&&x!==C&&(Cd(g.config.data,x,n.datasetIdKey),m=!0)}m&&xu(()=>{l(g)})},{deep:!0}),()=>It("canvas",{role:"img",ariaLabel:n.ariaLabel,ariaDescribedby:n.ariaDescribedby,ref:s},[It("p",{},[i.default?i.default():""])])}});function Sd(n,t){return gs.register(t),Zt({props:xd,setup(e,i){let{expose:s}=i;const o=Ta(null),r=a=>{o.value=a==null?void 0:a.chart};return s({chart:o}),()=>It(Iv,Sv({ref:r},{type:n,...e}))}})}const Te=Sd("doughnut",Ue),vi=Sd("line",Bi);gs.register(...vd);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var hh=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var n=window.screen;if(n)return(n.deviceXDPI||1)/(n.logicalXDPI||1)}return 1}(),Vi={toTextLines:function(n){var t=[],e;for(n=[].concat(n);n.length;)e=n.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?n.push.apply(n,e):V(n)||t.unshift(""+e);return t},textSize:function(n,t,e){var i=[].concat(t),s=i.length,o=n.font,r=0,a;for(n.font=e.string,a=0;a<s;++a)r=Math.max(n.measureText(i[a]).width,r);return n.font=o,{height:s*e.lineHeight,width:r}},bound:function(n,t,e){return Math.max(n,Math.min(t,e))},arrayDiff:function(n,t){var e=n.slice(),i=[],s,o,r,a;for(s=0,r=t.length;s<r;++s)a=t[s],o=e.indexOf(a),o===-1?i.push([a,1]):e.splice(o,1);for(s=0,r=e.length;s<r;++s)i.push([e[s],-1]);return i},rasterize:function(n){return Math.round(n*hh)/hh}};function gr(n,t){var e=t.x,i=t.y;if(e===null)return{x:0,y:-1};if(i===null)return{x:1,y:0};var s=n.x-e,o=n.y-i,r=Math.sqrt(s*s+o*o);return{x:r?s/r:0,y:r?o/r:-1}}function Mv(n,t,e,i,s){switch(s){case"center":e=i=0;break;case"bottom":e=0,i=1;break;case"right":e=1,i=0;break;case"left":e=-1,i=0;break;case"top":e=0,i=-1;break;case"start":e=-e,i=-i;break;case"end":break;default:s*=Math.PI/180,e=Math.cos(s),i=Math.sin(s);break}return{x:n,y:t,vx:e,vy:i}}var Av=0,Ed=1,Td=2,kd=4,Id=8;function Vs(n,t,e){var i=Av;return n<e.left?i|=Ed:n>e.right&&(i|=Td),t<e.top?i|=Id:t>e.bottom&&(i|=kd),i}function Pv(n,t){for(var e=n.x0,i=n.y0,s=n.x1,o=n.y1,r=Vs(e,i,t),a=Vs(s,o,t),l,c,h;!(!(r|a)||r&a);)l=r||a,l&Id?(c=e+(s-e)*(t.top-i)/(o-i),h=t.top):l&kd?(c=e+(s-e)*(t.bottom-i)/(o-i),h=t.bottom):l&Td?(h=i+(o-i)*(t.right-e)/(s-e),c=t.right):l&Ed&&(h=i+(o-i)*(t.left-e)/(s-e),c=t.left),l===r?(e=c,i=h,r=Vs(e,i,t)):(s=c,o=h,a=Vs(s,o,t));return{x0:e,x1:s,y0:i,y1:o}}function $s(n,t){var e=t.anchor,i=n,s,o;return t.clamp&&(i=Pv(i,t.area)),e==="start"?(s=i.x0,o=i.y0):e==="end"?(s=i.x1,o=i.y1):(s=(i.x0+i.x1)/2,o=(i.y0+i.y1)/2),Mv(s,o,n.vx,n.vy,t.align)}var js={arc:function(n,t){var e=(n.startAngle+n.endAngle)/2,i=Math.cos(e),s=Math.sin(e),o=n.innerRadius,r=n.outerRadius;return $s({x0:n.x+i*o,y0:n.y+s*o,x1:n.x+i*r,y1:n.y+s*r,vx:i,vy:s},t)},point:function(n,t){var e=gr(n,t.origin),i=e.x*n.options.radius,s=e.y*n.options.radius;return $s({x0:n.x-i,y0:n.y-s,x1:n.x+i,y1:n.y+s,vx:e.x,vy:e.y},t)},bar:function(n,t){var e=gr(n,t.origin),i=n.x,s=n.y,o=0,r=0;return n.horizontal?(i=Math.min(n.x,n.base),o=Math.abs(n.base-n.x)):(s=Math.min(n.y,n.base),r=Math.abs(n.base-n.y)),$s({x0:i,y0:s+r,x1:i+o,y1:s,vx:e.x,vy:e.y},t)},fallback:function(n,t){var e=gr(n,t.origin);return $s({x0:n.x,y0:n.y,x1:n.x+(n.width||0),y1:n.y+(n.height||0),vx:e.x,vy:e.y},t)}},Re=Vi.rasterize;function Dv(n){var t=n.borderWidth||0,e=n.padding,i=n.size.height,s=n.size.width,o=-s/2,r=-i/2;return{frame:{x:o-e.left-t,y:r-e.top-t,w:s+e.width+t*2,h:i+e.height+t*2},text:{x:o,y:r,w:s,h:i}}}function Rv(n,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var i=e.getBasePixel();return n.horizontal?{x:i,y:null}:{x:null,y:i}}function Ov(n){return n instanceof Yn?js.arc:n instanceof Wi?js.point:n instanceof zi?js.bar:js.fallback}function Nv(n,t,e,i,s,o){var r=Math.PI/2;if(o){var a=Math.min(o,s/2,i/2),l=t+a,c=e+a,h=t+i-a,u=e+s-a;n.moveTo(t,c),l<h&&c<u?(n.arc(l,c,a,-Math.PI,-r),n.arc(h,c,a,-r,0),n.arc(h,u,a,0,r),n.arc(l,u,a,r,Math.PI)):l<h?(n.moveTo(l,e),n.arc(h,c,a,-r,r),n.arc(l,c,a,r,Math.PI+r)):c<u?(n.arc(l,c,a,-Math.PI,0),n.arc(l,u,a,0,Math.PI)):n.arc(l,c,a,-Math.PI,Math.PI),n.closePath(),n.moveTo(t,e)}else n.rect(t,e,i,s)}function Lv(n,t,e){var i=e.backgroundColor,s=e.borderColor,o=e.borderWidth;!i&&(!s||!o)||(n.beginPath(),Nv(n,Re(t.x)+o/2,Re(t.y)+o/2,Re(t.w)-o,Re(t.h)-o,e.borderRadius),n.closePath(),i&&(n.fillStyle=i,n.fill()),s&&o&&(n.strokeStyle=s,n.lineWidth=o,n.lineJoin="miter",n.stroke()))}function Fv(n,t,e){var i=e.lineHeight,s=n.w,o=n.x,r=n.y+i/2;return t==="center"?o+=s/2:(t==="end"||t==="right")&&(o+=s),{h:i,w:s,x:o,y:r}}function Bv(n,t,e){var i=n.shadowBlur,s=e.stroked,o=Re(e.x),r=Re(e.y),a=Re(e.w);s&&n.strokeText(t,o,r,a),e.filled&&(i&&s&&(n.shadowBlur=0),n.fillText(t,o,r,a),i&&s&&(n.shadowBlur=i))}function Hv(n,t,e,i){var s=i.textAlign,o=i.color,r=!!o,a=i.font,l=t.length,c=i.textStrokeColor,h=i.textStrokeWidth,u=c&&h,d;if(!(!l||!r&&!u))for(e=Fv(e,s,a),n.font=a.string,n.textAlign=s,n.textBaseline="middle",n.shadowBlur=i.textShadowBlur,n.shadowColor=i.textShadowColor,r&&(n.fillStyle=o),u&&(n.lineJoin="round",n.lineWidth=h,n.strokeStyle=c),d=0,l=t.length;d<l;++d)Bv(n,t[d],{stroked:u,filled:r,w:e.w,x:e.x,y:e.y+e.h*d})}var Md=function(n,t,e,i){var s=this;s._config=n,s._index=i,s._model=null,s._rects=null,s._ctx=t,s._el=e};xe(Md.prototype,{_modelize:function(n,t,e,i){var s=this,o=s._index,r=vt(rt([e.font,{}],i,o)),a=rt([e.color,ft.color],i,o);return{align:rt([e.align,"center"],i,o),anchor:rt([e.anchor,"center"],i,o),area:i.chart.chartArea,backgroundColor:rt([e.backgroundColor,null],i,o),borderColor:rt([e.borderColor,null],i,o),borderRadius:rt([e.borderRadius,0],i,o),borderWidth:rt([e.borderWidth,0],i,o),clamp:rt([e.clamp,!1],i,o),clip:rt([e.clip,!1],i,o),color:a,display:n,font:r,lines:t,offset:rt([e.offset,4],i,o),opacity:rt([e.opacity,1],i,o),origin:Rv(s._el,i),padding:Nt(rt([e.padding,4],i,o)),positioner:Ov(s._el),rotation:rt([e.rotation,0],i,o)*(Math.PI/180),size:Vi.textSize(s._ctx,t,r),textAlign:rt([e.textAlign,"start"],i,o),textShadowBlur:rt([e.textShadowBlur,0],i,o),textShadowColor:rt([e.textShadowColor,a],i,o),textStrokeColor:rt([e.textStrokeColor,a],i,o),textStrokeWidth:rt([e.textStrokeWidth,0],i,o)}},update:function(n){var t=this,e=null,i=null,s=t._index,o=t._config,r,a,l,c=rt([o.display,!0],n,s);c&&(r=n.dataset.data[s],a=O(et(o.formatter,[r,n]),r),l=V(a)?[]:Vi.toTextLines(a),l.length&&(e=t._modelize(c,l,o,n),i=Dv(e))),t._model=e,t._rects=i},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(n,t){var e=this,i=n.ctx,s=e._model,o=e._rects,r;this.visible()&&(i.save(),s.clip&&(r=s.area,i.beginPath(),i.rect(r.left,r.top,r.right-r.left,r.bottom-r.top),i.clip()),i.globalAlpha=Vi.bound(0,s.opacity,1),i.translate(Re(t.x),Re(t.y)),i.rotate(s.rotation),Lv(i,o.frame,s),Hv(i,s.lines,o.text,s),i.restore())}});var Wv=Number.MIN_SAFE_INTEGER||-9007199254740991,zv=Number.MAX_SAFE_INTEGER||9007199254740991;function xi(n,t,e){var i=Math.cos(e),s=Math.sin(e),o=t.x,r=t.y;return{x:o+i*(n.x-o)-s*(n.y-r),y:r+s*(n.x-o)+i*(n.y-r)}}function uh(n,t){var e=zv,i=Wv,s=t.origin,o,r,a,l,c;for(o=0;o<n.length;++o)r=n[o],a=r.x-s.x,l=r.y-s.y,c=t.vx*a+t.vy*l,e=Math.min(e,c),i=Math.max(i,c);return{min:e,max:i}}function Us(n,t){var e=t.x-n.x,i=t.y-n.y,s=Math.sqrt(e*e+i*i);return{vx:(t.x-n.x)/s,vy:(t.y-n.y)/s,origin:n,ln:s}}var Ad=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};xe(Ad.prototype,{center:function(){var n=this._rect;return{x:n.x+n.w/2,y:n.y+n.h/2}},update:function(n,t,e){this._rotation=e,this._rect={x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}},contains:function(n){var t=this,e=1,i=t._rect;return n=xi(n,t.center(),-t._rotation),!(n.x<i.x-e||n.y<i.y-e||n.x>i.x+i.w+e*2||n.y>i.y+i.h+e*2)},intersects:function(n){var t=this._points(),e=n._points(),i=[Us(t[0],t[1]),Us(t[0],t[3])],s,o,r;for(this._rotation!==n._rotation&&i.push(Us(e[0],e[1]),Us(e[0],e[3])),s=0;s<i.length;++s)if(o=uh(t,i[s]),r=uh(e,i[s]),o.max<r.min||r.max<o.min)return!1;return!0},_points:function(){var n=this,t=n._rect,e=n._rotation,i=n.center();return[xi({x:t.x,y:t.y},i,e),xi({x:t.x+t.w,y:t.y},i,e),xi({x:t.x+t.w,y:t.y+t.h},i,e),xi({x:t.x,y:t.y+t.h},i,e)]}});function Pd(n,t,e){var i=t.positioner(n,t),s=i.vx,o=i.vy;if(!s&&!o)return{x:i.x,y:i.y};var r=e.w,a=e.h,l=t.rotation,c=Math.abs(r/2*Math.cos(l))+Math.abs(a/2*Math.sin(l)),h=Math.abs(r/2*Math.sin(l))+Math.abs(a/2*Math.cos(l)),u=1/Math.max(Math.abs(s),Math.abs(o));return c*=s*u,h*=o*u,c+=t.offset*s,h+=t.offset*o,{x:i.x+c,y:i.y+h}}function Vv(n,t){var e,i,s,o;for(e=n.length-1;e>=0;--e)for(s=n[e].$layout,i=e-1;i>=0&&s._visible;--i)o=n[i].$layout,o._visible&&s._box.intersects(o._box)&&t(s,o);return n}function $v(n){var t,e,i,s,o,r,a;for(t=0,e=n.length;t<e;++t)i=n[t],s=i.$layout,s._visible&&(a=new Proxy(i._el,{get:(l,c)=>l.getProps([c],!0)[c]}),o=i.geometry(),r=Pd(a,i.model(),o),s._box.update(r,o,i.rotation()));return Vv(n,function(l,c){var h=l._hidable,u=c._hidable;h&&u||u?c._visible=!1:h&&(l._visible=!1)})}var $i={prepare:function(n){var t=[],e,i,s,o,r;for(e=0,s=n.length;e<s;++e)for(i=0,o=n[e].length;i<o;++i)r=n[e][i],t.push(r),r.$layout={_box:new Ad,_hidable:!1,_visible:!0,_set:e,_idx:r._index};return t.sort(function(a,l){var c=a.$layout,h=l.$layout;return c._idx===h._idx?h._set-c._set:h._idx-c._idx}),this.update(t),t},update:function(n){var t=!1,e,i,s,o,r;for(e=0,i=n.length;e<i;++e)s=n[e],o=s.model(),r=s.$layout,r._hidable=o&&o.display==="auto",r._visible=s.visible(),t|=r._hidable;t&&$v(n)},lookup:function(n,t){var e,i;for(e=n.length-1;e>=0;--e)if(i=n[e].$layout,i&&i._visible&&i._box.contains(t))return n[e];return null},draw:function(n,t){var e,i,s,o,r,a;for(e=0,i=t.length;e<i;++e)s=t[e],o=s.$layout,o._visible&&(r=s.geometry(),a=Pd(s._el,s.model(),r),o._box.update(a,r,s.rotation()),s.draw(n,a))}},jv=function(n){if(V(n))return null;var t=n,e,i,s;if(j(n))if(!V(n.label))t=n.label;else if(!V(n.r))t=n.r;else for(t="",e=Object.keys(n),s=0,i=e.length;s<i;++s)t+=(s!==0?", ":"")+e[s]+": "+n[e[s]];return""+t},Uv={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:jv,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},Vt="$datalabels",Dd="$default";function Yv(n,t){var e=n.datalabels,i={},s=[],o,r;return e===!1?null:(e===!0&&(e={}),t=xe({},[t,e]),o=t.labels||{},r=Object.keys(o),delete t.labels,r.length?r.forEach(function(a){o[a]&&s.push(xe({},[t,o[a],{_key:a}]))}):s.push(t),i=s.reduce(function(a,l){return Z(l.listeners||{},function(c,h){a[h]=a[h]||{},a[h][l._key||Dd]=c}),delete l.listeners,a},{}),{labels:s,listeners:i})}function Xr(n,t,e,i){if(t){var s=e.$context,o=e.$groups,r;t[o._set]&&(r=t[o._set][o._key],r&&et(r,[s,i])===!0&&(n[Vt]._dirty=!0,e.update(s)))}}function qv(n,t,e,i,s){var o,r;!e&&!i||(e?i?e!==i&&(r=o=!0):r=!0:o=!0,r&&Xr(n,t.leave,e,s),o&&Xr(n,t.enter,i,s))}function Gv(n,t){var e=n[Vt],i=e._listeners,s,o;if(!(!i.enter&&!i.leave)){if(t.type==="mousemove")o=$i.lookup(e._labels,t);else if(t.type!=="mouseout")return;s=e._hovered,e._hovered=o,qv(n,i,s,o,t)}}function Kv(n,t){var e=n[Vt],i=e._listeners.click,s=i&&$i.lookup(e._labels,t);s&&Xr(n,i,s,t)}var Xv={id:"datalabels",defaults:Uv,beforeInit:function(n){n[Vt]={_actives:[]}},beforeUpdate:function(n){var t=n[Vt];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(n,t,e){var i=t.index,s=n[Vt],o=s._datasets[i]=[],r=n.isDatasetVisible(i),a=n.data.datasets[i],l=Yv(a,e),c=t.meta.data||[],h=n.ctx,u,d,f,p,g,m,_,b;for(h.save(),u=0,f=c.length;u<f;++u)if(_=c[u],_[Vt]=[],r&&_&&n.getDataVisibility(u)&&!_.skip)for(d=0,p=l.labels.length;d<p;++d)g=l.labels[d],m=g._key,b=new Md(g,h,_,u),b.$groups={_set:i,_key:m||Dd},b.$context={active:!1,chart:n,dataIndex:u,dataset:a,datasetIndex:i},b.update(b.$context),_[Vt].push(b),o.push(b);h.restore(),xe(s._listeners,l.listeners,{merger:function(x,C,v){C[x]=C[x]||{},C[x][t.index]=v[x],s._listened=!0}})},afterUpdate:function(n){n[Vt]._labels=$i.prepare(n[Vt]._datasets)},afterDatasetsDraw:function(n){$i.draw(n,n[Vt]._labels)},beforeEvent:function(n,t){if(n[Vt]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":Gv(n,e);break;case"click":Kv(n,e);break}}},afterEvent:function(n){var t=n[Vt],e=t._actives,i=t._actives=n.getActiveElements(),s=Vi.arrayDiff(e,i),o,r,a,l,c,h,u;for(o=0,r=s.length;o<r;++o)if(c=s[o],c[1])for(u=c[0].element[Vt]||[],a=0,l=u.length;a<l;++a)h=u[a],h.$context.active=c[1]===1,h.update(h.$context);(t._dirty||s.length)&&($i.update(t._labels),n.render()),delete t._dirty}};const Qv={key:0,class:"absolute top-[41%] text-5xl font-bold"},Jv={key:1,class:"absolute top-[41%] text-5xl font-bold"},Zv={key:2,class:"absolute top-[75%] text-xl font-bold"},t0={key:3,class:"absolute top-[75%] text-xl font-bold"},e0=L("div",{class:"absolute bottom-[0%] left-[25%] text-sm"},"0",-1),n0={key:6,class:"absolute bottom-[0%] left-[67%] text-sm"},i0={key:7,class:"absolute bottom-[0%] left-[67%] text-sm"},s0={key:8,src:gg,alt:"co2 icon",class:"absolute co2-img top-[-10%] left-[-10%] text-4xl"},o0={key:9,src:mg,alt:"co2 icon",class:"absolute co2-img top-[-10%] left-[-10%] text-4xl"},r0={key:0,class:"absolute top-[43%] text-5xl font-bold"},a0={key:1,class:"absolute top-[43%] text-5xl font-bold"},l0=L("div",{class:"absolute top-[75%] text-xl font-bold"},"%",-1),c0=L("div",{class:"absolute bottom-[0%] left-[25%] text-sm"},"0",-1),h0=L("div",{class:"absolute bottom-[0%] left-[67%] text-sm"},"100",-1),u0=L("img",{src:_g,alt:"humidity icon",class:"absolute humidity-img top-[-10%] left-[-10%] text-4xl"},null,-1),d0={key:0,class:"absolute top-[41%] text-5xl font-bold"},f0={key:1,class:"absolute top-[41%] text-5xl font-bold"},p0=L("div",{class:"absolute top-[75%] text-xl font-bold"},"C",-1),g0={key:4,src:ka,alt:"temperature icon",class:"absolute outside-temperature-img top-[-20%] left-[-20%] text-4xl"},m0={key:5,src:ka,alt:"temperature icon",class:"absolute outside-temperature-img top-[-20%] left-[-15%] text-4xl"},_0={class:"absolute top-[41%] text-5xl font-bold"},b0=L("div",{class:"absolute top-[75%] text-xl font-bold"},"C",-1),y0=L("img",{src:ka,alt:"temperature icon",class:"absolute room-temperature-img top-[-20%] left-[-20%] text-4xl"},null,-1),v0={class:"flex flex-col sm:flex-row mt-5"},x0={key:0,class:"flex order-first sm:order-last content-center"},w0=L("div",{class:"text-md lg:text-4xl mt-7 text-center mb-2 text-black"},"Fan",-1),C0=["src"],S0={class:"text-md lg:text-4xl text-center mt-2 lg:mt-5 text-black"},E0=L("div",{class:"text-md lg:text-4xl mt-7 text-center mb-2 text-black"},"Mist",-1),T0=["src"],k0={class:"text-md lg:text-4xl text-center mt-2 lg:mt-5 text-black"},I0={key:1,class:"flex order-first sm:order-last content-center"},M0=L("div",{class:"text-md lg:text-4xl mt-7 text-center mb-2 text-black"},"Heater",-1),A0=["src"],P0={class:"text-md lg:text-4xl text-center mt-2 lg:mt-5 text-black"},D0=L("div",{class:"text-md lg:text-4xl mt-7 text-center mb-2 text-black"},"Mist",-1),R0=["src"],O0={class:"text-md lg:text-4xl text-center mt-2 lg:mt-5 text-black"},N0={key:0,class:"flex flex-col sm:flex-row mt-5"},L0={key:1,class:"flex flex-col sm:flex-row mt-5"},F0={__name:"Chart",props:{co2Concentration:Number,outsideTemperature:Number,roomTemperature:Number,roomHumidity:Number,time:String,fan:Number,mist:Number,temperature:Number,humidity:Number,light:Number,heater:Number,mistMushroom:Number,isMushroomHouse:Boolean},emits:["openSetting"],setup(n,{emit:t}){const e=n,i=S([]),s=S([]),o=S([]),r=S([]),a=S([]),l=S(),c=S(),h=S(""),u=S(""),d=S([100]),f=S([100]),p=S(12),g=S([]),m=S([]),_=S([]),b=S(),x=S(),C=S(""),v=S(""),w=S(!1);gs.register(...vd,Xv);const E=S({labels:[],datasets:[{data:[]}]}),T=S({responsive:!0,scales:{y:{beginAtZero:!0,max:5e3}},plugins:{legend:{position:"top"}}}),M=S({labels:[],datasets:[{data:[]}]}),A=S({responsive:!0,scales:{y:{beginAtZero:!0,max:100}},plugins:{legend:{position:"top"}}}),P=S({labels:[],datasets:[{data:[]}]}),N=S({responsive:!0,scales:{y:{beginAtZero:!0,max:100}},plugins:{legend:{position:"top"}}}),q=S({labels:[],datasets:[{data:[]}]}),dt=S({responsive:!0,scales:{y:{beginAtZero:!0,max:100}},plugins:{legend:{position:"top"}}}),R=S({labels:[],datasets:[{data:[]}]}),B=S({responsive:!0,scales:{y:{beginAtZero:!0,max:2e3}},plugins:{legend:{position:"top"}}}),U=S({labels:[],datasets:[{data:[]}]}),_t=S({responsive:!0}),it=S({labels:[],datasets:[{data:[]}]}),Lt=S({responsive:!0}),H=S({labels:[],datasets:[{data:[]}]}),Y=S({responsive:!0}),ut=S({labels:[],datasets:[{data:[]}]}),K=S({responsive:!0}),St=S({labels:[],datasets:[{data:[]}]}),Pt=S({responsive:!0}),Cs=S({labels:[],datasets:[{data:[]}]}),Fn=S({responsive:!0}),di=S({labels:[],datasets:[{data:[]}]}),Ss=S({responsive:!0}),Bn=S(),wt=S(),G=S(),bt=S(),Hn=()=>{Se(i),e.co2Concentration!==void 0&&i.value.push(e.co2Concentration),Se(s),e.outsideTemperature!==void 0&&s.value.push(e.outsideTemperature),Se(o),e.roomTemperature!==void 0&&o.value.push(e.roomTemperature),Se(r),e.roomHumidity!==void 0&&r.value.push(e.roomHumidity),Se(a),a.value[a.value.length-1]!==e.time&&a.value.push(e.time)},Jo=()=>{Se(g),e.temperature!==void 0&&g.value.push(e.temperature),Se(_),e.light!==void 0&&_.value.push(e.light),Se(m),e.humidity!==void 0&&m.value.push(e.humidity),Se(a),a.value[a.value.length-1]!==e.time&&a.value.push(e.time)},Se=Dt=>{Dt.value.length>19&&Dt.value.splice(0,1)},fi=(Dt,yt,se,ge)=>{yt.value={labels:a.value,datasets:[{label:se,data:Dt.value.slice(),backgroundColor:ge,borderColor:ge,datalabels:{color:"#fff",align:"top",anchor:"start",font:{size:p.value}},tension:.1}]}},Zp=()=>{M.value={labels:a.value,datasets:[{label:"Outside Temperature",data:s.value.slice(),backgroundColor:"#fd1d1d",borderColor:"#fd1d1d",datalabels:{color:"#fff",align:"top",font:{size:p.value}},tension:.1},{label:"Room Temperature",data:o.value.slice(),backgroundColor:"#62cc4c",borderColor:"#62cc4c",datalabels:{color:"#fff",align:"bottom",font:{size:p.value}},tension:.1}]}},ie=(Dt,yt,se,ge,Wl)=>{let Zo=-120,tr=240,pi=78,er=!0,nr=100;ge=="Humidity"?(Zo=-120,tr=240,pi=52):ge=="Edge"?(pi=88,er=!1):ge=="PlaceHolder"?(pi=93,er=!1):ge.includes("Temperature")&&(Zo=-90,tr=360,pi=75),ge=="CO2 Concentration"?nr=5e3:ge=="Light"&&(nr=3e3),yt.value={labels:[ge],datasets:[{label:"",data:[Dt.value[Dt.value.length-1],nr-Dt.value[Dt.value.length-1]],backgroundColor:[Wl,"#e5e7eb"],borderColor:[Wl,"#e5e7eb"],borderWidth:0}]},se.value={rotation:Zo,circumference:tr,cutout:pi,plugins:{tooltip:{enabled:!1},datalabels:{display:!1},legend:{display:er}}}},tg=t,eg=()=>{l.value==1?h.value="./assets/icon/Fan_ON.png":h.value="./assets/icon/Fan_OFF.png",c.value==1?u.value="./assets/icon/PhunSuong_ON.png":u.value="./assets/icon/PhunSuong_OFF.png",b.value==1?C.value="./assets/icon/heater_ON.png":C.value="./assets/icon/heater_OFF.png",x.value==1?v.value="./assets/icon/PhunSuong_ON.png":v.value="./assets/icon/PhunSuong_OFF.png"},Wn=Dt=>{tg("openSetting",Dt)};return Gt(()=>{w.value?(Jo(),fi(_,R,"light","#f7ff00"),fi(m,q,"humidity","#05c8ff"),fi(g,M,"temperature","#fd1d1d"),ie(m,Cs,Fn,"Humidity","#05c8ff"),ie(g,St,Pt,"Temperature","#ff0000"),ie(_,di,Ss,"Light","#f7ff00"),ie(d,Bn,wt,"Edge","rgb(224, 201, 163)"),ie(f,G,bt,"PlaceHolder","#05c8ff")):(Hn(),fi(i,E,"CO2 Concentration","#9ea1a7"),fi(r,P,"Room Humidity","#05c8ff"),Zp(),ie(i,U,_t,"CO2 Concentration","#9ea1a7"),ie(r,it,Lt,"Humidity","#05c8ff"),ie(s,H,Y,"Outside Temperature","#ff0000"),ie(o,ut,K,"Room Temperature","#62cc4c"),ie(d,Bn,wt,"Edge","rgb(224, 201, 163)"),ie(f,G,bt,"PlaceHolder","#05c8ff"))}),Gt(()=>{l.value=e.fan,c.value=e.mist,b.value=e.heater,x.value=e.mistMushroom,eg()}),Cu(()=>{w.value=e.isMushroomHouse}),Ot(()=>{window.innerWidth<1024&&(p.value=9)}),(Dt,yt)=>(F(),tt(us,null,[L("div",{class:Ii(["flex mt-5 flex-wrap",y(w)?"justify-center":""])},[L("div",{class:Ii(["co2-cycle w-1 lg:w-1/4 lg:mx-10 mx-14 mb-8 md:mb-0 flex justify-center relative shadow-2xl hover:opacity-80 cursor-pointer",y(w)?"bg-green":"flex-1"]),onClick:yt[0]||(yt[0]=se=>y(w)?Wn("light"):Wn("co2Concentration"))},[y(w)?X("",!0):(F(),tt("div",Qv,oe(y(i)[y(i).length-1]),1)),y(w)?(F(),tt("div",Jv,oe(y(_)[y(_).length-1]),1)):X("",!0),y(w)?X("",!0):(F(),tt("div",Zv,"PPM")),y(w)?(F(),tt("div",t0,"LUX")):X("",!0),y(w)?X("",!0):(F(),re(y(Te),{key:4,data:y(U),options:y(_t)},null,8,["data","options"])),y(w)?(F(),re(y(Te),{key:5,data:y(di),options:y(Ss)},null,8,["data","options"])):X("",!0),e0,y(w)?X("",!0):(F(),tt("div",n0,"5000")),y(w)?(F(),tt("div",i0,"3000")):X("",!0),y(w)?X("",!0):(F(),tt("img",s0)),y(w)?(F(),tt("img",o0)):X("",!0)],2),L("div",{class:Ii(["humidity-cycle w-1 lg:w-1/4 lg:mx-10 mx-14 mb-8 md:mb-0 flex justify-center relative shadow-2xl hover:opacity-80 cursor-pointer",y(w)?"":"flex-1"]),onClick:yt[1]||(yt[1]=se=>y(w)?Wn("humidity"):Wn("roomHumidity"))},[y(w)?X("",!0):(F(),tt("div",r0,oe(y(r)[y(r).length-1]),1)),y(w)?(F(),tt("div",a0,oe(y(m)[y(m).length-1]),1)):X("",!0),l0,Wt(y(Te),{data:y(G),options:y(bt),class:"absolute z-20 mt-4"},null,8,["data","options"]),Wt(y(Te),{data:y(Bn),options:y(wt),class:"absolute z-10 mt-4"},null,8,["data","options"]),y(w)?X("",!0):(F(),re(y(Te),{key:2,data:y(it),options:y(Lt)},null,8,["data","options"])),y(w)?(F(),re(y(Te),{key:3,data:y(Cs),options:y(Fn)},null,8,["data","options"])):X("",!0),c0,h0,u0],2),L("div",{class:Ii(["temperature-cycle w-1 lg:w-1/4 mb-8 md:mb-0 lg:mx-10 mx-14 flex justify-center relative shadow-2xl pb-1 hover:opacity-80 cursor-pointer",y(w)?"":"flex-1"]),onClick:yt[2]||(yt[2]=se=>y(w)?Wn("temperature"):Wn("outsideTemperature"))},[y(w)?X("",!0):(F(),tt("div",d0,oe(y(s)[y(s).length-1]),1)),y(w)?(F(),tt("div",f0,oe(y(g)[y(g).length-1]),1)):X("",!0),p0,y(w)?X("",!0):(F(),re(y(Te),{key:2,data:y(H),options:y(Y)},null,8,["data","options"])),y(w)?(F(),re(y(Te),{key:3,data:y(St),options:y(Pt)},null,8,["data","options"])):X("",!0),y(w)?X("",!0):(F(),tt("img",g0)),y(w)?(F(),tt("img",m0)):X("",!0)],2),y(w)?X("",!0):(F(),tt("div",{key:0,class:"temperature-cycle room w-1 lg:w-1/4 mb-8 md:mb-0 lg:mx-10 mx-14 flex-1 flex justify-center relative shadow-2xl pb-1 hover:opacity-80 cursor-pointer",onClick:yt[3]||(yt[3]=se=>Dt.$emit("openSetting","roomTemperature"))},[L("div",_0,oe(y(o)[y(o).length-1]),1),b0,Wt(y(Te),{data:y(ut),options:y(K)},null,8,["data","options"]),y0]))],2),L("div",v0,[Wt(y(vi),{data:y(M),options:y(A),class:"outside-temperature max-w-[95%] lg:max-w-[49%] ml-3 order-last sm:order-first"},null,8,["data","options"]),y(w)?X("",!0):(F(),tt("div",x0,[L("div",{class:"w-[40%] h-[70%] lg:my-20 mx-auto lg:mx-20 shadow-lg shadow hover:shadow-2xl px-10 cursor-pointer rounded-3xl bg-[#fff7d6]",onClick:yt[4]||(yt[4]=se=>Dt.$emit("updateValue","fan",y(l)))},[w0,L("img",{class:"fan-img",src:y(h),alt:"fan"},null,8,C0),L("div",S0,"Status: "+oe(y(l)?"ON":"OFF"),1)]),L("div",{class:"w-[40%] h-[70%] lg:my-20 mx-auto shadow-lg shadow hover:shadow-2xl px-10 cursor-pointer rounded-3xl bg-[#b1aab6]",onClick:yt[5]||(yt[5]=se=>Dt.$emit("updateValue","mist",y(c)))},[E0,L("img",{class:"mist-img",src:y(u),alt:"mist"},null,8,T0),L("div",k0,"Status: "+oe(y(c)?"ON":"OFF"),1)])])),y(w)?(F(),tt("div",I0,[L("div",{class:"w-[40%] h-[70%] lg:my-20 mx-auto lg:mx-20 shadow-lg shadow hover:shadow-2xl px-10 cursor-pointer rounded-3xl bg-[#fff7d6]",onClick:yt[6]||(yt[6]=se=>Dt.$emit("updateValue","heater",y(b)))},[M0,L("img",{class:"heater-img",src:y(C),alt:"heater"},null,8,A0),L("div",P0,"Status: "+oe(y(b)?"ON":"OFF"),1)]),L("div",{class:"w-[40%] h-[70%] lg:my-20 mx-auto shadow-lg shadow hover:shadow-2xl px-10 cursor-pointer rounded-3xl bg-[#b1aab6]",onClick:yt[7]||(yt[7]=se=>Dt.$emit("updateValue","mistMushroom",y(x)))},[D0,L("img",{class:"mist-mushroom-img",src:y(v),alt:"mist"},null,8,R0),L("div",O0,"Status: "+oe(y(x)?"ON":"OFF"),1)])])):X("",!0)]),y(w)?X("",!0):(F(),tt("div",N0,[Wt(y(vi),{data:y(E),options:y(T),class:"co2 max-w-[49%] max-w-[95%] lg:max-w-[49%] ml-3"},null,8,["data","options"]),Wt(y(vi),{data:y(P),options:y(N),class:"room-humidity max-w-[49%] max-w-[95%] lg:max-w-[49%] ml-3"},null,8,["data","options"])])),y(w)?(F(),tt("div",L0,[Wt(y(vi),{data:y(R),options:y(B),class:"light max-w-[49%] max-w-[95%] lg:max-w-[49%] ml-3"},null,8,["data","options"]),Wt(y(vi),{data:y(q),options:y(dt),class:"humidity max-w-[49%] max-w-[95%] lg:max-w-[49%] ml-3"},null,8,["data","options"])])):X("",!0)],64))}};let B0=Symbol("headlessui.useid"),H0=0;function Fo(){return ne(B0,()=>`${++H0}`)()}function xt(n){var t;if(n==null||n.value==null)return null;let e=(t=n.value.$el)!=null?t:n.value;return e instanceof Node?e:null}function we(n,t,...e){if(n in t){let s=t[n];return typeof s=="function"?s(...e):s}let i=new Error(`Tried to handle "${n}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(s=>`"${s}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,we),i}var W0=Object.defineProperty,z0=(n,t,e)=>t in n?W0(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,dh=(n,t,e)=>(z0(n,typeof t!="symbol"?t+"":t,e),e);let V0=class{constructor(){dh(this,"current",this.detect()),dh(this,"currentId",0)}set(t){this.current!==t&&(this.currentId=0,this.current=t)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}},ms=new V0;function ri(n){if(ms.isServer)return null;if(n instanceof Node)return n.ownerDocument;if(n!=null&&n.hasOwnProperty("value")){let t=xt(n);if(t)return t.ownerDocument}return document}let Qr=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(n=>`${n}:not([tabindex='-1'])`).join(",");var Ve=(n=>(n[n.First=1]="First",n[n.Previous=2]="Previous",n[n.Next=4]="Next",n[n.Last=8]="Last",n[n.WrapAround=16]="WrapAround",n[n.NoScroll=32]="NoScroll",n))(Ve||{}),Rd=(n=>(n[n.Error=0]="Error",n[n.Overflow=1]="Overflow",n[n.Success=2]="Success",n[n.Underflow=3]="Underflow",n))(Rd||{}),$0=(n=>(n[n.Previous=-1]="Previous",n[n.Next=1]="Next",n))($0||{});function j0(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(Qr)).sort((t,e)=>Math.sign((t.tabIndex||Number.MAX_SAFE_INTEGER)-(e.tabIndex||Number.MAX_SAFE_INTEGER)))}var Od=(n=>(n[n.Strict=0]="Strict",n[n.Loose=1]="Loose",n))(Od||{});function U0(n,t=0){var e;return n===((e=ri(n))==null?void 0:e.body)?!1:we(t,{0(){return n.matches(Qr)},1(){let i=n;for(;i!==null;){if(i.matches(Qr))return!0;i=i.parentElement}return!1}})}var Y0=(n=>(n[n.Keyboard=0]="Keyboard",n[n.Mouse=1]="Mouse",n))(Y0||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",n=>{n.metaKey||n.altKey||n.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",n=>{n.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:n.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function wn(n){n==null||n.focus({preventScroll:!0})}let q0=["textarea","input"].join(",");function G0(n){var t,e;return(e=(t=n==null?void 0:n.matches)==null?void 0:t.call(n,q0))!=null?e:!1}function K0(n,t=e=>e){return n.slice().sort((e,i)=>{let s=t(e),o=t(i);if(s===null||o===null)return 0;let r=s.compareDocumentPosition(o);return r&Node.DOCUMENT_POSITION_FOLLOWING?-1:r&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function io(n,t,{sorted:e=!0,relativeTo:i=null,skipElements:s=[]}={}){var o;let r=(o=Array.isArray(n)?n.length>0?n[0].ownerDocument:document:n==null?void 0:n.ownerDocument)!=null?o:document,a=Array.isArray(n)?e?K0(n):n:j0(n);s.length>0&&a.length>1&&(a=a.filter(p=>!s.includes(p))),i=i??r.activeElement;let l=(()=>{if(t&5)return 1;if(t&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(t&1)return 0;if(t&2)return Math.max(0,a.indexOf(i))-1;if(t&4)return Math.max(0,a.indexOf(i))+1;if(t&8)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=t&32?{preventScroll:!0}:{},u=0,d=a.length,f;do{if(u>=d||u+d<=0)return 0;let p=c+u;if(t&16)p=(p+d)%d;else{if(p<0)return 3;if(p>=d)return 1}f=a[p],f==null||f.focus(h),u+=l}while(f!==r.activeElement);return t&6&&G0(f)&&f.select(),2}function Nd(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function X0(){return/Android/gi.test(window.navigator.userAgent)}function Q0(){return Nd()||X0()}function Ys(n,t,e){ms.isServer||Gt(i=>{document.addEventListener(n,t,e),i(()=>document.removeEventListener(n,t,e))})}function Ld(n,t,e){ms.isServer||Gt(i=>{window.addEventListener(n,t,e),i(()=>window.removeEventListener(n,t,e))})}function J0(n,t,e=Q(()=>!0)){function i(o,r){if(!e.value||o.defaultPrevented)return;let a=r(o);if(a===null||!a.getRootNode().contains(a))return;let l=function c(h){return typeof h=="function"?c(h()):Array.isArray(h)||h instanceof Set?h:[h]}(n);for(let c of l){if(c===null)continue;let h=c instanceof HTMLElement?c:xt(c);if(h!=null&&h.contains(a)||o.composed&&o.composedPath().includes(h))return}return!U0(a,Od.Loose)&&a.tabIndex!==-1&&o.preventDefault(),t(o,a)}let s=S(null);Ys("pointerdown",o=>{var r,a;e.value&&(s.value=((a=(r=o.composedPath)==null?void 0:r.call(o))==null?void 0:a[0])||o.target)},!0),Ys("mousedown",o=>{var r,a;e.value&&(s.value=((a=(r=o.composedPath)==null?void 0:r.call(o))==null?void 0:a[0])||o.target)},!0),Ys("click",o=>{Q0()||s.value&&(i(o,()=>s.value),s.value=null)},!0),Ys("touchend",o=>i(o,()=>o.target instanceof HTMLElement?o.target:null),!0),Ld("blur",o=>i(o,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}var fo=(n=>(n[n.None=0]="None",n[n.RenderStrategy=1]="RenderStrategy",n[n.Static=2]="Static",n))(fo||{}),Ge=(n=>(n[n.Unmount=0]="Unmount",n[n.Hidden=1]="Hidden",n))(Ge||{});function Ce({visible:n=!0,features:t=0,ourProps:e,theirProps:i,...s}){var o;let r=Bd(i,e),a=Object.assign(s,{props:r});if(n||t&2&&r.static)return mr(a);if(t&1){let l=(o=r.unmount)==null||o?0:1;return we(l,{0(){return null},1(){return mr({...s,props:{...r,hidden:!0,style:{display:"none"}}})}})}return mr(a)}function mr({props:n,attrs:t,slots:e,slot:i,name:s}){var o,r;let{as:a,...l}=Hd(n,["unmount","static"]),c=(o=e.default)==null?void 0:o.call(e,i),h={};if(i){let u=!1,d=[];for(let[f,p]of Object.entries(i))typeof p=="boolean"&&(u=!0),p===!0&&d.push(f);u&&(h["data-headlessui-state"]=d.join(" "))}if(a==="template"){if(c=Fd(c??[]),Object.keys(l).length>0||Object.keys(t).length>0){let[u,...d]=c??[];if(!Z0(u)||d.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${s} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(l).concat(Object.keys(t)).map(g=>g.trim()).filter((g,m,_)=>_.indexOf(g)===m).sort((g,m)=>g.localeCompare(m)).map(g=>`  - ${g}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(g=>`  - ${g}`).join(`
`)].join(`
`));let f=Bd((r=u.props)!=null?r:{},l,h),p=og(u,f,!0);for(let g in f)g.startsWith("on")&&(p.props||(p.props={}),p.props[g]=f[g]);return p}return Array.isArray(c)&&c.length===1?c[0]:c}return It(a,Object.assign({},l,h),{default:()=>c})}function Fd(n){return n.flatMap(t=>t.type===us?Fd(t.children):[t])}function Bd(...n){if(n.length===0)return{};if(n.length===1)return n[0];let t={},e={};for(let i of n)for(let s in i)s.startsWith("on")&&typeof i[s]=="function"?(e[s]!=null||(e[s]=[]),e[s].push(i[s])):t[s]=i[s];if(t.disabled||t["aria-disabled"])return Object.assign(t,Object.fromEntries(Object.keys(e).map(i=>[i,void 0])));for(let i in e)Object.assign(t,{[i](s,...o){let r=e[i];for(let a of r){if(s instanceof Event&&s.defaultPrevented)return;a(s,...o)}}});return t}function Hd(n,t=[]){let e=Object.assign({},n);for(let i of t)i in e&&delete e[i];return e}function Z0(n){return n==null?!1:typeof n.type=="string"||typeof n.type=="object"||typeof n.type=="function"}var po=(n=>(n[n.None=1]="None",n[n.Focusable=2]="Focusable",n[n.Hidden=4]="Hidden",n))(po||{});let Jr=Zt({name:"Hidden",props:{as:{type:[Object,String],default:"div"},features:{type:Number,default:1}},setup(n,{slots:t,attrs:e}){return()=>{var i;let{features:s,...o}=n,r={"aria-hidden":(s&2)===2?!0:(i=o["aria-hidden"])!=null?i:void 0,hidden:(s&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(s&4)===4&&(s&2)!==2&&{display:"none"}}};return Ce({ourProps:r,theirProps:o,slot:{},attrs:e,slots:t,name:"Hidden"})}}}),Wd=Symbol("Context");var Jt=(n=>(n[n.Open=1]="Open",n[n.Closed=2]="Closed",n[n.Closing=4]="Closing",n[n.Opening=8]="Opening",n))(Jt||{});function tx(){return Ua()!==null}function Ua(){return ne(Wd,null)}function ex(n){ve(Wd,n)}var zd=(n=>(n.Space=" ",n.Enter="Enter",n.Escape="Escape",n.Backspace="Backspace",n.Delete="Delete",n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown",n.Home="Home",n.End="End",n.PageUp="PageUp",n.PageDown="PageDown",n.Tab="Tab",n))(zd||{});function nx(n){function t(){document.readyState!=="loading"&&(n(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let gn=[];nx(()=>{function n(t){t.target instanceof HTMLElement&&t.target!==document.body&&gn[0]!==t.target&&(gn.unshift(t.target),gn=gn.filter(e=>e!=null&&e.isConnected),gn.splice(10))}window.addEventListener("click",n,{capture:!0}),window.addEventListener("mousedown",n,{capture:!0}),window.addEventListener("focus",n,{capture:!0}),document.body.addEventListener("click",n,{capture:!0}),document.body.addEventListener("mousedown",n,{capture:!0}),document.body.addEventListener("focus",n,{capture:!0})});function Ya(n){typeof queueMicrotask=="function"?queueMicrotask(n):Promise.resolve().then(n).catch(t=>setTimeout(()=>{throw t}))}function _s(){let n=[],t={addEventListener(e,i,s,o){return e.addEventListener(i,s,o),t.add(()=>e.removeEventListener(i,s,o))},requestAnimationFrame(...e){let i=requestAnimationFrame(...e);t.add(()=>cancelAnimationFrame(i))},nextFrame(...e){t.requestAnimationFrame(()=>{t.requestAnimationFrame(...e)})},setTimeout(...e){let i=setTimeout(...e);t.add(()=>clearTimeout(i))},microTask(...e){let i={current:!0};return Ya(()=>{i.current&&e[0]()}),t.add(()=>{i.current=!1})},style(e,i,s){let o=e.style.getPropertyValue(i);return Object.assign(e.style,{[i]:s}),this.add(()=>{Object.assign(e.style,{[i]:o})})},group(e){let i=_s();return e(i),this.add(()=>i.dispose())},add(e){return n.push(e),()=>{let i=n.indexOf(e);if(i>=0)for(let s of n.splice(i,1))s()}},dispose(){for(let e of n.splice(0))e()}};return t}function Vd(n,t,e,i){ms.isServer||Gt(s=>{n=n??window,n.addEventListener(t,e,i),s(()=>n.removeEventListener(t,e,i))})}var Ri=(n=>(n[n.Forwards=0]="Forwards",n[n.Backwards=1]="Backwards",n))(Ri||{});function ix(){let n=S(0);return Ld("keydown",t=>{t.key==="Tab"&&(n.value=t.shiftKey?1:0)}),n}function $d(n){if(!n)return new Set;if(typeof n=="function")return new Set(n());let t=new Set;for(let e of n.value){let i=xt(e);i instanceof HTMLElement&&t.add(i)}return t}var jd=(n=>(n[n.None=1]="None",n[n.InitialFocus=2]="InitialFocus",n[n.TabLock=4]="TabLock",n[n.FocusLock=8]="FocusLock",n[n.RestoreFocus=16]="RestoreFocus",n[n.All=30]="All",n))(jd||{});let wi=Object.assign(Zt({name:"FocusTrap",props:{as:{type:[Object,String],default:"div"},initialFocus:{type:Object,default:null},features:{type:Number,default:30},containers:{type:[Object,Function],default:S(new Set)}},inheritAttrs:!1,setup(n,{attrs:t,slots:e,expose:i}){let s=S(null);i({el:s,$el:s});let o=Q(()=>ri(s)),r=S(!1);Ot(()=>r.value=!0),fe(()=>r.value=!1),ox({ownerDocument:o},Q(()=>r.value&&!!(n.features&16)));let a=rx({ownerDocument:o,container:s,initialFocus:Q(()=>n.initialFocus)},Q(()=>r.value&&!!(n.features&2)));ax({ownerDocument:o,container:s,containers:n.containers,previousActiveElement:a},Q(()=>r.value&&!!(n.features&8)));let l=ix();function c(f){let p=xt(s);p&&(g=>g())(()=>{we(l.value,{[Ri.Forwards]:()=>{io(p,Ve.First,{skipElements:[f.relatedTarget]})},[Ri.Backwards]:()=>{io(p,Ve.Last,{skipElements:[f.relatedTarget]})}})})}let h=S(!1);function u(f){f.key==="Tab"&&(h.value=!0,requestAnimationFrame(()=>{h.value=!1}))}function d(f){if(!r.value)return;let p=$d(n.containers);xt(s)instanceof HTMLElement&&p.add(xt(s));let g=f.relatedTarget;g instanceof HTMLElement&&g.dataset.headlessuiFocusGuard!=="true"&&(Ud(p,g)||(h.value?io(xt(s),we(l.value,{[Ri.Forwards]:()=>Ve.Next,[Ri.Backwards]:()=>Ve.Previous})|Ve.WrapAround,{relativeTo:f.target}):f.target instanceof HTMLElement&&wn(f.target)))}return()=>{let f={},p={ref:s,onKeydown:u,onFocusout:d},{features:g,initialFocus:m,containers:_,...b}=n;return It(us,[!!(g&4)&&It(Jr,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:c,features:po.Focusable}),Ce({ourProps:p,theirProps:{...t,...b},slot:f,attrs:t,slots:e,name:"FocusTrap"}),!!(g&4)&&It(Jr,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:c,features:po.Focusable})])}}}),{features:jd});function sx(n){let t=S(gn.slice());return Rn([n],([e],[i])=>{i===!0&&e===!1?Ya(()=>{t.value.splice(0)}):i===!1&&e===!0&&(t.value=gn.slice())},{flush:"post"}),()=>{var e;return(e=t.value.find(i=>i!=null&&i.isConnected))!=null?e:null}}function ox({ownerDocument:n},t){let e=sx(t);Ot(()=>{Gt(()=>{var i,s;t.value||((i=n.value)==null?void 0:i.activeElement)===((s=n.value)==null?void 0:s.body)&&wn(e())},{flush:"post"})}),fe(()=>{t.value&&wn(e())})}function rx({ownerDocument:n,container:t,initialFocus:e},i){let s=S(null),o=S(!1);return Ot(()=>o.value=!0),fe(()=>o.value=!1),Ot(()=>{Rn([t,e,i],(r,a)=>{if(r.every((c,h)=>(a==null?void 0:a[h])===c)||!i.value)return;let l=xt(t);l&&Ya(()=>{var c,h;if(!o.value)return;let u=xt(e),d=(c=n.value)==null?void 0:c.activeElement;if(u){if(u===d){s.value=d;return}}else if(l.contains(d)){s.value=d;return}u?wn(u):io(l,Ve.First|Ve.NoScroll)===Rd.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),s.value=(h=n.value)==null?void 0:h.activeElement})},{immediate:!0,flush:"post"})}),s}function ax({ownerDocument:n,container:t,containers:e,previousActiveElement:i},s){var o;Vd((o=n.value)==null?void 0:o.defaultView,"focus",r=>{if(!s.value)return;let a=$d(e);xt(t)instanceof HTMLElement&&a.add(xt(t));let l=i.value;if(!l)return;let c=r.target;c&&c instanceof HTMLElement?Ud(a,c)?(i.value=c,wn(c)):(r.preventDefault(),r.stopPropagation(),wn(l)):wn(i.value)},!0)}function Ud(n,t){for(let e of n)if(e.contains(t))return!0;return!1}function lx(n){let t=Ta(n.getSnapshot());return fe(n.subscribe(()=>{t.value=n.getSnapshot()})),t}function cx(n,t){let e=n(),i=new Set;return{getSnapshot(){return e},subscribe(s){return i.add(s),()=>i.delete(s)},dispatch(s,...o){let r=t[s].call(e,...o);r&&(e=r,i.forEach(a=>a()))}}}function hx(){let n;return{before({doc:t}){var e;let i=t.documentElement;n=((e=t.defaultView)!=null?e:window).innerWidth-i.clientWidth},after({doc:t,d:e}){let i=t.documentElement,s=i.clientWidth-i.offsetWidth,o=n-s;e.style(i,"paddingRight",`${o}px`)}}}function ux(){return Nd()?{before({doc:n,d:t,meta:e}){function i(s){return e.containers.flatMap(o=>o()).some(o=>o.contains(s))}t.microTask(()=>{var s;if(window.getComputedStyle(n.documentElement).scrollBehavior!=="auto"){let a=_s();a.style(n.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>a.dispose()))}let o=(s=window.scrollY)!=null?s:window.pageYOffset,r=null;t.addEventListener(n,"click",a=>{if(a.target instanceof HTMLElement)try{let l=a.target.closest("a");if(!l)return;let{hash:c}=new URL(l.href),h=n.querySelector(c);h&&!i(h)&&(r=h)}catch{}},!0),t.addEventListener(n,"touchstart",a=>{if(a.target instanceof HTMLElement)if(i(a.target)){let l=a.target;for(;l.parentElement&&i(l.parentElement);)l=l.parentElement;t.style(l,"overscrollBehavior","contain")}else t.style(a.target,"touchAction","none")}),t.addEventListener(n,"touchmove",a=>{if(a.target instanceof HTMLElement)if(i(a.target)){let l=a.target;for(;l.parentElement&&l.dataset.headlessuiPortal!==""&&!(l.scrollHeight>l.clientHeight||l.scrollWidth>l.clientWidth);)l=l.parentElement;l.dataset.headlessuiPortal===""&&a.preventDefault()}else a.preventDefault()},{passive:!1}),t.add(()=>{var a;let l=(a=window.scrollY)!=null?a:window.pageYOffset;o!==l&&window.scrollTo(0,o),r&&r.isConnected&&(r.scrollIntoView({block:"nearest"}),r=null)})})}}:{}}function dx(){return{before({doc:n,d:t}){t.style(n.documentElement,"overflow","hidden")}}}function fx(n){let t={};for(let e of n)Object.assign(t,e(t));return t}let mn=cx(()=>new Map,{PUSH(n,t){var e;let i=(e=this.get(n))!=null?e:{doc:n,count:0,d:_s(),meta:new Set};return i.count++,i.meta.add(t),this.set(n,i),this},POP(n,t){let e=this.get(n);return e&&(e.count--,e.meta.delete(t)),this},SCROLL_PREVENT({doc:n,d:t,meta:e}){let i={doc:n,d:t,meta:fx(e)},s=[ux(),hx(),dx()];s.forEach(({before:o})=>o==null?void 0:o(i)),s.forEach(({after:o})=>o==null?void 0:o(i))},SCROLL_ALLOW({d:n}){n.dispose()},TEARDOWN({doc:n}){this.delete(n)}});mn.subscribe(()=>{let n=mn.getSnapshot(),t=new Map;for(let[e]of n)t.set(e,e.documentElement.style.overflow);for(let e of n.values()){let i=t.get(e.doc)==="hidden",s=e.count!==0;(s&&!i||!s&&i)&&mn.dispatch(e.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",e),e.count===0&&mn.dispatch("TEARDOWN",e)}});function px(n,t,e){let i=lx(mn),s=Q(()=>{let o=n.value?i.value.get(n.value):void 0;return o?o.count>0:!1});return Rn([n,t],([o,r],[a],l)=>{if(!o||!r)return;mn.dispatch("PUSH",o,e);let c=!1;l(()=>{c||(mn.dispatch("POP",a??o,e),c=!0)})},{immediate:!0}),s}let _r=new Map,Ci=new Map;function fh(n,t=S(!0)){Gt(e=>{var i;if(!t.value)return;let s=xt(n);if(!s)return;e(function(){var r;if(!s)return;let a=(r=Ci.get(s))!=null?r:1;if(a===1?Ci.delete(s):Ci.set(s,a-1),a!==1)return;let l=_r.get(s);l&&(l["aria-hidden"]===null?s.removeAttribute("aria-hidden"):s.setAttribute("aria-hidden",l["aria-hidden"]),s.inert=l.inert,_r.delete(s))});let o=(i=Ci.get(s))!=null?i:0;Ci.set(s,o+1),o===0&&(_r.set(s,{"aria-hidden":s.getAttribute("aria-hidden"),inert:s.inert}),s.setAttribute("aria-hidden","true"),s.inert=!0)})}function gx({defaultContainers:n=[],portals:t,mainTreeNodeRef:e}={}){let i=S(null),s=ri(i);function o(){var r,a,l;let c=[];for(let h of n)h!==null&&(h instanceof HTMLElement?c.push(h):"value"in h&&h.value instanceof HTMLElement&&c.push(h.value));if(t!=null&&t.value)for(let h of t.value)c.push(h);for(let h of(r=s==null?void 0:s.querySelectorAll("html > *, body > *"))!=null?r:[])h!==document.body&&h!==document.head&&h instanceof HTMLElement&&h.id!=="headlessui-portal-root"&&(h.contains(xt(i))||h.contains((l=(a=xt(i))==null?void 0:a.getRootNode())==null?void 0:l.host)||c.some(u=>h.contains(u))||c.push(h));return c}return{resolveContainers:o,contains(r){return o().some(a=>a.contains(r))},mainTreeNodeRef:i,MainTreeNode(){return e!=null?null:It(Jr,{features:po.Hidden,ref:i})}}}let Yd=Symbol("ForcePortalRootContext");function mx(){return ne(Yd,!1)}let ph=Zt({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup(n,{slots:t,attrs:e}){return ve(Yd,n.force),()=>{let{force:i,...s}=n;return Ce({theirProps:s,ourProps:{},slot:{},slots:t,attrs:e,name:"ForcePortalRoot"})}}}),qd=Symbol("StackContext");var Zr=(n=>(n[n.Add=0]="Add",n[n.Remove=1]="Remove",n))(Zr||{});function _x(){return ne(qd,()=>{})}function bx({type:n,enabled:t,element:e,onUpdate:i}){let s=_x();function o(...r){i==null||i(...r),s(...r)}Ot(()=>{Rn(t,(r,a)=>{r?o(0,n,e):a===!0&&o(1,n,e)},{immediate:!0,flush:"sync"})}),fe(()=>{t.value&&o(1,n,e)}),ve(qd,o)}let yx=Symbol("DescriptionContext");function vx({slot:n=S({}),name:t="Description",props:e={}}={}){let i=S([]);function s(o){return i.value.push(o),()=>{let r=i.value.indexOf(o);r!==-1&&i.value.splice(r,1)}}return ve(yx,{register:s,slot:n,name:t,props:e}),Q(()=>i.value.length>0?i.value.join(" "):void 0)}function xx(n){let t=ri(n);if(!t){if(n===null)return null;throw new Error(`[Headless UI]: Cannot find ownerDocument for contextElement: ${n}`)}let e=t.getElementById("headlessui-portal-root");if(e)return e;let i=t.createElement("div");return i.setAttribute("id","headlessui-portal-root"),t.body.appendChild(i)}const ta=new WeakMap;function wx(n){var t;return(t=ta.get(n))!=null?t:0}function gh(n,t){let e=t(wx(n));return e<=0?ta.delete(n):ta.set(n,e),e}let Cx=Zt({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(n,{slots:t,attrs:e}){let i=S(null),s=Q(()=>ri(i)),o=mx(),r=ne(Gd,null),a=S(o===!0||r==null?xx(i.value):r.resolveTarget());a.value&&gh(a.value,d=>d+1);let l=S(!1);Ot(()=>{l.value=!0}),Gt(()=>{o||r!=null&&(a.value=r.resolveTarget())});let c=ne(ea,null),h=!1,u=lg();return Rn(i,()=>{if(h||!c)return;let d=xt(i);d&&(fe(c.register(d),u),h=!0)}),fe(()=>{var d,f;let p=(d=s.value)==null?void 0:d.getElementById("headlessui-portal-root");!p||a.value!==p||gh(a.value,g=>g-1)||a.value.children.length>0||(f=a.value.parentElement)==null||f.removeChild(a.value)}),()=>{if(!l.value||a.value===null)return null;let d={ref:i,"data-headlessui-portal":""};return It(rg,{to:a.value},Ce({ourProps:d,theirProps:n,slot:{},attrs:e,slots:t,name:"Portal"}))}}}),ea=Symbol("PortalParentContext");function Sx(){let n=ne(ea,null),t=S([]);function e(o){return t.value.push(o),n&&n.register(o),()=>i(o)}function i(o){let r=t.value.indexOf(o);r!==-1&&t.value.splice(r,1),n&&n.unregister(o)}let s={register:e,unregister:i,portals:t};return[t,Zt({name:"PortalWrapper",setup(o,{slots:r}){return ve(ea,s),()=>{var a;return(a=r.default)==null?void 0:a.call(r)}}})]}let Gd=Symbol("PortalGroupContext"),Ex=Zt({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(n,{attrs:t,slots:e}){let i=ag({resolveTarget(){return n.target}});return ve(Gd,i),()=>{let{target:s,...o}=n;return Ce({theirProps:o,ourProps:{},slot:{},attrs:t,slots:e,name:"PortalGroup"})}}});var Tx=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(Tx||{});let na=Symbol("DialogContext");function qa(n){let t=ne(na,null);if(t===null){let e=new Error(`<${n} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,qa),e}return t}let qs="DC8F892D-2EBD-447C-A4C8-A03058436FF4",kx=Zt({name:"Dialog",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},open:{type:[Boolean,String],default:qs},initialFocus:{type:Object,default:null},id:{type:String,default:null},role:{type:String,default:"dialog"}},emits:{close:n=>!0},setup(n,{emit:t,attrs:e,slots:i,expose:s}){var o,r;let a=(o=n.id)!=null?o:`headlessui-dialog-${Fo()}`,l=S(!1);Ot(()=>{l.value=!0});let c=!1,h=Q(()=>n.role==="dialog"||n.role==="alertdialog"?n.role:(c||(c=!0,console.warn(`Invalid role [${h}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")),u=S(0),d=Ua(),f=Q(()=>n.open===qs&&d!==null?(d.value&Jt.Open)===Jt.Open:n.open),p=S(null),g=Q(()=>ri(p));if(s({el:p,$el:p}),!(n.open!==qs||d!==null))throw new Error("You forgot to provide an `open` prop to the `Dialog`.");if(typeof f.value!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${f.value===qs?void 0:n.open}`);let m=Q(()=>l.value&&f.value?0:1),_=Q(()=>m.value===0),b=Q(()=>u.value>1),x=ne(na,null)!==null,[C,v]=Sx(),{resolveContainers:w,mainTreeNodeRef:E,MainTreeNode:T}=gx({portals:C,defaultContainers:[Q(()=>{var H;return(H=U.panelRef.value)!=null?H:p.value})]}),M=Q(()=>b.value?"parent":"leaf"),A=Q(()=>d!==null?(d.value&Jt.Closing)===Jt.Closing:!1),P=Q(()=>x||A.value?!1:_.value),N=Q(()=>{var H,Y,ut;return(ut=Array.from((Y=(H=g.value)==null?void 0:H.querySelectorAll("body > *"))!=null?Y:[]).find(K=>K.id==="headlessui-portal-root"?!1:K.contains(xt(E))&&K instanceof HTMLElement))!=null?ut:null});fh(N,P);let q=Q(()=>b.value?!0:_.value),dt=Q(()=>{var H,Y,ut;return(ut=Array.from((Y=(H=g.value)==null?void 0:H.querySelectorAll("[data-headlessui-portal]"))!=null?Y:[]).find(K=>K.contains(xt(E))&&K instanceof HTMLElement))!=null?ut:null});fh(dt,q),bx({type:"Dialog",enabled:Q(()=>m.value===0),element:p,onUpdate:(H,Y)=>{if(Y==="Dialog")return we(H,{[Zr.Add]:()=>u.value+=1,[Zr.Remove]:()=>u.value-=1})}});let R=vx({name:"DialogDescription",slot:Q(()=>({open:f.value}))}),B=S(null),U={titleId:B,panelRef:S(null),dialogState:m,setTitleId(H){B.value!==H&&(B.value=H)},close(){t("close",!1)}};ve(na,U);let _t=Q(()=>!(!_.value||b.value));J0(w,(H,Y)=>{H.preventDefault(),U.close(),xu(()=>Y==null?void 0:Y.focus())},_t);let it=Q(()=>!(b.value||m.value!==0));Vd((r=g.value)==null?void 0:r.defaultView,"keydown",H=>{it.value&&(H.defaultPrevented||H.key===zd.Escape&&(H.preventDefault(),H.stopPropagation(),U.close()))});let Lt=Q(()=>!(A.value||m.value!==0||x));return px(g,Lt,H=>{var Y;return{containers:[...(Y=H.containers)!=null?Y:[],w]}}),Gt(H=>{if(m.value!==0)return;let Y=xt(p);if(!Y)return;let ut=new ResizeObserver(K=>{for(let St of K){let Pt=St.target.getBoundingClientRect();Pt.x===0&&Pt.y===0&&Pt.width===0&&Pt.height===0&&U.close()}});ut.observe(Y),H(()=>ut.disconnect())}),()=>{let{open:H,initialFocus:Y,...ut}=n,K={...e,ref:p,id:a,role:h.value,"aria-modal":m.value===0?!0:void 0,"aria-labelledby":B.value,"aria-describedby":R.value},St={open:m.value===0};return It(ph,{force:!0},()=>[It(Cx,()=>It(Ex,{target:p.value},()=>It(ph,{force:!1},()=>It(wi,{initialFocus:Y,containers:w,features:_.value?we(M.value,{parent:wi.features.RestoreFocus,leaf:wi.features.All&~wi.features.FocusLock}):wi.features.None},()=>It(v,{},()=>Ce({ourProps:K,theirProps:{...ut,...e},slot:St,attrs:e,slots:i,visible:m.value===0,features:fo.RenderStrategy|fo.Static,name:"Dialog"})))))),It(T)])}}}),Ix=Zt({name:"DialogPanel",props:{as:{type:[Object,String],default:"div"},id:{type:String,default:null}},setup(n,{attrs:t,slots:e,expose:i}){var s;let o=(s=n.id)!=null?s:`headlessui-dialog-panel-${Fo()}`,r=qa("DialogPanel");i({el:r.panelRef,$el:r.panelRef});function a(l){l.stopPropagation()}return()=>{let{...l}=n,c={id:o,ref:r.panelRef,onClick:a};return Ce({ourProps:c,theirProps:l,slot:{open:r.dialogState.value===0},attrs:t,slots:e,name:"DialogPanel"})}}}),Mx=Zt({name:"DialogTitle",props:{as:{type:[Object,String],default:"h2"},id:{type:String,default:null}},setup(n,{attrs:t,slots:e}){var i;let s=(i=n.id)!=null?i:`headlessui-dialog-title-${Fo()}`,o=qa("DialogTitle");return Ot(()=>{o.setTitleId(s),fe(()=>o.setTitleId(null))}),()=>{let{...r}=n;return Ce({ourProps:{id:s},theirProps:r,slot:{open:o.dialogState.value===0},attrs:t,slots:e,name:"DialogTitle"})}}});function Ax(n){let t={called:!1};return(...e)=>{if(!t.called)return t.called=!0,n(...e)}}function br(n,...t){n&&t.length>0&&n.classList.add(...t)}function Gs(n,...t){n&&t.length>0&&n.classList.remove(...t)}var ia=(n=>(n.Finished="finished",n.Cancelled="cancelled",n))(ia||{});function Px(n,t){let e=_s();if(!n)return e.dispose;let{transitionDuration:i,transitionDelay:s}=getComputedStyle(n),[o,r]=[i,s].map(a=>{let[l=0]=a.split(",").filter(Boolean).map(c=>c.includes("ms")?parseFloat(c):parseFloat(c)*1e3).sort((c,h)=>h-c);return l});return o!==0?e.setTimeout(()=>t("finished"),o+r):t("finished"),e.add(()=>t("cancelled")),e.dispose}function mh(n,t,e,i,s,o){let r=_s(),a=o!==void 0?Ax(o):()=>{};return Gs(n,...s),br(n,...t,...e),r.nextFrame(()=>{Gs(n,...e),br(n,...i),r.add(Px(n,l=>(Gs(n,...i,...t),br(n,...s),a(l))))}),r.add(()=>Gs(n,...t,...e,...i,...s)),r.add(()=>a("cancelled")),r.dispose}function hn(n=""){return n.split(/\s+/).filter(t=>t.length>1)}let Ga=Symbol("TransitionContext");var Dx=(n=>(n.Visible="visible",n.Hidden="hidden",n))(Dx||{});function Rx(){return ne(Ga,null)!==null}function Ox(){let n=ne(Ga,null);if(n===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return n}function Nx(){let n=ne(Ka,null);if(n===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return n}let Ka=Symbol("NestingContext");function Bo(n){return"children"in n?Bo(n.children):n.value.filter(({state:t})=>t==="visible").length>0}function Kd(n){let t=S([]),e=S(!1);Ot(()=>e.value=!0),fe(()=>e.value=!1);function i(o,r=Ge.Hidden){let a=t.value.findIndex(({id:l})=>l===o);a!==-1&&(we(r,{[Ge.Unmount](){t.value.splice(a,1)},[Ge.Hidden](){t.value[a].state="hidden"}}),!Bo(t)&&e.value&&(n==null||n()))}function s(o){let r=t.value.find(({id:a})=>a===o);return r?r.state!=="visible"&&(r.state="visible"):t.value.push({id:o,state:"visible"}),()=>i(o,Ge.Unmount)}return{children:t,register:s,unregister:i}}let Xd=fo.RenderStrategy,sa=Zt({props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(n,{emit:t,attrs:e,slots:i,expose:s}){let o=S(0);function r(){o.value|=Jt.Opening,t("beforeEnter")}function a(){o.value&=~Jt.Opening,t("afterEnter")}function l(){o.value|=Jt.Closing,t("beforeLeave")}function c(){o.value&=~Jt.Closing,t("afterLeave")}if(!Rx()&&tx())return()=>It(Qd,{...n,onBeforeEnter:r,onAfterEnter:a,onBeforeLeave:l,onAfterLeave:c},i);let h=S(null),u=Q(()=>n.unmount?Ge.Unmount:Ge.Hidden);s({el:h,$el:h});let{show:d,appear:f}=Ox(),{register:p,unregister:g}=Nx(),m=S(d.value?"visible":"hidden"),_={value:!0},b=Fo(),x={value:!1},C=Kd(()=>{!x.value&&m.value!=="hidden"&&(m.value="hidden",g(b),c())});Ot(()=>{let q=p(b);fe(q)}),Gt(()=>{if(u.value===Ge.Hidden&&b){if(d.value&&m.value!=="visible"){m.value="visible";return}we(m.value,{hidden:()=>g(b),visible:()=>p(b)})}});let v=hn(n.enter),w=hn(n.enterFrom),E=hn(n.enterTo),T=hn(n.entered),M=hn(n.leave),A=hn(n.leaveFrom),P=hn(n.leaveTo);Ot(()=>{Gt(()=>{if(m.value==="visible"){let q=xt(h);if(q instanceof Comment&&q.data==="")throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")}})});function N(q){let dt=_.value&&!f.value,R=xt(h);!R||!(R instanceof HTMLElement)||dt||(x.value=!0,d.value&&r(),d.value||l(),q(d.value?mh(R,v,w,E,T,B=>{x.value=!1,B===ia.Finished&&a()}):mh(R,M,A,P,T,B=>{x.value=!1,B===ia.Finished&&(Bo(C)||(m.value="hidden",g(b),c()))})))}return Ot(()=>{Rn([d],(q,dt,R)=>{N(R),_.value=!1},{immediate:!0})}),ve(Ka,C),ex(Q(()=>we(m.value,{visible:Jt.Open,hidden:Jt.Closed})|o.value)),()=>{let{appear:q,show:dt,enter:R,enterFrom:B,enterTo:U,entered:_t,leave:it,leaveFrom:Lt,leaveTo:H,...Y}=n,ut={ref:h},K={...Y,...f.value&&d.value&&ms.isServer?{class:Ii([e.class,Y.class,...v,...w])}:{}};return Ce({theirProps:K,ourProps:ut,slot:{},slots:i,attrs:e,features:Xd,visible:m.value==="visible",name:"TransitionChild"})}}}),Lx=sa,Qd=Zt({inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(n,{emit:t,attrs:e,slots:i}){let s=Ua(),o=Q(()=>n.show===null&&s!==null?(s.value&Jt.Open)===Jt.Open:n.show);Gt(()=>{if(![!0,!1].includes(o.value))throw new Error('A <Transition /> is used but it is missing a `:show="true | false"` prop.')});let r=S(o.value?"visible":"hidden"),a=Kd(()=>{r.value="hidden"}),l=S(!0),c={show:o,appear:Q(()=>n.appear||!l.value)};return Ot(()=>{Gt(()=>{l.value=!1,o.value?r.value="visible":Bo(a)||(r.value="hidden")})}),ve(Ka,a),ve(Ga,c),()=>{let h=Hd(n,["show","appear","unmount","onBeforeEnter","onBeforeLeave","onAfterEnter","onAfterLeave"]),u={unmount:n.unmount};return Ce({ourProps:{...u,as:"template"},theirProps:{},slot:{},slots:{...i,default:()=>[It(Lx,{onBeforeEnter:()=>t("beforeEnter"),onAfterEnter:()=>t("afterEnter"),onBeforeLeave:()=>t("beforeLeave"),onAfterLeave:()=>t("afterLeave"),...e,...u,...h},i.default)]},attrs:{},features:Xd,visible:r.value==="visible",name:"Transition"})}}});const Fx={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},Bx={class:"flex min-h-full items-center justify-center p-4 text-center sm:items-center sm:p-0"},Hx={class:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4"},Wx={class:"sm:flex sm:items-start"},zx={class:"mt-3 lg:mt-7 lg:ml-20 text-center sm:ml-4 sm:mt-0 sm:text-left"},Vx={class:"mt-10"},$x={class:"slider"},jx={class:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},Ux={__name:"Dialog",props:{isOpenDialog:Boolean,typeSetting:String},emits:["resetValue","saveData"],setup(n,{emit:t}){const e=n,i=S(!0),s=S(""),o=S(0),r=t,a=()=>{o.value=0,r("resetValue")},l=()=>{r("saveData",o.value),o.value=0};return Gt(()=>{i.value=e.isOpenDialog,s.value=e.typeSetting}),(c,h)=>(F(),re(y(Qd),{as:"template",show:y(i),class:"z-30"},{default:zn(()=>[Wt(y(kx),{as:"div",class:"relative z-10",onClose:h[4]||(h[4]=u=>{c.$emit("resetValue"),o.value=0})},{default:zn(()=>[Wt(y(sa),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:zn(()=>[L("div",{onClick:a,class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})]),_:1}),L("div",Fx,[L("div",Bx,[Wt(y(sa),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:zn(()=>[Wt(y(Ix),{class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all lg:h-[300px] sm:my-8 sm:w-full sm:max-w-lg"},{default:zn(()=>[L("div",Hx,[L("div",Wx,[L("div",zx,[Wt(y(Mx),{as:"h3",class:"font-semibold leading-6 text-gray-900 text-3xl"},{default:zn(()=>[cg("Setting")]),_:1}),L("div",Vx,[Es(L("input",{type:"number",id:"username","onUpdate:modelValue":h[0]||(h[0]=u=>Ts(o)?o.value=u:null),class:"block w-100 rounded-md border-0 py-2 pl-2 pr-2 text-gray-900 ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring",placeholder:"",min:"0"},null,512),[[ks,y(o)]]),L("div",$x,[y(s)=="co2Concentration"?Es((F(),tt("input",{key:0,type:"range",min:"0",max:"5000","onUpdate:modelValue":h[1]||(h[1]=u=>Ts(o)?o.value=u:null)},null,512)),[[ks,y(o)]]):y(s)=="light"?Es((F(),tt("input",{key:1,type:"range",min:"0",max:"3000","onUpdate:modelValue":h[2]||(h[2]=u=>Ts(o)?o.value=u:null)},null,512)),[[ks,y(o)]]):Es((F(),tt("input",{key:2,type:"range",min:"0",max:"100","onUpdate:modelValue":h[3]||(h[3]=u=>Ts(o)?o.value=u:null)},null,512)),[[ks,y(o)]])])])])])]),L("div",jx,[L("button",{type:"button",class:"inline-flex w-full justify-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 sm:ml-3 sm:w-auto",onClick:l},"Save"),L("button",{type:"button",class:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:a,ref:"cancelButtonRef"},"Cancel",512)])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}},Yx=window.setInterval;var _h={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k=function(n,t){if(!n)throw ai(t)},ai=function(n){return new Error("Firebase Database ("+Jd.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},qx=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const s=n[e++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[e++];t[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[e++],r=n[e++],a=n[e++],l=((s&7)<<18|(o&63)<<12|(r&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const o=n[e++],r=n[e++];t[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|r&63)}}return t.join("")},Xa={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],r=s+1<n.length,a=r?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,h=o>>2,u=(o&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,r||(d=64)),i.push(e[h],e[u],e[d],e[f])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(Zd(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):qx(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=e[n.charAt(s++)],a=s<n.length?e[n.charAt(s)]:0;++s;const c=s<n.length?e[n.charAt(s)]:64;++s;const u=s<n.length?e[n.charAt(s)]:64;if(++s,o==null||a==null||c==null||u==null)throw new Gx;const d=o<<2|a>>4;if(i.push(d),c!==64){const f=a<<4&240|c>>2;if(i.push(f),u!==64){const p=c<<6&192|u;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Gx extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tf=function(n){const t=Zd(n);return Xa.encodeByteArray(t,!0)},go=function(n){return tf(n).replace(/\./g,"")},oa=function(n){try{return Xa.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(n){return ef(void 0,n)}function ef(n,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const e=t;return new Date(e.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return t}for(const e in t)!t.hasOwnProperty(e)||!Xx(e)||(n[e]=ef(n[e],t[e]));return n}function Xx(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=()=>Qx().__FIREBASE_DEFAULTS__,Zx=()=>{if(typeof process>"u"||typeof _h>"u")return;const n=_h.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},tw=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&oa(n[1]);return t&&JSON.parse(t)},nf=()=>{try{return Jx()||Zx()||tw()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ew=n=>{var t,e;return(e=(t=nf())===null||t===void 0?void 0:t.emulatorHosts)===null||e===void 0?void 0:e[n]},nw=n=>{const t=ew(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},sf=()=>{var n;return(n=nf())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[go(JSON.stringify(e)),go(JSON.stringify(r)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function of(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sw())}function ow(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function rw(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rf(){return Jd.NODE_ADMIN===!0}function af(){try{return typeof indexedDB=="object"}catch{return!1}}function lf(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var o;t(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(e){t(e)}})}function aw(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lw="FirebaseError";class Nn extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=lw,Object.setPrototypeOf(this,Nn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wo.prototype.create)}}class Wo{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},s=`${this.service}/${t}`,o=this.errors[t],r=o?cw(o,i):"Error",a=`${this.serviceName}: ${r} (${s}).`;return new Nn(s,a,i)}}function cw(n,t){return n.replace(hw,(e,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const hw=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(n){return JSON.parse(n)}function Mt(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf=function(n){let t={},e={},i={},s="";try{const o=n.split(".");t=ns(oa(o[0])||""),e=ns(oa(o[1])||""),s=o[2],i=e.d||{},delete e.d}catch{}return{header:t,claims:e,data:i,signature:s}},uw=function(n){const t=cf(n),e=t.claims;return!!e&&typeof e=="object"&&e.hasOwnProperty("iat")},dw=function(n){const t=cf(n).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function He(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function ni(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]}function bh(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function mo(n,t,e){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=t.call(e,n[s],s,n));return i}function ra(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const s of e){if(!i.includes(s))return!1;const o=n[s],r=t[s];if(yh(o)&&yh(r)){if(!ra(o,r))return!1}else if(o!==r)return!1}for(const s of i)if(!e.includes(s))return!1;return!0}function yh(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(n){const t=[];for(const[e,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const i=this.W_;if(typeof t=="string")for(let u=0;u<16;u++)i[u]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let u=0;u<16;u++)i[u]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let u=16;u<80;u++){const d=i[u-3]^i[u-8]^i[u-14]^i[u-16];i[u]=(d<<1|d>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],r=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,h;for(let u=0;u<80;u++){u<40?u<20?(c=a^o&(r^a),h=1518500249):(c=o^r^a,h=1859775393):u<60?(c=o&r|a&(o|r),h=2400959708):(c=o^r^a,h=3395469782);const d=(s<<5|s>>>27)+c+l+h+i[u]&4294967295;l=a,a=r,r=(o<<30|o>>>2)&4294967295,o=s,s=d}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+r&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(t,e){if(t==null)return;e===void 0&&(e=t.length);const i=e-this.blockSize;let s=0;const o=this.buf_;let r=this.inbuf_;for(;s<e;){if(r===0)for(;s<=i;)this.compress_(t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(o[r]=t.charCodeAt(s),++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}else for(;s<e;)if(o[r]=t[s],++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}this.inbuf_=r,this.total_+=e}digest(){const t=[];let e=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=e&255,e/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)t[i]=this.chain_[s]>>o&255,++i;return t}}function Qa(n,t){return`${n} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,k(i<n.length,"Surrogate pair missing trail surrogate.");const r=n.charCodeAt(i)-56320;s=65536+(o<<10)+r}s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):s<65536?(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},zo=function(n){let t=0;for(let e=0;e<n.length;e++){const i=n.charCodeAt(e);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,e++):t+=3}return t};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw=1e3,_w=2,bw=4*60*60*1e3,yw=.5;function vh(n,t=mw,e=_w){const i=t*Math.pow(e,n),s=Math.round(yw*i*(Math.random()-.5)*2);return Math.min(bw,i+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(n){return n&&n._delegate?n._delegate:n}class Le{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new Ho;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(ww(t))try{this.getOrInitializeService({instanceIdentifier:fn})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(t=fn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=fn){return this.instances.has(t)}getOptions(t=fn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[o,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);i===a&&r.resolve(s)}return s}onInit(t,e){var i;const s=this.normalizeInstanceIdentifier(e),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(t),this.onInitCallbacks.set(s,o);const r=this.instances.get(s);return r&&t(r,s),()=>{o.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const s of i)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:xw(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=fn){return this.component?this.component.multipleInstances?t:fn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function xw(n){return n===fn?void 0:n}function ww(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new vw(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(st||(st={}));const Sw={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},Ew=st.INFO,Tw={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},kw=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),s=Tw[t];if(s)console[s](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Ja{constructor(t){this.name=t,this._logLevel=Ew,this._logHandler=kw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in st))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Sw[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...t),this._logHandler(this,st.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...t),this._logHandler(this,st.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,st.INFO,...t),this._logHandler(this,st.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,st.WARN,...t),this._logHandler(this,st.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,st.ERROR,...t),this._logHandler(this,st.ERROR,...t)}}const Iw=(n,t)=>t.some(e=>n instanceof e);let xh,wh;function Mw(){return xh||(xh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Aw(){return wh||(wh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const hf=new WeakMap,aa=new WeakMap,uf=new WeakMap,yr=new WeakMap,Za=new WeakMap;function Pw(n){const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",r)},o=()=>{e(Xe(n.result)),s()},r=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",r)});return t.then(e=>{e instanceof IDBCursor&&hf.set(e,n)}).catch(()=>{}),Za.set(t,n),t}function Dw(n){if(aa.has(n))return;const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",r),n.removeEventListener("abort",r)},o=()=>{e(),s()},r=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",r),n.addEventListener("abort",r)});aa.set(n,t)}let la={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return aa.get(n);if(t==="objectStoreNames")return n.objectStoreNames||uf.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Xe(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function Rw(n){la=n(la)}function Ow(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(vr(this),t,...e);return uf.set(i,t.sort?t.sort():[t]),Xe(i)}:Aw().includes(n)?function(...t){return n.apply(vr(this),t),Xe(hf.get(this))}:function(...t){return Xe(n.apply(vr(this),t))}}function Nw(n){return typeof n=="function"?Ow(n):(n instanceof IDBTransaction&&Dw(n),Iw(n,Mw())?new Proxy(n,la):n)}function Xe(n){if(n instanceof IDBRequest)return Pw(n);if(yr.has(n))return yr.get(n);const t=Nw(n);return t!==n&&(yr.set(n,t),Za.set(t,n)),t}const vr=n=>Za.get(n);function df(n,t,{blocked:e,upgrade:i,blocking:s,terminated:o}={}){const r=indexedDB.open(n,t),a=Xe(r);return i&&r.addEventListener("upgradeneeded",l=>{i(Xe(r.result),l.oldVersion,l.newVersion,Xe(r.transaction),l)}),e&&r.addEventListener("blocked",l=>e(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const Lw=["get","getKey","getAll","getAllKeys","count"],Fw=["put","add","delete","clear"],xr=new Map;function Ch(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(xr.get(t))return xr.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,s=Fw.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Lw.includes(e)))return;const o=async function(r,...a){const l=this.transaction(r,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[e](...a),s&&l.done]))[0]};return xr.set(t,o),o}Rw(n=>({...n,get:(t,e,i)=>Ch(t,e)||n.get(t,e,i),has:(t,e)=>!!Ch(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Hw(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function Hw(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const ca="@firebase/app",Sh="0.10.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn=new Ja("@firebase/app"),Ww="@firebase/app-compat",zw="@firebase/analytics-compat",Vw="@firebase/analytics",$w="@firebase/app-check-compat",jw="@firebase/app-check",Uw="@firebase/auth",Yw="@firebase/auth-compat",qw="@firebase/database",Gw="@firebase/database-compat",Kw="@firebase/functions",Xw="@firebase/functions-compat",Qw="@firebase/installations",Jw="@firebase/installations-compat",Zw="@firebase/messaging",tC="@firebase/messaging-compat",eC="@firebase/performance",nC="@firebase/performance-compat",iC="@firebase/remote-config",sC="@firebase/remote-config-compat",oC="@firebase/storage",rC="@firebase/storage-compat",aC="@firebase/firestore",lC="@firebase/firestore-compat",cC="firebase",hC="10.11.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha="[DEFAULT]",uC={[ca]:"fire-core",[Ww]:"fire-core-compat",[Vw]:"fire-analytics",[zw]:"fire-analytics-compat",[jw]:"fire-app-check",[$w]:"fire-app-check-compat",[Uw]:"fire-auth",[Yw]:"fire-auth-compat",[qw]:"fire-rtdb",[Gw]:"fire-rtdb-compat",[Kw]:"fire-fn",[Xw]:"fire-fn-compat",[Qw]:"fire-iid",[Jw]:"fire-iid-compat",[Zw]:"fire-fcm",[tC]:"fire-fcm-compat",[eC]:"fire-perf",[nC]:"fire-perf-compat",[iC]:"fire-rc",[sC]:"fire-rc-compat",[oC]:"fire-gcs",[rC]:"fire-gcs-compat",[aC]:"fire-fst",[lC]:"fire-fst-compat","fire-js":"fire-js",[cC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o=new Map,dC=new Map,ua=new Map;function Eh(n,t){try{n.container.addComponent(t)}catch(e){Tn.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function en(n){const t=n.name;if(ua.has(t))return Tn.debug(`There were multiple attempts to register component ${t}.`),!1;ua.set(t,n);for(const e of _o.values())Eh(e,n);for(const e of dC.values())Eh(e,n);return!0}function tl(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qe=new Wo("app","Firebase",fC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Le("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Qe.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=hC;function ff(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i=Object.assign({name:ha,automaticDataCollectionEnabled:!1},t),s=i.name;if(typeof s!="string"||!s)throw Qe.create("bad-app-name",{appName:String(s)});if(e||(e=sf()),!e)throw Qe.create("no-options");const o=_o.get(s);if(o){if(ra(e,o.options)&&ra(i,o.config))return o;throw Qe.create("duplicate-app",{appName:s})}const r=new Cw(s);for(const l of ua.values())r.addComponent(l);const a=new pC(e,i,r);return _o.set(s,a),a}function mC(n=ha){const t=_o.get(n);if(!t&&n===ha&&sf())return ff();if(!t)throw Qe.create("no-app",{appName:n});return t}function ye(n,t,e){var i;let s=(i=uC[n])!==null&&i!==void 0?i:n;e&&(s+=`-${e}`);const o=s.match(/\s|\//),r=t.match(/\s|\//);if(o||r){const a=[`Unable to register library "${s}" with version "${t}":`];o&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&r&&a.push("and"),r&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Tn.warn(a.join(" "));return}en(new Le(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _C="firebase-heartbeat-database",bC=1,is="firebase-heartbeat-store";let wr=null;function pf(){return wr||(wr=df(_C,bC,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(is)}catch(e){console.warn(e)}}}}).catch(n=>{throw Qe.create("idb-open",{originalErrorMessage:n.message})})),wr}async function yC(n){try{const e=(await pf()).transaction(is),i=await e.objectStore(is).get(gf(n));return await e.done,i}catch(t){if(t instanceof Nn)Tn.warn(t.message);else{const e=Qe.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Tn.warn(e.message)}}}async function Th(n,t){try{const i=(await pf()).transaction(is,"readwrite");await i.objectStore(is).put(t,gf(n)),await i.done}catch(e){if(e instanceof Nn)Tn.warn(e.message);else{const i=Qe.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});Tn.warn(i.message)}}}function gf(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC=1024,xC=30*24*60*60*1e3;class wC{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new SC(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,e;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=kh();if(!(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(r=>r.date===o)))return this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const a=new Date(r.date).valueOf();return Date.now()-a<=xC}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=kh(),{heartbeatsToSend:i,unsentEntries:s}=CC(this._heartbeatsCache.heartbeats),o=go(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function kh(){return new Date().toISOString().substring(0,10)}function CC(n,t=vC){const e=[];let i=n.slice();for(const s of n){const o=e.find(r=>r.agent===s.agent);if(o){if(o.dates.push(s.date),Ih(e)>t){o.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Ih(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class SC{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return af()?lf().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await yC(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const s=await this.read();return Th(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const s=await this.read();return Th(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Ih(n){return go(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EC(n){en(new Le("platform-logger",t=>new Bw(t),"PRIVATE")),en(new Le("heartbeat",t=>new wC(t),"PRIVATE")),ye(ca,Sh,n),ye(ca,Sh,"esm2017"),ye("fire-js","")}EC("");var TC="firebase",kC="10.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ye(TC,kC,"app");var Mh={};const Ah="@firebase/database",Ph="1.0.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mf="";function IC(n){mf=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){e==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Mt(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return e==null?null:ns(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){e==null?delete this.cache_[t]:this.cache_[t]=e}get(t){return He(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const t=window[n];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new MC(t)}}catch{}return new AC},_n=_f("localStorage"),da=_f("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn=new Ja("@firebase/database"),PC=function(){let n=1;return function(){return n++}}(),bf=function(n){const t=gw(n),e=new pw;e.update(t);const i=e.digest();return Xa.encodeByteArray(i)},bs=function(...n){let t="";for(let e=0;e<n.length;e++){const i=n[e];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?t+=bs.apply(null,i):typeof i=="object"?t+=Mt(i):t+=i,t+=" "}return t};let Cn=null,Dh=!0;const DC=function(n,t){k(!t||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Kn.logLevel=st.VERBOSE,Cn=Kn.log.bind(Kn),t&&da.set("logging_enabled",!0)):typeof n=="function"?Cn=n:(Cn=null,da.remove("logging_enabled"))},Bt=function(...n){if(Dh===!0&&(Dh=!1,Cn===null&&da.get("logging_enabled")===!0&&DC(!0)),Cn){const t=bs.apply(null,n);Cn(t)}},ys=function(n){return function(...t){Bt(n,...t)}},fa=function(...n){const t="FIREBASE INTERNAL ERROR: "+bs(...n);Kn.error(t)},Fe=function(...n){const t=`FIREBASE FATAL ERROR: ${bs(...n)}`;throw Kn.error(t),new Error(t)},Yt=function(...n){const t="FIREBASE WARNING: "+bs(...n);Kn.warn(t)},RC=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Yt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},yf=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},OC=function(n){if(document.readyState==="complete")n();else{let t=!1;const e=function(){if(!document.body){setTimeout(e,Math.floor(10));return}t||(t=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&e()}),window.attachEvent("onload",e))}},ii="[MIN_NAME]",kn="[MAX_NAME]",ci=function(n,t){if(n===t)return 0;if(n===ii||t===kn)return-1;if(t===ii||n===kn)return 1;{const e=Rh(n),i=Rh(t);return e!==null?i!==null?e-i===0?n.length-t.length:e-i:-1:i!==null?1:n<t?-1:1}},NC=function(n,t){return n===t?0:n<t?-1:1},Si=function(n,t){if(t&&n in t)return t[n];throw new Error("Missing required key ("+n+") in object: "+Mt(t))},el=function(n){if(typeof n!="object"||n===null)return Mt(n);const t=[];for(const i in n)t.push(i);t.sort();let e="{";for(let i=0;i<t.length;i++)i!==0&&(e+=","),e+=Mt(t[i]),e+=":",e+=el(n[t[i]]);return e+="}",e},vf=function(n,t){const e=n.length;if(e<=t)return[n];const i=[];for(let s=0;s<e;s+=t)s+t>e?i.push(n.substring(s,e)):i.push(n.substring(s,s+t));return i};function Kt(n,t){for(const e in n)n.hasOwnProperty(e)&&t(e,n[e])}const xf=function(n){k(!yf(n),"Invalid JSON number");const t=11,e=52,i=(1<<t-1)-1;let s,o,r,a,l;n===0?(o=0,r=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=a+i,r=Math.round(n*Math.pow(2,e-a)-Math.pow(2,e))):(o=0,r=Math.round(n/Math.pow(2,1-i-e))));const c=[];for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(s?1:0),c.reverse();const h=c.join("");let u="";for(l=0;l<64;l+=8){let d=parseInt(h.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),u=u+d}return u.toLowerCase()},LC=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},FC=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function BC(n,t){let e="Unknown Error";n==="too_big"?e="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?e="Client doesn't have permission to access the desired data.":n==="unavailable"&&(e="The service is unavailable");const i=new Error(n+" at "+t._path.toString()+": "+e);return i.code=n.toUpperCase(),i}const HC=new RegExp("^-?(0*)\\d{1,10}$"),WC=-2147483648,zC=2147483647,Rh=function(n){if(HC.test(n)){const t=Number(n);if(t>=WC&&t<=zC)return t}return null},hi=function(n){try{n()}catch(t){setTimeout(()=>{const e=t.stack||"";throw Yt("Exception was thrown by user callback.",e),t},Math.floor(0))}},VC=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ji=function(n,t){const e=setTimeout(n,t);return typeof e=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):typeof e=="object"&&e.unref&&e.unref(),e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=e==null?void 0:e.getImmediate({optional:!0}),this.appCheck||e==null||e.get().then(i=>this.appCheck=i)}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise((e,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){var e;(e=this.appCheckProvider)===null||e===void 0||e.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){Yt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(t,e,i){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(e=>e&&e.code==="auth/token-not-initialized"?(Bt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Yt(t)}}class Xn{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}Xn.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl="5",wf="v",Cf="s",Sf="r",Ef="f",Tf=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,kf="ls",If="p",pa="ac",Mf="websocket",Af="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(t,e,i,s,o=!1,r="",a=!1,l=!1){this.secure=e,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=_n.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&_n.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}}function UC(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Df(n,t,e){k(typeof t=="string","typeof type must == string"),k(typeof e=="object","typeof params must == object");let i;if(t===Mf)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(t===Af)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);UC(n)&&(e.ns=n.namespace);const s=[];return Kt(e,(o,r)=>{s.push(o+"="+r)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(){this.counters_={}}incrementCounter(t,e=1){He(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return Kx(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr={},Sr={};function il(n){const t=n.toString();return Cr[t]||(Cr[t]=new YC),Cr[t]}function qC(n,t){const e=n.toString();return Sr[e]||(Sr[e]=t()),Sr[e]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&hi(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh="start",KC="close",XC="pLPCommand",QC="pRTLPCB",Rf="id",Of="pw",Nf="ser",JC="cb",ZC="seg",tS="ts",eS="d",nS="dframe",Lf=1870,Ff=30,iS=Lf-Ff,sS=25e3,oS=3e4;class qn{constructor(t,e,i,s,o,r,a){this.connId=t,this.repoInfo=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=r,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ys(t),this.stats_=il(e),this.urlFn=l=>(this.appCheckToken&&(l[pa]=this.appCheckToken),Df(e,Af,l))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new GC(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(oS)),OC(()=>{if(this.isClosed_)return;this.scriptTagHolder=new sl((...o)=>{const[r,a,l,c,h]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===Oh)this.id=a,this.password=l;else if(r===KC)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{const[r,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[Oh]="t",i[Nf]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[JC]=this.scriptTagHolder.uniqueCallbackIdentifier),i[wf]=nl,this.transportSessionId&&(i[Cf]=this.transportSessionId),this.lastSessionId&&(i[kf]=this.lastSessionId),this.applicationId&&(i[If]=this.applicationId),this.appCheckToken&&(i[pa]=this.appCheckToken),typeof location<"u"&&location.hostname&&Tf.test(location.hostname)&&(i[Sf]=Ef);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){qn.forceAllow_=!0}static forceDisallow(){qn.forceDisallow_=!0}static isAvailable(){return qn.forceAllow_?!0:!qn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!LC()&&!FC()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=Mt(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const i=tf(e),s=vf(i,iS);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(t,e){this.myDisconnFrame=document.createElement("iframe");const i={};i[nS]="t",i[Rf]=t,i[Of]=e,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=Mt(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class sl{constructor(t,e,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=PC(),window[XC+this.uniqueCallbackIdentifier]=t,window[QC+this.uniqueCallbackIdentifier]=e,this.myIFrame=sl.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(a){Bt("frame writing exception"),a.stack&&Bt(a.stack),Bt(a)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Bt("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[Rf]=this.myID,t[Of]=this.myPW,t[Nf]=this.currentSerial;let e=this.urlFn(t),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Ff+i.length<=Lf;){const r=this.pendingSegs.shift();i=i+"&"+ZC+s+"="+r.seg+"&"+tS+s+"="+r.ts+"&"+eS+s+"="+r.d,s++}return e=e+i,this.addLongPollTag_(e,this.currentSerial),!0}else return!1}enqueueSegment(t,e,i){this.pendingSegs.push({seg:t,ts:e,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const i=()=>{this.outstandingRequests.delete(e),this.newRequest_()},s=setTimeout(i,Math.floor(sS)),o=()=>{clearTimeout(s),i()};this.addTag(t,o)}addTag(t,e){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=()=>{Bt("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=16384,aS=45e3;let bo=null;typeof MozWebSocket<"u"?bo=MozWebSocket:typeof WebSocket<"u"&&(bo=WebSocket);class ae{constructor(t,e,i,s,o,r,a){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ys(this.connId),this.stats_=il(e),this.connURL=ae.connectionURL_(e,r,a,s,i),this.nodeAdmin=e.nodeAdmin}static connectionURL_(t,e,i,s,o){const r={};return r[wf]=nl,typeof location<"u"&&location.hostname&&Tf.test(location.hostname)&&(r[Sf]=Ef),e&&(r[Cf]=e),i&&(r[kf]=i),s&&(r[pa]=s),o&&(r[If]=o),Df(t,Mf,r)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,_n.set("previous_websocket_failure",!0);try{let i;rf(),this.mySock=new bo(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){ae.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const e=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(e);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&bo!==null&&!ae.forceDisallow_}static previouslyFailed(){return _n.isInMemoryStorage||_n.get("previous_websocket_failure")===!0}markConnectionHealthy(){_n.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const i=ns(e);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(k(this.frames===null,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(e);else{const i=this.extractFrameCount_(e);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const e=Mt(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const i=vf(e,rS);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(aS))}sendString_(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ae.responsesRequiredToBeHealthy=2;ae.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[qn,ae]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const e=ae&&ae.isAvailable();let i=e&&!ae.previouslyFailed();if(t.webSocketOnly&&(e||Yt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[ae];else{const s=this.transports_=[];for(const o of ss.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);ss.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ss.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lS=6e4,cS=5e3,hS=10*1024,uS=100*1024,Er="t",Nh="d",dS="s",Lh="r",fS="e",Fh="o",Bh="a",Hh="n",Wh="p",pS="h";class gS{constructor(t,e,i,s,o,r,a,l,c,h){this.id=t,this.repoInfo_=e,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=r,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ys("c:"+this.id+":"),this.transportManager_=new ss(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,i)},Math.floor(0));const s=t.healthyTimeout||0;s>0&&(this.healthyTimeout_=ji(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>uS?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>hS?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){const e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(Er in t){const e=t[Er];e===Bh?this.upgradeIfSecondaryHealthy_():e===Lh?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):e===Fh&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=Si("t",t),i=Si("d",t);if(e==="c")this.onSecondaryControl_(i);else if(e==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+e)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Wh,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Bh,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Hh,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=Si("t",t),i=Si("d",t);e==="c"?this.onControl_(i):e==="d"&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=Si(Er,t);if(Nh in t){const i=t[Nh];if(e===pS){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(e===Hh){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else e===dS?this.onConnectionShutdown_(i):e===Lh?this.onReset_(i):e===fS?fa("Server Error: "+i):e===Fh?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):fa("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,i=t.v,s=t.h;this.sessionId=t.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),nl!==i&&Yt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,i),ji(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(lS))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ji(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(cS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Wh,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(_n.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{put(t,e,i,s){}merge(t,e,i,s){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,i){}onDisconnectMerge(t,e,i){}onDisconnectCancel(t,e){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(t){this.allowedEvents_=t,this.listeners_={},k(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,e)}}on(t,e,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:i});const s=this.getInitialEvent(t);s&&e.apply(i,s)}off(t,e,i){this.validateEventType_(t);const s=this.listeners_[t]||[];for(let o=0;o<s.length;o++)if(s[o].callback===e&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(t){k(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo extends Hf{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!of()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new yo}getInitialEvent(t){return k(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh=32,Vh=768;class nt{constructor(t,e){if(e===void 0){this.pieces_=t.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)this.pieces_[e]!==""&&(t+="/"+this.pieces_[e]);return t||"/"}}function J(){return new nt("")}function W(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function nn(n){return n.pieces_.length-n.pieceNum_}function ot(n){let t=n.pieceNum_;return t<n.pieces_.length&&t++,new nt(n.pieces_,t)}function Wf(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function mS(n){let t="";for(let e=n.pieceNum_;e<n.pieces_.length;e++)n.pieces_[e]!==""&&(t+="/"+encodeURIComponent(String(n.pieces_[e])));return t||"/"}function zf(n,t=0){return n.pieces_.slice(n.pieceNum_+t)}function Vf(n){if(n.pieceNum_>=n.pieces_.length)return null;const t=[];for(let e=n.pieceNum_;e<n.pieces_.length-1;e++)t.push(n.pieces_[e]);return new nt(t,0)}function Ct(n,t){const e=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)e.push(n.pieces_[i]);if(t instanceof nt)for(let i=t.pieceNum_;i<t.pieces_.length;i++)e.push(t.pieces_[i]);else{const i=t.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&e.push(i[s])}return new nt(e,0)}function $(n){return n.pieceNum_>=n.pieces_.length}function jt(n,t){const e=W(n),i=W(t);if(e===null)return t;if(e===i)return jt(ot(n),ot(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+n+")")}function ol(n,t){if(nn(n)!==nn(t))return!1;for(let e=n.pieceNum_,i=t.pieceNum_;e<=n.pieces_.length;e++,i++)if(n.pieces_[e]!==t.pieces_[i])return!1;return!0}function ce(n,t){let e=n.pieceNum_,i=t.pieceNum_;if(nn(n)>nn(t))return!1;for(;e<n.pieces_.length;){if(n.pieces_[e]!==t.pieces_[i])return!1;++e,++i}return!0}class _S{constructor(t,e){this.errorPrefix_=e,this.parts_=zf(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=zo(this.parts_[i]);$f(this)}}function bS(n,t){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(t),n.byteLength_+=zo(t),$f(n)}function yS(n){const t=n.parts_.pop();n.byteLength_-=zo(t),n.parts_.length>0&&(n.byteLength_-=1)}function $f(n){if(n.byteLength_>Vh)throw new Error(n.errorPrefix_+"has a key path longer than "+Vh+" bytes ("+n.byteLength_+").");if(n.parts_.length>zh)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+zh+") or object contains a cycle "+pn(n))}function pn(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl extends Hf{constructor(){super(["visible"]);let t,e;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new rl}getInitialEvent(t){return k(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=1e3,vS=60*5*1e3,$h=30*1e3,xS=1.3,wS=3e4,CS="server_kill",jh=3;class Ne extends Bf{constructor(t,e,i,s,o,r,a,l){if(super(),this.repoInfo_=t,this.applicationId_=e,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Ne.nextPersistentConnectionId_++,this.log_=ys("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ei,this.maxReconnectDelay_=vS,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!rf())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");rl.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&yo.getInstance().on("online",this.onOnline_,this)}sendRequest(t,e,i){const s=++this.requestNumber_,o={r:s,a:t,b:e};this.log_(Mt(o)),k(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();const e=new Ho,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:r=>{const a=r.d;r.s==="ok"?e.resolve(a):e.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),e.promise}listen(t,e,i,s){this.initConnection_();const o=t._queryIdentifier,r=t._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),k(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),k(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:e,query:t,tag:i};this.listens.get(r).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(i)})}sendListen_(t){const e=t.query,i=e._path.toString(),s=e._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},r="q";t.tag&&(o.q=e._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(r,o,a=>{const l=a.d,c=a.s;Ne.warnOnListenWarnings_(l,e),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(c,l))})}static warnOnListenWarnings_(t,e){if(t&&typeof t=="object"&&He(t,"w")){const i=ni(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+e._queryParams.getIndex().toString()+'"',o=e._path.toString();Yt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||dw(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=$h)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=uw(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(e,i,s=>{const o=s.s,r=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const e=t.s,i=t.d||"error";e==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,i)})}unlisten(t,e){const i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),k(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,e)}sendUnlisten_(t,e,i,s){this.log_("Unlisten on "+t+" for "+e);const o={p:t},r="n";s&&(o.q=i,o.t=s),this.sendRequest(r,o)}onDisconnectPut(t,e,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:i})}onDisconnectMerge(t,e,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:i})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,i,s){const o={p:e,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,r=>{s&&setTimeout(()=>{s(r.s,r.d)},Math.floor(0))})}put(t,e,i,s){this.putInternal("p",t,e,i,s)}merge(t,e,i,s){this.putInternal("m",t,e,i,s)}putInternal(t,e,i,s,o){this.initConnection_();const r={p:e,d:i};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:t,request:r,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,i,o=>{this.log_(e+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Mt(t));const e=t.r,i=this.requestCBHash_[e];i&&(delete this.requestCBHash_[e],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),t==="d"?this.onDataUpdate_(e.p,e.d,!1,e.t):t==="m"?this.onDataUpdate_(e.p,e.d,!0,e.t):t==="c"?this.onListenRevoked_(e.p,e.q):t==="ac"?this.onAuthRevoked_(e.s,e.d):t==="apc"?this.onAppCheckRevoked_(e.s,e.d):t==="sd"?this.onSecurityDebugPacket_(e):fa("Unrecognized action received from server: "+Mt(t)+`
Are you using the latest client?`)}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){k(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ei,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ei,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>wS&&(this.reconnectDelay_=Ei),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=new Date().getTime()-this.lastConnectionAttemptTime_;let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*xS)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),e=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Ne.nextConnectionId_++,o=this.lastSessionId;let r=!1,a=null;const l=function(){a?a.close():(r=!0,i())},c=function(u){k(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(u)};this.realtime_={close:l,sendRequest:c};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[u,d]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);r?Bt("getToken() completed but was canceled"):(Bt("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=d&&d.token,a=new gS(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,e,i,f=>{Yt(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(CS)},o))}catch(u){this.log_("Failed to get token: "+u),r||(this.repoInfo_.nodeAdmin&&Yt(u),l())}}}interrupt(t){Bt("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Bt("Resuming connection for reason: "+t),delete this.interruptReasons_[t],bh(this.interruptReasons_)&&(this.reconnectDelay_=Ei,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let i;e?i=e.map(o=>el(o)).join("$"):i="default";const s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,e){const i=new nt(t).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(e),o.delete(e),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,e){Bt("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=jh&&(this.reconnectDelay_=$h,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){Bt("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=jh&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";t["sdk."+e+"."+mf.replace(/\./g,"-")]=1,of()?t["framework.cordova"]=1:rw()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=yo.getInstance().currentlyOnline();return bh(this.interruptReasons_)&&t}}Ne.nextPersistentConnectionId_=0;Ne.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new z(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const i=new z(ii,t),s=new z(ii,e);return this.compare(i,s)!==0}minPost(){return z.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ks;class jf extends Vo{static get __EMPTY_NODE(){return Ks}static set __EMPTY_NODE(t){Ks=t}compare(t,e){return ci(t.name,e.name)}isDefinedOn(t){throw ai("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return z.MIN}maxPost(){return new z(kn,Ks)}makePost(t,e){return k(typeof t=="string","KeyIndex indexValue must always be a string."),new z(t,Ks)}toString(){return".key"}}const Qn=new jf;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(t,e,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!t.isEmpty();)if(t=t,r=e?i(t.key,e):1,s&&(r*=-1),r<0)this.isReverse_?t=t.left:t=t.right;else if(r===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),e;if(this.resultGenerator_?e=this.resultGenerator_(t.key,t.value):e={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class kt{constructor(t,e,i,s,o){this.key=t,this.value=e,this.color=i??kt.RED,this.left=s??Ut.EMPTY_NODE,this.right=o??Ut.EMPTY_NODE}copy(t,e,i,s,o){return new kt(t??this.key,e??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let s=this;const o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,e,i),null):o===0?s=s.copy(null,e,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,e,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ut.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let i,s;if(i=this,e(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),e(t,i.key)===0){if(i.right.isEmpty())return Ut.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}kt.RED=!0;kt.BLACK=!1;class SS{copy(t,e,i,s,o){return this}insert(t,e,i){return new kt(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ut{constructor(t,e=Ut.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new Ut(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,kt.BLACK,null,null))}remove(t){return new Ut(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,kt.BLACK,null,null))}get(t){let e,i=this.root_;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),e===0)return i.value;e<0?i=i.left:e>0&&(i=i.right)}return null}getPredecessorKey(t){let e,i=this.root_,s=null;for(;!i.isEmpty();)if(e=this.comparator_(t,i.key),e===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else e<0?i=i.left:e>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new Xs(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new Xs(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new Xs(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new Xs(this.root_,null,this.comparator_,!0,t)}}Ut.EMPTY_NODE=new SS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ES(n,t){return ci(n.name,t.name)}function al(n,t){return ci(n,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ga;function TS(n){ga=n}const Uf=function(n){return typeof n=="number"?"number:"+xf(n):"string:"+n},Yf=function(n){if(n.isLeafNode()){const t=n.val();k(typeof t=="string"||typeof t=="number"||typeof t=="object"&&He(t,".sv"),"Priority must be a string or number.")}else k(n===ga||n.isEmpty(),"priority of unexpected type.");k(n===ga||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uh;class Tt{constructor(t,e=Tt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=e,this.lazyHash_=null,k(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Yf(this.priorityNode_)}static set __childrenNodeConstructor(t){Uh=t}static get __childrenNodeConstructor(){return Uh}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Tt(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:Tt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return $(t)?this:W(t)===".priority"?this.priorityNode_:Tt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(t,e){return t===".priority"?this.updatePriority(e):e.isEmpty()&&t!==".priority"?this:Tt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)}updateChild(t,e){const i=W(t);return i===null?e:e.isEmpty()&&i!==".priority"?this:(k(i!==".priority"||nn(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,Tt.__childrenNodeConstructor.EMPTY_NODE.updateChild(ot(t),e)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Uf(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",e==="number"?t+=xf(this.value_):t+=this.value_,this.lazyHash_=bf(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Tt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Tt.__childrenNodeConstructor?-1:(k(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const e=typeof t.value_,i=typeof this.value_,s=Tt.VALUE_TYPE_ORDER.indexOf(e),o=Tt.VALUE_TYPE_ORDER.indexOf(i);return k(s>=0,"Unknown leaf type: "+e),k(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}else return!1}}Tt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qf,Gf;function kS(n){qf=n}function IS(n){Gf=n}class MS extends Vo{compare(t,e){const i=t.node.getPriority(),s=e.node.getPriority(),o=i.compareTo(s);return o===0?ci(t.name,e.name):o}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return z.MIN}maxPost(){return new z(kn,new Tt("[PRIORITY-POST]",Gf))}makePost(t,e){const i=qf(t);return new z(e,new Tt("[PRIORITY-POST]",i))}toString(){return".priority"}}const gt=new MS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=Math.log(2);class PS{constructor(t){const e=o=>parseInt(Math.log(o)/AS,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=e(t+1),this.current_=this.count-1;const s=i(this.count);this.bits_=t+1&s}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const vo=function(n,t,e,i){n.sort(t);const s=function(l,c){const h=c-l;let u,d;if(h===0)return null;if(h===1)return u=n[l],d=e?e(u):u,new kt(d,u.node,kt.BLACK,null,null);{const f=parseInt(h/2,10)+l,p=s(l,f),g=s(f+1,c);return u=n[f],d=e?e(u):u,new kt(d,u.node,kt.BLACK,p,g)}},o=function(l){let c=null,h=null,u=n.length;const d=function(p,g){const m=u-p,_=u;u-=p;const b=s(m+1,_),x=n[m],C=e?e(x):x;f(new kt(C,x.node,g,null,b))},f=function(p){c?(c.left=p,c=p):(h=p,c=p)};for(let p=0;p<l.count;++p){const g=l.nextBitIsOne(),m=Math.pow(2,l.count-(p+1));g?d(m,kt.BLACK):(d(m,kt.BLACK),d(m,kt.RED))}return h},r=new PS(n.length),a=o(r);return new Ut(i||t,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tr;const Un={};class Oe{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return k(Un&&gt,"ChildrenNode.ts has not been loaded"),Tr=Tr||new Oe({".priority":Un},{".priority":gt}),Tr}get(t){const e=ni(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Ut?e:null}hasIndex(t){return He(this.indexSet_,t.toString())}addIndex(t,e){k(t!==Qn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=e.getIterator(z.Wrap);let r=o.getNext();for(;r;)s=s||t.isDefinedOn(r.node),i.push(r),r=o.getNext();let a;s?a=vo(i,t.getCompare()):a=Un;const l=t.toString(),c=Object.assign({},this.indexSet_);c[l]=t;const h=Object.assign({},this.indexes_);return h[l]=a,new Oe(h,c)}addToIndexes(t,e){const i=mo(this.indexes_,(s,o)=>{const r=ni(this.indexSet_,o);if(k(r,"Missing index implementation for "+o),s===Un)if(r.isDefinedOn(t.node)){const a=[],l=e.getIterator(z.Wrap);let c=l.getNext();for(;c;)c.name!==t.name&&a.push(c),c=l.getNext();return a.push(t),vo(a,r.getCompare())}else return Un;else{const a=e.get(t.name);let l=s;return a&&(l=l.remove(new z(t.name,a))),l.insert(t,t.node)}});return new Oe(i,this.indexSet_)}removeFromIndexes(t,e){const i=mo(this.indexes_,s=>{if(s===Un)return s;{const o=e.get(t.name);return o?s.remove(new z(t.name,o)):s}});return new Oe(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ti;class D{constructor(t,e,i){this.children_=t,this.priorityNode_=e,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Yf(this.priorityNode_),this.children_.isEmpty()&&k(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ti||(Ti=new D(new Ut(al),null,Oe.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ti}updatePriority(t){return this.children_.isEmpty()?this:new D(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const e=this.children_.get(t);return e===null?Ti:e}}getChild(t){const e=W(t);return e===null?this:this.getImmediateChild(e).getChild(ot(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,e){if(k(e,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(e);{const i=new z(t,e);let s,o;e.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,e),o=this.indexMap_.addToIndexes(i,this.children_));const r=s.isEmpty()?Ti:this.priorityNode_;return new D(s,r,o)}}updateChild(t,e){const i=W(t);if(i===null)return e;{k(W(t)!==".priority"||nn(t)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(ot(t),e);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const e={};let i=0,s=0,o=!0;if(this.forEachChild(gt,(r,a)=>{e[r]=a.val(t),i++,o&&D.INTEGER_REGEXP_.test(r)?s=Math.max(s,Number(r)):o=!1}),!t&&o&&s<2*i){const r=[];for(const a in e)r[a]=e[a];return r}else return t&&!this.getPriority().isEmpty()&&(e[".priority"]=this.getPriority().val()),e}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+Uf(this.getPriority().val())+":"),this.forEachChild(gt,(e,i)=>{const s=i.hash();s!==""&&(t+=":"+e+":"+s)}),this.lazyHash_=t===""?"":bf(t)}return this.lazyHash_}getPredecessorChildName(t,e,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new z(t,e));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const i=e.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new z(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const i=e.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new z(e,this.children_.get(e)):null}forEachChild(t,e){const i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>e(s.name,s.node)):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const i=this.resolveIndex_(e);if(i)return i.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,z.Wrap);let o=s.peek();for(;o!=null&&e.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const i=this.resolveIndex_(e);if(i)return i.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,z.Wrap);let o=s.peek();for(;o!=null&&e.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===vs?-1:0}withIndex(t){if(t===Qn||this.indexMap_.hasIndex(t))return this;{const e=this.indexMap_.addIndex(t,this.children_);return new D(this.children_,this.priorityNode_,e)}}isIndexed(t){return t===Qn||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority()))if(this.children_.count()===e.children_.count()){const i=this.getIterator(gt),s=e.getIterator(gt);let o=i.getNext(),r=s.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=i.getNext(),r=s.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(t){return t===Qn?null:this.indexMap_.get(t.toString())}}D.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class DS extends D{constructor(){super(new Ut(al),D.EMPTY_NODE,Oe.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return D.EMPTY_NODE}isEmpty(){return!1}}const vs=new DS;Object.defineProperties(z,{MIN:{value:new z(ii,D.EMPTY_NODE)},MAX:{value:new z(kn,vs)}});jf.__EMPTY_NODE=D.EMPTY_NODE;Tt.__childrenNodeConstructor=D;TS(vs);IS(vs);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=!0;function Rt(n,t=null){if(n===null)return D.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(t=n[".priority"]),k(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const e=n;return new Tt(e,Rt(t))}if(!(n instanceof Array)&&RS){const e=[];let i=!1;if(Kt(n,(r,a)=>{if(r.substring(0,1)!=="."){const l=Rt(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),e.push(new z(r,l)))}}),e.length===0)return D.EMPTY_NODE;const o=vo(e,ES,r=>r.name,al);if(i){const r=vo(e,gt.getCompare());return new D(o,Rt(t),new Oe({".priority":r},{".priority":gt}))}else return new D(o,Rt(t),Oe.Default)}else{let e=D.EMPTY_NODE;return Kt(n,(i,s)=>{if(He(n,i)&&i.substring(0,1)!=="."){const o=Rt(s);(o.isLeafNode()||!o.isEmpty())&&(e=e.updateImmediateChild(i,o))}}),e.updatePriority(Rt(t))}}kS(Rt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS extends Vo{constructor(t){super(),this.indexPath_=t,k(!$(t)&&W(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const i=this.extractChild(t.node),s=this.extractChild(e.node),o=i.compareTo(s);return o===0?ci(t.name,e.name):o}makePost(t,e){const i=Rt(t),s=D.EMPTY_NODE.updateChild(this.indexPath_,i);return new z(e,s)}maxPost(){const t=D.EMPTY_NODE.updateChild(this.indexPath_,vs);return new z(kn,t)}toString(){return zf(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS extends Vo{compare(t,e){const i=t.node.compareTo(e.node);return i===0?ci(t.name,e.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return z.MIN}maxPost(){return z.MAX}makePost(t,e){const i=Rt(t);return new z(e,i)}toString(){return".value"}}const LS=new NS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(n){return{type:"value",snapshotNode:n}}function si(n,t){return{type:"child_added",snapshotNode:t,childName:n}}function os(n,t){return{type:"child_removed",snapshotNode:t,childName:n}}function rs(n,t,e){return{type:"child_changed",snapshotNode:t,childName:n,oldSnap:e}}function FS(n,t){return{type:"child_moved",snapshotNode:t,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(t){this.index_=t}updateChild(t,e,i,s,o,r){k(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(e);return a.getChild(s).equals(i.getChild(s))&&a.isEmpty()===i.isEmpty()||(r!=null&&(i.isEmpty()?t.hasChild(e)?r.trackChildChange(os(e,a)):k(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?r.trackChildChange(si(e,i)):r.trackChildChange(rs(e,i,a))),t.isLeafNode()&&i.isEmpty())?t:t.updateImmediateChild(e,i).withIndex(this.index_)}updateFullNode(t,e,i){return i!=null&&(t.isLeafNode()||t.forEachChild(gt,(s,o)=>{e.hasChild(s)||i.trackChildChange(os(s,o))}),e.isLeafNode()||e.forEachChild(gt,(s,o)=>{if(t.hasChild(s)){const r=t.getImmediateChild(s);r.equals(o)||i.trackChildChange(rs(s,o,r))}else i.trackChildChange(si(s,o))})),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?D.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(t){this.indexedFilter_=new ll(t.getIndex()),this.index_=t.getIndex(),this.startPost_=as.getStartPost_(t),this.endPost_=as.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,i=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&i}updateChild(t,e,i,s,o,r){return this.matches(new z(e,i))||(i=D.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,i,s,o,r)}updateFullNode(t,e,i){e.isLeafNode()&&(e=D.EMPTY_NODE);let s=e.withIndex(this.index_);s=s.updatePriority(D.EMPTY_NODE);const o=this;return e.forEachChild(gt,(r,a)=>{o.matches(new z(r,a))||(s=s.updateImmediateChild(r,D.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,s,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(t){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=e=>{const i=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new as(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,i,s,o,r){return this.rangedFilter_.matches(new z(e,i))||(i=D.EMPTY_NODE),t.getImmediateChild(e).equals(i)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,i,s,o,r):this.fullLimitUpdateChild_(t,e,i,o,r)}updateFullNode(t,e,i){let s;if(e.isLeafNode()||e.isEmpty())s=D.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<e.numChildren()&&e.isIndexed(this.index_)){s=D.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){const a=o.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),r++;else break;else continue}}else{s=e.withIndex(this.index_),s=s.updatePriority(D.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let r=0;for(;o.hasNext();){const a=o.getNext();r<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?r++:s=s.updateImmediateChild(a.name,D.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,s,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,i,s,o){let r;if(this.reverse_){const u=this.index_.getCompare();r=(d,f)=>u(f,d)}else r=this.index_.getCompare();const a=t;k(a.numChildren()===this.limit_,"");const l=new z(e,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(e)){const u=a.getImmediateChild(e);let d=s.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===e||a.hasChild(d.name));)d=s.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:r(d,l);if(h&&!i.isEmpty()&&f>=0)return o!=null&&o.trackChildChange(rs(e,i,u)),a.updateImmediateChild(e,i);{o!=null&&o.trackChildChange(os(e,u));const g=a.updateImmediateChild(e,D.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(o!=null&&o.trackChildChange(si(d.name,d.node)),g.updateImmediateChild(d.name,d.node)):g}}else return i.isEmpty()?t:h&&r(c,l)>=0?(o!=null&&(o.trackChildChange(os(c.name,c.node)),o.trackChildChange(si(e,i))),a.updateImmediateChild(e,i).updateImmediateChild(c.name,D.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=gt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return k(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return k(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ii}hasEnd(){return this.endSet_}getIndexEndValue(){return k(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return k(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:kn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return k(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===gt}copy(){const t=new cl;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function HS(n){return n.loadsAllData()?new ll(n.getIndex()):n.hasLimit()?new BS(n):new as(n)}function Yh(n){const t={};if(n.isDefault())return t;let e;if(n.index_===gt?e="$priority":n.index_===LS?e="$value":n.index_===Qn?e="$key":(k(n.index_ instanceof OS,"Unrecognized index type!"),e=n.index_.toString()),t.orderBy=Mt(e),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";t[i]=Mt(n.indexStartValue_),n.startNameSet_&&(t[i]+=","+Mt(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";t[i]=Mt(n.indexEndValue_),n.endNameSet_&&(t[i]+=","+Mt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?t.limitToFirst=n.limit_:t.limitToLast=n.limit_),t}function qh(n){const t={};if(n.startSet_&&(t.sp=n.indexStartValue_,n.startNameSet_&&(t.sn=n.indexStartName_),t.sin=!n.startAfterSet_),n.endSet_&&(t.ep=n.indexEndValue_,n.endNameSet_&&(t.en=n.indexEndName_),t.ein=!n.endBeforeSet_),n.limitSet_){t.l=n.limit_;let e=n.viewFrom_;e===""&&(n.isViewFromLeft()?e="l":e="r"),t.vf=e}return n.index_!==gt&&(t.i=n.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo extends Bf{constructor(t,e,i,s){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=ys("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return e!==void 0?"tag$"+e:(k(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,i,s){const o=t._path.toString();this.log_("Listen called for "+o+" "+t._queryIdentifier);const r=xo.getListenId_(t,i),a={};this.listens_[r]=a;const l=Yh(t._queryParams);this.restRequest_(o+".json",l,(c,h)=>{let u=h;if(c===404&&(u=null,c=null),c===null&&this.onDataUpdate_(o,u,!1,i),ni(this.listens_,r)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",s(d,null)}})}unlisten(t,e){const i=xo.getListenId_(t,e);delete this.listens_[i]}get(t){const e=Yh(t._queryParams),i=t._path.toString(),s=new Ho;return this.restRequest_(i+".json",e,(o,r)=>{let a=r;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(i,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(t){}restRequest_(t,e={},i){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(e.auth=s.accessToken),o&&o.token&&(e.ac=o.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+fw(e);this.log_("Sending REST request for "+r);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+r+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=ns(a.responseText)}catch{Yt("Failed to parse JSON response for "+r+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&Yt("Got unsuccessful REST response for "+r+" Status: "+a.status),i(a.status);i=null}},a.open("GET",r,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(){this.rootNode_=D.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wo(){return{value:null,children:new Map}}function Xf(n,t,e){if($(t))n.value=e,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(t,e);else{const i=W(t);n.children.has(i)||n.children.set(i,wo());const s=n.children.get(i);t=ot(t),Xf(s,t,e)}}function ma(n,t,e){n.value!==null?e(t,n.value):zS(n,(i,s)=>{const o=new nt(t.toString()+"/"+i);ma(s,o,e)})}function zS(n,t){n.children.forEach((e,i)=>{t(i,e)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&Kt(this.last_,(i,s)=>{e[i]=e[i]-s}),this.last_=t,e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gh=10*1e3,$S=30*1e3,jS=5*60*1e3;class US{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new VS(t);const i=Gh+($S-Gh)*Math.random();ji(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),e={};let i=!1;Kt(t,(s,o)=>{o>0&&He(this.statsToReport_,s)&&(e[s]=o,i=!0)}),i&&this.server_.reportStats(e),ji(this.reportStats_.bind(this),Math.floor(Math.random()*2*jS))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var he;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(he||(he={}));function Qf(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function hl(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ul(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(t,e,i){this.path=t,this.affectedTree=e,this.revert=i,this.type=he.ACK_USER_WRITE,this.source=Qf()}operationForChild(t){if($(this.path)){if(this.affectedTree.value!=null)return k(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new nt(t));return new Co(J(),e,this.revert)}}else return k(W(this.path)===t,"operationForChild called for unrelated child."),new Co(ot(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(t,e){this.source=t,this.path=e,this.type=he.LISTEN_COMPLETE}operationForChild(t){return $(this.path)?new ls(this.source,J()):new ls(this.source,ot(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(t,e,i){this.source=t,this.path=e,this.snap=i,this.type=he.OVERWRITE}operationForChild(t){return $(this.path)?new In(this.source,J(),this.snap.getImmediateChild(t)):new In(this.source,ot(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(t,e,i){this.source=t,this.path=e,this.children=i,this.type=he.MERGE}operationForChild(t){if($(this.path)){const e=this.children.subtree(new nt(t));return e.isEmpty()?null:e.value?new In(this.source,J(),e.value):new cs(this.source,J(),e)}else return k(W(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new cs(this.source,ot(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(t,e,i){this.node_=t,this.fullyInitialized_=e,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if($(t))return this.isFullyInitialized()&&!this.filtered_;const e=W(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function qS(n,t,e,i){const s=[],o=[];return t.forEach(r=>{r.type==="child_changed"&&n.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(FS(r.childName,r.snapshotNode))}),ki(n,s,"child_removed",t,i,e),ki(n,s,"child_added",t,i,e),ki(n,s,"child_moved",o,i,e),ki(n,s,"child_changed",t,i,e),ki(n,s,"value",t,i,e),s}function ki(n,t,e,i,s,o){const r=i.filter(a=>a.type===e);r.sort((a,l)=>KS(n,a,l)),r.forEach(a=>{const l=GS(n,a,o);s.forEach(c=>{c.respondsTo(a.type)&&t.push(c.createEvent(l,n.query_))})})}function GS(n,t,e){return t.type==="value"||t.type==="child_removed"||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,n.index_)),t}function KS(n,t,e){if(t.childName==null||e.childName==null)throw ai("Should only compare child_ events.");const i=new z(t.childName,t.snapshotNode),s=new z(e.childName,e.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(n,t){return{eventCache:n,serverCache:t}}function Ui(n,t,e,i){return $o(new Mn(t,e,i),n.serverCache)}function Jf(n,t,e,i){return $o(n.eventCache,new Mn(t,e,i))}function _a(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function An(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kr;const XS=()=>(kr||(kr=new Ut(NC)),kr);class at{constructor(t,e=XS()){this.value=t,this.children=e}static fromObject(t){let e=new at(null);return Kt(t,(i,s)=>{e=e.set(new nt(i),s)}),e}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(this.value!=null&&e(this.value))return{path:J(),value:this.value};if($(t))return null;{const i=W(t),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(ot(t),e);return o!=null?{path:Ct(new nt(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if($(t))return this;{const e=W(t),i=this.children.get(e);return i!==null?i.subtree(ot(t)):new at(null)}}set(t,e){if($(t))return new at(e,this.children);{const i=W(t),o=(this.children.get(i)||new at(null)).set(ot(t),e),r=this.children.insert(i,o);return new at(this.value,r)}}remove(t){if($(t))return this.children.isEmpty()?new at(null):new at(null,this.children);{const e=W(t),i=this.children.get(e);if(i){const s=i.remove(ot(t));let o;return s.isEmpty()?o=this.children.remove(e):o=this.children.insert(e,s),this.value===null&&o.isEmpty()?new at(null):new at(this.value,o)}else return this}}get(t){if($(t))return this.value;{const e=W(t),i=this.children.get(e);return i?i.get(ot(t)):null}}setTree(t,e){if($(t))return e;{const i=W(t),o=(this.children.get(i)||new at(null)).setTree(ot(t),e);let r;return o.isEmpty()?r=this.children.remove(i):r=this.children.insert(i,o),new at(this.value,r)}}fold(t){return this.fold_(J(),t)}fold_(t,e){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(Ct(t,s),e)}),e(t,this.value,i)}findOnPath(t,e){return this.findOnPath_(t,J(),e)}findOnPath_(t,e,i){const s=this.value?i(e,this.value):!1;if(s)return s;if($(t))return null;{const o=W(t),r=this.children.get(o);return r?r.findOnPath_(ot(t),Ct(e,o),i):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,J(),e)}foreachOnPath_(t,e,i){if($(t))return this;{this.value&&i(e,this.value);const s=W(t),o=this.children.get(s);return o?o.foreachOnPath_(ot(t),Ct(e,s),i):new at(null)}}foreach(t){this.foreach_(J(),t)}foreach_(t,e){this.children.inorderTraversal((i,s)=>{s.foreach_(Ct(t,i),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,i)=>{i.value&&t(e,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(t){this.writeTree_=t}static empty(){return new de(new at(null))}}function Yi(n,t,e){if($(t))return new de(new at(e));{const i=n.writeTree_.findRootMostValueAndPath(t);if(i!=null){const s=i.path;let o=i.value;const r=jt(s,t);return o=o.updateChild(r,e),new de(n.writeTree_.set(s,o))}else{const s=new at(e),o=n.writeTree_.setTree(t,s);return new de(o)}}}function Kh(n,t,e){let i=n;return Kt(e,(s,o)=>{i=Yi(i,Ct(t,s),o)}),i}function Xh(n,t){if($(t))return de.empty();{const e=n.writeTree_.setTree(t,new at(null));return new de(e)}}function ba(n,t){return Ln(n,t)!=null}function Ln(n,t){const e=n.writeTree_.findRootMostValueAndPath(t);return e!=null?n.writeTree_.get(e.path).getChild(jt(e.path,t)):null}function Qh(n){const t=[],e=n.writeTree_.value;return e!=null?e.isLeafNode()||e.forEachChild(gt,(i,s)=>{t.push(new z(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&t.push(new z(i,s.value))}),t}function Je(n,t){if($(t))return n;{const e=Ln(n,t);return e!=null?new de(new at(e)):new de(n.writeTree_.subtree(t))}}function ya(n){return n.writeTree_.isEmpty()}function oi(n,t){return Zf(J(),n.writeTree_,t)}function Zf(n,t,e){if(t.value!=null)return e.updateChild(n,t.value);{let i=null;return t.children.inorderTraversal((s,o)=>{s===".priority"?(k(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):e=Zf(Ct(n,s),o,e)}),!e.getChild(n).isEmpty()&&i!==null&&(e=e.updateChild(Ct(n,".priority"),i)),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dl(n,t){return ip(t,n)}function QS(n,t,e,i,s){k(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:t,snap:e,writeId:i,visible:s}),s&&(n.visibleWrites=Yi(n.visibleWrites,t,e)),n.lastWriteId=i}function JS(n,t){for(let e=0;e<n.allWrites.length;e++){const i=n.allWrites[e];if(i.writeId===t)return i}return null}function ZS(n,t){const e=n.allWrites.findIndex(a=>a.writeId===t);k(e>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[e];n.allWrites.splice(e,1);let s=i.visible,o=!1,r=n.allWrites.length-1;for(;s&&r>=0;){const a=n.allWrites[r];a.visible&&(r>=e&&tE(a,i.path)?s=!1:ce(i.path,a.path)&&(o=!0)),r--}if(s){if(o)return eE(n),!0;if(i.snap)n.visibleWrites=Xh(n.visibleWrites,i.path);else{const a=i.children;Kt(a,l=>{n.visibleWrites=Xh(n.visibleWrites,Ct(i.path,l))})}return!0}else return!1}function tE(n,t){if(n.snap)return ce(n.path,t);for(const e in n.children)if(n.children.hasOwnProperty(e)&&ce(Ct(n.path,e),t))return!0;return!1}function eE(n){n.visibleWrites=tp(n.allWrites,nE,J()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function nE(n){return n.visible}function tp(n,t,e){let i=de.empty();for(let s=0;s<n.length;++s){const o=n[s];if(t(o)){const r=o.path;let a;if(o.snap)ce(e,r)?(a=jt(e,r),i=Yi(i,a,o.snap)):ce(r,e)&&(a=jt(r,e),i=Yi(i,J(),o.snap.getChild(a)));else if(o.children){if(ce(e,r))a=jt(e,r),i=Kh(i,a,o.children);else if(ce(r,e))if(a=jt(r,e),$(a))i=Kh(i,J(),o.children);else{const l=ni(o.children,W(a));if(l){const c=l.getChild(ot(a));i=Yi(i,J(),c)}}}else throw ai("WriteRecord should have .snap or .children")}}return i}function ep(n,t,e,i,s){if(!i&&!s){const o=Ln(n.visibleWrites,t);if(o!=null)return o;{const r=Je(n.visibleWrites,t);if(ya(r))return e;if(e==null&&!ba(r,J()))return null;{const a=e||D.EMPTY_NODE;return oi(r,a)}}}else{const o=Je(n.visibleWrites,t);if(!s&&ya(o))return e;if(!s&&e==null&&!ba(o,J()))return null;{const r=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(ce(c.path,t)||ce(t,c.path))},a=tp(n.allWrites,r,t),l=e||D.EMPTY_NODE;return oi(a,l)}}}function iE(n,t,e){let i=D.EMPTY_NODE;const s=Ln(n.visibleWrites,t);if(s)return s.isLeafNode()||s.forEachChild(gt,(o,r)=>{i=i.updateImmediateChild(o,r)}),i;if(e){const o=Je(n.visibleWrites,t);return e.forEachChild(gt,(r,a)=>{const l=oi(Je(o,new nt(r)),a);i=i.updateImmediateChild(r,l)}),Qh(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}else{const o=Je(n.visibleWrites,t);return Qh(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}}function sE(n,t,e,i,s){k(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=Ct(t,e);if(ba(n.visibleWrites,o))return null;{const r=Je(n.visibleWrites,o);return ya(r)?s.getChild(e):oi(r,s.getChild(e))}}function oE(n,t,e,i){const s=Ct(t,e),o=Ln(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(e)){const r=Je(n.visibleWrites,s);return oi(r,i.getNode().getImmediateChild(e))}else return null}function rE(n,t){return Ln(n.visibleWrites,t)}function aE(n,t,e,i,s,o,r){let a;const l=Je(n.visibleWrites,t),c=Ln(l,J());if(c!=null)a=c;else if(e!=null)a=oi(l,e);else return[];if(a=a.withIndex(r),!a.isEmpty()&&!a.isLeafNode()){const h=[],u=r.getCompare(),d=o?a.getReverseIteratorFrom(i,r):a.getIteratorFrom(i,r);let f=d.getNext();for(;f&&h.length<s;)u(f,i)!==0&&h.push(f),f=d.getNext();return h}else return[]}function lE(){return{visibleWrites:de.empty(),allWrites:[],lastWriteId:-1}}function So(n,t,e,i){return ep(n.writeTree,n.treePath,t,e,i)}function fl(n,t){return iE(n.writeTree,n.treePath,t)}function Jh(n,t,e,i){return sE(n.writeTree,n.treePath,t,e,i)}function Eo(n,t){return rE(n.writeTree,Ct(n.treePath,t))}function cE(n,t,e,i,s,o){return aE(n.writeTree,n.treePath,t,e,i,s,o)}function pl(n,t,e){return oE(n.writeTree,n.treePath,t,e)}function np(n,t){return ip(Ct(n.treePath,t),n.writeTree)}function ip(n,t){return{treePath:n,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,i=t.childName;k(e==="child_added"||e==="child_changed"||e==="child_removed","Only child changes supported for tracking"),k(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(e==="child_added"&&o==="child_removed")this.changeMap.set(i,rs(i,t.snapshotNode,s.snapshotNode));else if(e==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(e==="child_removed"&&o==="child_changed")this.changeMap.set(i,os(i,s.oldSnap));else if(e==="child_changed"&&o==="child_added")this.changeMap.set(i,si(i,t.snapshotNode));else if(e==="child_changed"&&o==="child_changed")this.changeMap.set(i,rs(i,t.snapshotNode,s.oldSnap));else throw ai("Illegal combination of changes: "+t+" occurred after "+s)}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{getCompleteChild(t){return null}getChildAfterChild(t,e,i){return null}}const sp=new uE;class gl{constructor(t,e,i=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=i}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const i=this.optCompleteServerCache_!=null?new Mn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return pl(this.writes_,t,i)}}getChildAfterChild(t,e,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:An(this.viewCache_),o=cE(this.writes_,s,e,1,i,t);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dE(n){return{filter:n}}function fE(n,t){k(t.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),k(t.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function pE(n,t,e,i,s){const o=new hE;let r,a;if(e.type===he.OVERWRITE){const c=e;c.source.fromUser?r=va(n,t,c.path,c.snap,i,s,o):(k(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!$(c.path),r=To(n,t,c.path,c.snap,i,s,a,o))}else if(e.type===he.MERGE){const c=e;c.source.fromUser?r=mE(n,t,c.path,c.children,i,s,o):(k(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),r=xa(n,t,c.path,c.children,i,s,a,o))}else if(e.type===he.ACK_USER_WRITE){const c=e;c.revert?r=yE(n,t,c.path,i,s,o):r=_E(n,t,c.path,c.affectedTree,i,s,o)}else if(e.type===he.LISTEN_COMPLETE)r=bE(n,t,e.path,i,o);else throw ai("Unknown operation type: "+e.type);const l=o.getChanges();return gE(t,r,l),{viewCache:r,changes:l}}function gE(n,t,e){const i=t.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=_a(n);(e.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&e.push(Kf(_a(t)))}}function op(n,t,e,i,s,o){const r=t.eventCache;if(Eo(i,e)!=null)return t;{let a,l;if($(e))if(k(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const c=An(t),h=c instanceof D?c:D.EMPTY_NODE,u=fl(i,h);a=n.filter.updateFullNode(t.eventCache.getNode(),u,o)}else{const c=So(i,An(t));a=n.filter.updateFullNode(t.eventCache.getNode(),c,o)}else{const c=W(e);if(c===".priority"){k(nn(e)===1,"Can't have a priority with additional path components");const h=r.getNode();l=t.serverCache.getNode();const u=Jh(i,e,h,l);u!=null?a=n.filter.updatePriority(h,u):a=r.getNode()}else{const h=ot(e);let u;if(r.isCompleteForChild(c)){l=t.serverCache.getNode();const d=Jh(i,e,r.getNode(),l);d!=null?u=r.getNode().getImmediateChild(c).updateChild(h,d):u=r.getNode().getImmediateChild(c)}else u=pl(i,c,t.serverCache);u!=null?a=n.filter.updateChild(r.getNode(),c,u,h,s,o):a=r.getNode()}}return Ui(t,a,r.isFullyInitialized()||$(e),n.filter.filtersNodes())}}function To(n,t,e,i,s,o,r,a){const l=t.serverCache;let c;const h=r?n.filter:n.filter.getIndexedFilter();if($(e))c=h.updateFullNode(l.getNode(),i,null);else if(h.filtersNodes()&&!l.isFiltered()){const f=l.getNode().updateChild(e,i);c=h.updateFullNode(l.getNode(),f,null)}else{const f=W(e);if(!l.isCompleteForPath(e)&&nn(e)>1)return t;const p=ot(e),m=l.getNode().getImmediateChild(f).updateChild(p,i);f===".priority"?c=h.updatePriority(l.getNode(),m):c=h.updateChild(l.getNode(),f,m,p,sp,null)}const u=Jf(t,c,l.isFullyInitialized()||$(e),h.filtersNodes()),d=new gl(s,u,o);return op(n,u,e,s,d,a)}function va(n,t,e,i,s,o,r){const a=t.eventCache;let l,c;const h=new gl(s,t,o);if($(e))c=n.filter.updateFullNode(t.eventCache.getNode(),i,r),l=Ui(t,c,!0,n.filter.filtersNodes());else{const u=W(e);if(u===".priority")c=n.filter.updatePriority(t.eventCache.getNode(),i),l=Ui(t,c,a.isFullyInitialized(),a.isFiltered());else{const d=ot(e),f=a.getNode().getImmediateChild(u);let p;if($(d))p=i;else{const g=h.getCompleteChild(u);g!=null?Wf(d)===".priority"&&g.getChild(Vf(d)).isEmpty()?p=g:p=g.updateChild(d,i):p=D.EMPTY_NODE}if(f.equals(p))l=t;else{const g=n.filter.updateChild(a.getNode(),u,p,d,h,r);l=Ui(t,g,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function Zh(n,t){return n.eventCache.isCompleteForChild(t)}function mE(n,t,e,i,s,o,r){let a=t;return i.foreach((l,c)=>{const h=Ct(e,l);Zh(t,W(h))&&(a=va(n,a,h,c,s,o,r))}),i.foreach((l,c)=>{const h=Ct(e,l);Zh(t,W(h))||(a=va(n,a,h,c,s,o,r))}),a}function tu(n,t,e){return e.foreach((i,s)=>{t=t.updateChild(i,s)}),t}function xa(n,t,e,i,s,o,r,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l=t,c;$(e)?c=i:c=new at(null).setTree(e,i);const h=t.serverCache.getNode();return c.children.inorderTraversal((u,d)=>{if(h.hasChild(u)){const f=t.serverCache.getNode().getImmediateChild(u),p=tu(n,f,d);l=To(n,l,new nt(u),p,s,o,r,a)}}),c.children.inorderTraversal((u,d)=>{const f=!t.serverCache.isCompleteForChild(u)&&d.value===null;if(!h.hasChild(u)&&!f){const p=t.serverCache.getNode().getImmediateChild(u),g=tu(n,p,d);l=To(n,l,new nt(u),g,s,o,r,a)}}),l}function _E(n,t,e,i,s,o,r){if(Eo(s,e)!=null)return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(i.value!=null){if($(e)&&l.isFullyInitialized()||l.isCompleteForPath(e))return To(n,t,e,l.getNode().getChild(e),s,o,a,r);if($(e)){let c=new at(null);return l.getNode().forEachChild(Qn,(h,u)=>{c=c.set(new nt(h),u)}),xa(n,t,e,c,s,o,a,r)}else return t}else{let c=new at(null);return i.foreach((h,u)=>{const d=Ct(e,h);l.isCompleteForPath(d)&&(c=c.set(h,l.getNode().getChild(d)))}),xa(n,t,e,c,s,o,a,r)}}function bE(n,t,e,i,s){const o=t.serverCache,r=Jf(t,o.getNode(),o.isFullyInitialized()||$(e),o.isFiltered());return op(n,r,e,i,sp,s)}function yE(n,t,e,i,s,o){let r;if(Eo(i,e)!=null)return t;{const a=new gl(i,t,s),l=t.eventCache.getNode();let c;if($(e)||W(e)===".priority"){let h;if(t.serverCache.isFullyInitialized())h=So(i,An(t));else{const u=t.serverCache.getNode();k(u instanceof D,"serverChildren would be complete if leaf node"),h=fl(i,u)}h=h,c=n.filter.updateFullNode(l,h,o)}else{const h=W(e);let u=pl(i,h,t.serverCache);u==null&&t.serverCache.isCompleteForChild(h)&&(u=l.getImmediateChild(h)),u!=null?c=n.filter.updateChild(l,h,u,ot(e),a,o):t.eventCache.getNode().hasChild(h)?c=n.filter.updateChild(l,h,D.EMPTY_NODE,ot(e),a,o):c=l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(r=So(i,An(t)),r.isLeafNode()&&(c=n.filter.updateFullNode(c,r,o)))}return r=t.serverCache.isFullyInitialized()||Eo(i,J())!=null,Ui(t,c,r,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new ll(i.getIndex()),o=HS(i);this.processor_=dE(o);const r=e.serverCache,a=e.eventCache,l=s.updateFullNode(D.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(D.EMPTY_NODE,a.getNode(),null),h=new Mn(l,r.isFullyInitialized(),s.filtersNodes()),u=new Mn(c,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=$o(u,h),this.eventGenerator_=new YS(this.query_)}get query(){return this.query_}}function xE(n){return n.viewCache_.serverCache.getNode()}function wE(n,t){const e=An(n.viewCache_);return e&&(n.query._queryParams.loadsAllData()||!$(t)&&!e.getImmediateChild(W(t)).isEmpty())?e.getChild(t):null}function eu(n){return n.eventRegistrations_.length===0}function CE(n,t){n.eventRegistrations_.push(t)}function nu(n,t,e){const i=[];if(e){k(t==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const r=o.createCancelEvent(e,s);r&&i.push(r)})}if(t){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const r=n.eventRegistrations_[o];if(!r.matches(t))s.push(r);else if(t.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function iu(n,t,e,i){t.type===he.MERGE&&t.source.queryId!==null&&(k(An(n.viewCache_),"We should always have a full cache before handling merges"),k(_a(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=pE(n.processor_,s,t,e,i);return fE(n.processor_,o.viewCache),k(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,rp(n,o.changes,o.viewCache.eventCache.getNode(),null)}function SE(n,t){const e=n.viewCache_.eventCache,i=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(gt,(o,r)=>{i.push(si(o,r))}),e.isFullyInitialized()&&i.push(Kf(e.getNode())),rp(n,i,e.getNode(),t)}function rp(n,t,e,i){const s=i?[i]:n.eventRegistrations_;return qS(n.eventGenerator_,t,e,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ko;class EE{constructor(){this.views=new Map}}function TE(n){k(!ko,"__referenceConstructor has already been defined"),ko=n}function kE(){return k(ko,"Reference.ts has not been loaded"),ko}function IE(n){return n.views.size===0}function ml(n,t,e,i){const s=t.source.queryId;if(s!==null){const o=n.views.get(s);return k(o!=null,"SyncTree gave us an op for an invalid query."),iu(o,t,e,i)}else{let o=[];for(const r of n.views.values())o=o.concat(iu(r,t,e,i));return o}}function ME(n,t,e,i,s){const o=t._queryIdentifier,r=n.views.get(o);if(!r){let a=So(e,s?i:null),l=!1;a?l=!0:i instanceof D?(a=fl(e,i),l=!1):(a=D.EMPTY_NODE,l=!1);const c=$o(new Mn(a,l,!1),new Mn(i,s,!1));return new vE(t,c)}return r}function AE(n,t,e,i,s,o){const r=ME(n,t,i,s,o);return n.views.has(t._queryIdentifier)||n.views.set(t._queryIdentifier,r),CE(r,e),SE(r,e)}function PE(n,t,e,i){const s=t._queryIdentifier,o=[];let r=[];const a=sn(n);if(s==="default")for(const[l,c]of n.views.entries())r=r.concat(nu(c,e,i)),eu(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||o.push(c.query));else{const l=n.views.get(s);l&&(r=r.concat(nu(l,e,i)),eu(l)&&(n.views.delete(s),l.query._queryParams.loadsAllData()||o.push(l.query)))}return a&&!sn(n)&&o.push(new(kE())(t._repo,t._path)),{removed:o,events:r}}function ap(n){const t=[];for(const e of n.views.values())e.query._queryParams.loadsAllData()||t.push(e);return t}function Jn(n,t){let e=null;for(const i of n.views.values())e=e||wE(i,t);return e}function lp(n,t){if(t._queryParams.loadsAllData())return jo(n);{const i=t._queryIdentifier;return n.views.get(i)}}function cp(n,t){return lp(n,t)!=null}function sn(n){return jo(n)!=null}function jo(n){for(const t of n.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Io;function DE(n){k(!Io,"__referenceConstructor has already been defined"),Io=n}function RE(){return k(Io,"Reference.ts has not been loaded"),Io}let OE=1;class su{constructor(t){this.listenProvider_=t,this.syncPointTree_=new at(null),this.pendingWriteTree_=lE(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function hp(n,t,e,i,s){return QS(n.pendingWriteTree_,t,e,i,s),s?xs(n,new In(Qf(),t,e)):[]}function bn(n,t,e=!1){const i=JS(n.pendingWriteTree_,t);if(ZS(n.pendingWriteTree_,t)){let o=new at(null);return i.snap!=null?o=o.set(J(),!0):Kt(i.children,r=>{o=o.set(new nt(r),!0)}),xs(n,new Co(i.path,o,e))}else return[]}function Uo(n,t,e){return xs(n,new In(hl(),t,e))}function NE(n,t,e){const i=at.fromObject(e);return xs(n,new cs(hl(),t,i))}function LE(n,t){return xs(n,new ls(hl(),t))}function FE(n,t,e){const i=bl(n,e);if(i){const s=yl(i),o=s.path,r=s.queryId,a=jt(o,t),l=new ls(ul(r),a);return vl(n,o,l)}else return[]}function wa(n,t,e,i,s=!1){const o=t._path,r=n.syncPointTree_.get(o);let a=[];if(r&&(t._queryIdentifier==="default"||cp(r,t))){const l=PE(r,t,e,i);IE(r)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const c=l.removed;if(a=l.events,!s){const h=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,u=n.syncPointTree_.findOnPath(o,(d,f)=>sn(f));if(h&&!u){const d=n.syncPointTree_.subtree(o);if(!d.isEmpty()){const f=WE(d);for(let p=0;p<f.length;++p){const g=f[p],m=g.query,_=fp(n,g);n.listenProvider_.startListening(qi(m),Mo(n,m),_.hashFn,_.onComplete)}}}!u&&c.length>0&&!i&&(h?n.listenProvider_.stopListening(qi(t),null):c.forEach(d=>{const f=n.queryToTagMap.get(Yo(d));n.listenProvider_.stopListening(qi(d),f)}))}zE(n,c)}return a}function BE(n,t,e,i){const s=bl(n,i);if(s!=null){const o=yl(s),r=o.path,a=o.queryId,l=jt(r,t),c=new In(ul(a),l,e);return vl(n,r,c)}else return[]}function HE(n,t,e,i){const s=bl(n,i);if(s){const o=yl(s),r=o.path,a=o.queryId,l=jt(r,t),c=at.fromObject(e),h=new cs(ul(a),l,c);return vl(n,r,h)}else return[]}function ou(n,t,e,i=!1){const s=t._path;let o=null,r=!1;n.syncPointTree_.foreachOnPath(s,(d,f)=>{const p=jt(d,s);o=o||Jn(f,p),r=r||sn(f)});let a=n.syncPointTree_.get(s);a?(r=r||sn(a),o=o||Jn(a,J())):(a=new EE,n.syncPointTree_=n.syncPointTree_.set(s,a));let l;o!=null?l=!0:(l=!1,o=D.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((f,p)=>{const g=Jn(p,J());g&&(o=o.updateImmediateChild(f,g))}));const c=cp(a,t);if(!c&&!t._queryParams.loadsAllData()){const d=Yo(t);k(!n.queryToTagMap.has(d),"View does not exist, but we have a tag");const f=VE();n.queryToTagMap.set(d,f),n.tagToQueryMap.set(f,d)}const h=dl(n.pendingWriteTree_,s);let u=AE(a,t,e,h,o,l);if(!c&&!r&&!i){const d=lp(a,t);u=u.concat($E(n,t,d))}return u}function _l(n,t,e){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(t,(r,a)=>{const l=jt(r,t),c=Jn(a,l);if(c)return c});return ep(s,t,o,e,!0)}function xs(n,t){return up(t,n.syncPointTree_,null,dl(n.pendingWriteTree_,J()))}function up(n,t,e,i){if($(n.path))return dp(n,t,e,i);{const s=t.get(J());e==null&&s!=null&&(e=Jn(s,J()));let o=[];const r=W(n.path),a=n.operationForChild(r),l=t.children.get(r);if(l&&a){const c=e?e.getImmediateChild(r):null,h=np(i,r);o=o.concat(up(a,l,c,h))}return s&&(o=o.concat(ml(s,n,i,e))),o}}function dp(n,t,e,i){const s=t.get(J());e==null&&s!=null&&(e=Jn(s,J()));let o=[];return t.children.inorderTraversal((r,a)=>{const l=e?e.getImmediateChild(r):null,c=np(i,r),h=n.operationForChild(r);h&&(o=o.concat(dp(h,a,l,c)))}),s&&(o=o.concat(ml(s,n,i,e))),o}function fp(n,t){const e=t.query,i=Mo(n,e);return{hashFn:()=>(xE(t)||D.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?FE(n,e._path,i):LE(n,e._path);{const o=BC(s,e);return wa(n,e,null,o)}}}}function Mo(n,t){const e=Yo(t);return n.queryToTagMap.get(e)}function Yo(n){return n._path.toString()+"$"+n._queryIdentifier}function bl(n,t){return n.tagToQueryMap.get(t)}function yl(n){const t=n.indexOf("$");return k(t!==-1&&t<n.length-1,"Bad queryKey."),{queryId:n.substr(t+1),path:new nt(n.substr(0,t))}}function vl(n,t,e){const i=n.syncPointTree_.get(t);k(i,"Missing sync point for query tag that we're tracking");const s=dl(n.pendingWriteTree_,t);return ml(i,e,s,null)}function WE(n){return n.fold((t,e,i)=>{if(e&&sn(e))return[jo(e)];{let s=[];return e&&(s=ap(e)),Kt(i,(o,r)=>{s=s.concat(r)}),s}})}function qi(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(RE())(n._repo,n._path):n}function zE(n,t){for(let e=0;e<t.length;++e){const i=t[e];if(!i._queryParams.loadsAllData()){const s=Yo(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function VE(){return OE++}function $E(n,t,e){const i=t._path,s=Mo(n,t),o=fp(n,e),r=n.listenProvider_.startListening(qi(t),s,o.hashFn,o.onComplete),a=n.syncPointTree_.subtree(i);if(s)k(!sn(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,h,u)=>{if(!$(c)&&h&&sn(h))return[jo(h).query];{let d=[];return h&&(d=d.concat(ap(h).map(f=>f.query))),Kt(u,(f,p)=>{d=d.concat(p)}),d}});for(let c=0;c<l.length;++c){const h=l[c];n.listenProvider_.stopListening(qi(h),Mo(n,h))}}return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new xl(e)}node(){return this.node_}}class wl{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=Ct(this.path_,t);return new wl(this.syncTree_,e)}node(){return _l(this.syncTree_,this.path_)}}const jE=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},ru=function(n,t,e){if(!n||typeof n!="object")return n;if(k(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return UE(n[".sv"],t,e);if(typeof n[".sv"]=="object")return YE(n[".sv"],t);k(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},UE=function(n,t,e){switch(n){case"timestamp":return e.timestamp;default:k(!1,"Unexpected server value: "+n)}},YE=function(n,t,e){n.hasOwnProperty("increment")||k(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&k(!1,"Unexpected increment value: "+i);const s=t.node();if(k(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const r=s.getValue();return typeof r!="number"?i:r+i},qE=function(n,t,e,i){return Cl(t,new wl(e,n),i)},pp=function(n,t,e){return Cl(n,new xl(t),e)};function Cl(n,t,e){const i=n.getPriority().val(),s=ru(i,t.getImmediateChild(".priority"),e);let o;if(n.isLeafNode()){const r=n,a=ru(r.getValue(),t,e);return a!==r.getValue()||s!==r.getPriority().val()?new Tt(a,Rt(s)):n}else{const r=n;return o=r,s!==r.getPriority().val()&&(o=o.updatePriority(new Tt(s))),r.forEachChild(gt,(a,l)=>{const c=Cl(l,t.getImmediateChild(a),e);c!==l&&(o=o.updateImmediateChild(a,c))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(t="",e=null,i={children:{},childCount:0}){this.name=t,this.parent=e,this.node=i}}function El(n,t){let e=t instanceof nt?t:new nt(t),i=n,s=W(e);for(;s!==null;){const o=ni(i.node.children,s)||{children:{},childCount:0};i=new Sl(s,i,o),e=ot(e),s=W(e)}return i}function ui(n){return n.node.value}function gp(n,t){n.node.value=t,Ca(n)}function mp(n){return n.node.childCount>0}function GE(n){return ui(n)===void 0&&!mp(n)}function qo(n,t){Kt(n.node.children,(e,i)=>{t(new Sl(e,n,i))})}function _p(n,t,e,i){e&&!i&&t(n),qo(n,s=>{_p(s,t,!0,i)}),e&&i&&t(n)}function KE(n,t,e){let i=e?n:n.parent;for(;i!==null;){if(t(i))return!0;i=i.parent}return!1}function ws(n){return new nt(n.parent===null?n.name:ws(n.parent)+"/"+n.name)}function Ca(n){n.parent!==null&&XE(n.parent,n.name,n)}function XE(n,t,e){const i=GE(e),s=He(n.node.children,t);i&&s?(delete n.node.children[t],n.node.childCount--,Ca(n)):!i&&!s&&(n.node.children[t]=e.node,n.node.childCount++,Ca(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE=/[\[\].#$\/\u0000-\u001F\u007F]/,JE=/[\[\].#$\u0000-\u001F\u007F]/,Ir=10*1024*1024,bp=function(n){return typeof n=="string"&&n.length!==0&&!QE.test(n)},yp=function(n){return typeof n=="string"&&n.length!==0&&!JE.test(n)},ZE=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),yp(n)},tT=function(n,t,e,i){i&&t===void 0||Tl(Qa(n,"value"),t,e)},Tl=function(n,t,e){const i=e instanceof nt?new _S(e,n):e;if(t===void 0)throw new Error(n+"contains undefined "+pn(i));if(typeof t=="function")throw new Error(n+"contains a function "+pn(i)+" with contents = "+t.toString());if(yf(t))throw new Error(n+"contains "+t.toString()+" "+pn(i));if(typeof t=="string"&&t.length>Ir/3&&zo(t)>Ir)throw new Error(n+"contains a string greater than "+Ir+" utf8 bytes "+pn(i)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let s=!1,o=!1;if(Kt(t,(r,a)=>{if(r===".value")s=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!bp(r)))throw new Error(n+" contains an invalid key ("+r+") "+pn(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);bS(i,r),Tl(n,a,i),yS(i)}),s&&o)throw new Error(n+' contains ".value" child '+pn(i)+" in addition to actual children.")}},vp=function(n,t,e,i){if(!(i&&e===void 0)&&!yp(e))throw new Error(Qa(n,t)+'was an invalid path = "'+e+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},eT=function(n,t,e,i){e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),vp(n,t,e,i)},nT=function(n,t){if(W(t)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},iT=function(n,t){const e=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!bp(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||e.length!==0&&!ZE(e))throw new Error(Qa(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function kl(n,t){let e=null;for(let i=0;i<t.length;i++){const s=t[i],o=s.getPath();e!==null&&!ol(o,e.path)&&(n.eventLists_.push(e),e=null),e===null&&(e={events:[],path:o}),e.events.push(s)}e&&n.eventLists_.push(e)}function xp(n,t,e){kl(n,e),wp(n,i=>ol(i,t))}function Be(n,t,e){kl(n,e),wp(n,i=>ce(i,t)||ce(t,i))}function wp(n,t){n.recursionDepth_++;let e=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;t(o)?(oT(n.eventLists_[i]),n.eventLists_[i]=null):e=!1}}e&&(n.eventLists_=[]),n.recursionDepth_--}function oT(n){for(let t=0;t<n.events.length;t++){const e=n.events[t];if(e!==null){n.events[t]=null;const i=e.getEventRunner();Cn&&Bt("event: "+e.toString()),hi(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT="repo_interrupt",aT=25;class lT{constructor(t,e,i,s){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new sT,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=wo(),this.transactionQueueTree_=new Sl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function cT(n,t,e){if(n.stats_=il(n.repoInfo_),n.forceRestClient_||VC())n.server_=new xo(n.repoInfo_,(i,s,o,r)=>{au(n,i,s,o,r)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>lu(n,!0),0);else{if(typeof e<"u"&&e!==null){if(typeof e!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Mt(e)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Ne(n.repoInfo_,t,(i,s,o,r)=>{au(n,i,s,o,r)},i=>{lu(n,i)},i=>{uT(n,i)},n.authTokenProvider_,n.appCheckProvider_,e),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=qC(n.repoInfo_,()=>new US(n.stats_,n.server_)),n.infoData_=new WS,n.infoSyncTree_=new su({startListening:(i,s,o,r)=>{let a=[];const l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=Uo(n.infoSyncTree_,i._path,l),setTimeout(()=>{r("ok")},0)),a},stopListening:()=>{}}),Ml(n,"connected",!1),n.serverSyncTree_=new su({startListening:(i,s,o,r)=>(n.server_.listen(i,o,s,(a,l)=>{const c=r(a,l);Be(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function hT(n){const e=n.infoData_.getNode(new nt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e}function Il(n){return jE({timestamp:hT(n)})}function au(n,t,e,i,s){n.dataUpdateCount++;const o=new nt(t);e=n.interceptServerDataCallback_?n.interceptServerDataCallback_(t,e):e;let r=[];if(s)if(i){const l=mo(e,c=>Rt(c));r=HE(n.serverSyncTree_,o,l,s)}else{const l=Rt(e);r=BE(n.serverSyncTree_,o,l,s)}else if(i){const l=mo(e,c=>Rt(c));r=NE(n.serverSyncTree_,o,l)}else{const l=Rt(e);r=Uo(n.serverSyncTree_,o,l)}let a=o;r.length>0&&(a=Go(n,o)),Be(n.eventQueue_,a,r)}function lu(n,t){Ml(n,"connected",t),t===!1&&fT(n)}function uT(n,t){Kt(t,(e,i)=>{Ml(n,e,i)})}function Ml(n,t,e){const i=new nt("/.info/"+t),s=Rt(e);n.infoData_.updateSnapshot(i,s);const o=Uo(n.infoSyncTree_,i,s);Be(n.eventQueue_,i,o)}function Cp(n){return n.nextWriteId_++}function dT(n,t,e,i,s){Al(n,"set",{path:t.toString(),value:e,priority:i});const o=Il(n),r=Rt(e,i),a=_l(n.serverSyncTree_,t),l=pp(r,a,o),c=Cp(n),h=hp(n.serverSyncTree_,t,l,c,!0);kl(n.eventQueue_,h),n.server_.put(t.toString(),r.val(!0),(d,f)=>{const p=d==="ok";p||Yt("set at "+t+" failed: "+d);const g=bn(n.serverSyncTree_,c,!p);Be(n.eventQueue_,t,g),mT(n,s,d,f)});const u=Ip(n,t);Go(n,u),Be(n.eventQueue_,u,[])}function fT(n){Al(n,"onDisconnectEvents");const t=Il(n),e=wo();ma(n.onDisconnect_,J(),(s,o)=>{const r=qE(s,o,n.serverSyncTree_,t);Xf(e,s,r)});let i=[];ma(e,J(),(s,o)=>{i=i.concat(Uo(n.serverSyncTree_,s,o));const r=Ip(n,s);Go(n,r)}),n.onDisconnect_=wo(),Be(n.eventQueue_,J(),i)}function pT(n,t,e){let i;W(t._path)===".info"?i=ou(n.infoSyncTree_,t,e):i=ou(n.serverSyncTree_,t,e),xp(n.eventQueue_,t._path,i)}function cu(n,t,e){let i;W(t._path)===".info"?i=wa(n.infoSyncTree_,t,e):i=wa(n.serverSyncTree_,t,e),xp(n.eventQueue_,t._path,i)}function gT(n){n.persistentConnection_&&n.persistentConnection_.interrupt(rT)}function Al(n,...t){let e="";n.persistentConnection_&&(e=n.persistentConnection_.id+":"),Bt(e,...t)}function mT(n,t,e,i){t&&hi(()=>{if(e==="ok")t(null);else{const s=(e||"error").toUpperCase();let o=s;i&&(o+=": "+i);const r=new Error(o);r.code=s,t(r)}})}function Sp(n,t,e){return _l(n.serverSyncTree_,t,e)||D.EMPTY_NODE}function Pl(n,t=n.transactionQueueTree_){if(t||Ko(n,t),ui(t)){const e=Tp(n,t);k(e.length>0,"Sending zero length transaction queue"),e.every(s=>s.status===0)&&_T(n,ws(t),e)}else mp(t)&&qo(t,e=>{Pl(n,e)})}function _T(n,t,e){const i=e.map(c=>c.currentWriteId),s=Sp(n,t,i);let o=s;const r=s.hash();for(let c=0;c<e.length;c++){const h=e[c];k(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const u=jt(t,h.path);o=o.updateChild(u,h.currentOutputSnapshotRaw)}const a=o.val(!0),l=t;n.server_.put(l.toString(),a,c=>{Al(n,"transaction put response",{path:l.toString(),status:c});let h=[];if(c==="ok"){const u=[];for(let d=0;d<e.length;d++)e[d].status=2,h=h.concat(bn(n.serverSyncTree_,e[d].currentWriteId)),e[d].onComplete&&u.push(()=>e[d].onComplete(null,!0,e[d].currentOutputSnapshotResolved)),e[d].unwatcher();Ko(n,El(n.transactionQueueTree_,t)),Pl(n,n.transactionQueueTree_),Be(n.eventQueue_,t,h);for(let d=0;d<u.length;d++)hi(u[d])}else{if(c==="datastale")for(let u=0;u<e.length;u++)e[u].status===3?e[u].status=4:e[u].status=0;else{Yt("transaction at "+l.toString()+" failed: "+c);for(let u=0;u<e.length;u++)e[u].status=4,e[u].abortReason=c}Go(n,t)}},r)}function Go(n,t){const e=Ep(n,t),i=ws(e),s=Tp(n,e);return bT(n,s,i),i}function bT(n,t,e){if(t.length===0)return;const i=[];let s=[];const r=t.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<t.length;a++){const l=t[a],c=jt(e,l.path);let h=!1,u;if(k(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,u=l.abortReason,s=s.concat(bn(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=aT)h=!0,u="maxretry",s=s.concat(bn(n.serverSyncTree_,l.currentWriteId,!0));else{const d=Sp(n,l.path,r);l.currentInputSnapshot=d;const f=t[a].update(d.val());if(f!==void 0){Tl("transaction failed: Data returned ",f,l.path);let p=Rt(f);typeof f=="object"&&f!=null&&He(f,".priority")||(p=p.updatePriority(d.getPriority()));const m=l.currentWriteId,_=Il(n),b=pp(p,d,_);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=b,l.currentWriteId=Cp(n),r.splice(r.indexOf(m),1),s=s.concat(hp(n.serverSyncTree_,l.path,b,l.currentWriteId,l.applyLocally)),s=s.concat(bn(n.serverSyncTree_,m,!0))}else h=!0,u="nodata",s=s.concat(bn(n.serverSyncTree_,l.currentWriteId,!0))}Be(n.eventQueue_,e,s),s=[],h&&(t[a].status=2,function(d){setTimeout(d,Math.floor(0))}(t[a].unwatcher),t[a].onComplete&&(u==="nodata"?i.push(()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot)):i.push(()=>t[a].onComplete(new Error(u),!1,null))))}Ko(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)hi(i[a]);Pl(n,n.transactionQueueTree_)}function Ep(n,t){let e,i=n.transactionQueueTree_;for(e=W(t);e!==null&&ui(i)===void 0;)i=El(i,e),t=ot(t),e=W(t);return i}function Tp(n,t){const e=[];return kp(n,t,e),e.sort((i,s)=>i.order-s.order),e}function kp(n,t,e){const i=ui(t);if(i)for(let s=0;s<i.length;s++)e.push(i[s]);qo(t,s=>{kp(n,s,e)})}function Ko(n,t){const e=ui(t);if(e){let i=0;for(let s=0;s<e.length;s++)e[s].status!==2&&(e[i]=e[s],i++);e.length=i,gp(t,e.length>0?e:void 0)}qo(t,i=>{Ko(n,i)})}function Ip(n,t){const e=ws(Ep(n,t)),i=El(n.transactionQueueTree_,t);return KE(i,s=>{Mr(n,s)}),Mr(n,i),_p(i,s=>{Mr(n,s)}),e}function Mr(n,t){const e=ui(t);if(e){const i=[];let s=[],o=-1;for(let r=0;r<e.length;r++)e[r].status===3||(e[r].status===1?(k(o===r-1,"All SENT items should be at beginning of queue."),o=r,e[r].status=3,e[r].abortReason="set"):(k(e[r].status===0,"Unexpected transaction status in abort"),e[r].unwatcher(),s=s.concat(bn(n.serverSyncTree_,e[r].currentWriteId,!0)),e[r].onComplete&&i.push(e[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?gp(t,void 0):e.length=o+1,Be(n.eventQueue_,ws(t),s);for(let r=0;r<i.length;r++)hi(i[r])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yT(n){let t="";const e=n.split("/");for(let i=0;i<e.length;i++)if(e[i].length>0){let s=e[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}t+="/"+s}return t}function vT(n){const t={};n.charAt(0)==="?"&&(n=n.substring(1));for(const e of n.split("&")){if(e.length===0)continue;const i=e.split("=");i.length===2?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Yt(`Invalid query segment '${e}' in query '${n}'`)}return t}const hu=function(n,t){const e=xT(n),i=e.namespace;e.domain==="firebase.com"&&Fe(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&e.domain!=="localhost"&&Fe("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||RC();const s=e.scheme==="ws"||e.scheme==="wss";return{repoInfo:new Pf(e.host,e.secure,i,s,t,"",i!==e.subdomain),path:new nt(e.pathString)}},xT=function(n){let t="",e="",i="",s="",o="",r=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let h=n.indexOf("/");h===-1&&(h=n.length);let u=n.indexOf("?");u===-1&&(u=n.length),t=n.substring(0,Math.min(h,u)),h<u&&(s=yT(n.substring(h,u)));const d=vT(n.substring(Math.min(n.length,u)));c=t.indexOf(":"),c>=0?(r=a==="https"||a==="wss",l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if(f.toLowerCase()==="localhost")e="localhost";else if(f.split(".").length<=2)e=f;else{const p=t.indexOf(".");i=t.substring(0,p).toLowerCase(),e=t.substring(p+1),o=i}"ns"in d&&(o=d.ns)}return{host:t,port:l,domain:e,subdomain:i,secure:r,scheme:a,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(t,e,i,s){this.eventType=t,this.eventRegistration=e,this.snapshot=i,this.prevName=s}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Mt(this.snapshot.exportVal())}}class Ap{constructor(t,e,i){this.eventRegistration=t,this.error=e,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return k(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(t,e,i,s){this._repo=t,this._path=e,this._queryParams=i,this._orderByCalled=s}get key(){return $(this._path)?null:Wf(this._path)}get ref(){return new We(this._repo,this._path)}get _queryIdentifier(){const t=qh(this._queryParams),e=el(t);return e==="{}"?"default":e}get _queryObject(){return qh(this._queryParams)}isEqual(t){if(t=li(t),!(t instanceof Dl))return!1;const e=this._repo===t._repo,i=ol(this._path,t._path),s=this._queryIdentifier===t._queryIdentifier;return e&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+mS(this._path)}}class We extends Dl{constructor(t,e){super(t,e,new cl,!1)}get parent(){const t=Vf(this._path);return t===null?null:new We(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class hs{constructor(t,e,i){this._node=t,this.ref=e,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new nt(t),i=Ao(this.ref,t);return new hs(this._node.getChild(e),i,gt)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>t(new hs(s,Ao(this.ref,i),gt)))}hasChild(t){const e=new nt(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Et(n,t){return n=li(n),n._checkNotDeleted("ref"),t!==void 0?Ao(n._root,t):n._root}function Ao(n,t){return n=li(n),W(n._path)===null?eT("child","path",t,!1):vp("child","path",t,!1),new We(n._repo,Ct(n._path,t))}function CT(n,t){n=li(n),nT("set",n._path),tT("set",t,n._path,!1);const e=new Ho;return dT(n._repo,n._path,t,null,e.wrapCallback(()=>{})),e.promise}class Rl{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,e){const i=e._queryParams.getIndex();return new Mp("value",this,new hs(t.snapshotNode,new We(e._repo,e._path),i))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new Ap(this,t,e):null}matches(t){return t instanceof Rl?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Ol{constructor(t,e){this.eventType=t,this.callbackContext=e}respondsTo(t){let e=t==="children_added"?"child_added":t;return e=e==="children_removed"?"child_removed":e,this.eventType===e}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new Ap(this,t,e):null}createEvent(t,e){k(t.childName!=null,"Child events should have a childName.");const i=Ao(new We(e._repo,e._path),t.childName),s=e._queryParams.getIndex();return new Mp(t.type,this,new hs(t.snapshotNode,i,s),t.prevName)}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof Ol?this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function ST(n,t,e,i,s){let o;if(typeof i=="object"&&(o=void 0,s=i),typeof i=="function"&&(o=i),s&&s.onlyOnce){const l=e,c=(h,u)=>{cu(n._repo,n,a),l(h,u)};c.userCallback=e.userCallback,c.context=e.context,e=c}const r=new wT(e,o||void 0),a=t==="value"?new Rl(r):new Ol(t,r);return pT(n._repo,n,a),()=>cu(n._repo,n,a)}function uu(n,t,e,i){return ST(n,"value",t,e,i)}TE(We);DE(We);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="FIREBASE_DATABASE_EMULATOR_HOST",Sa={};let TT=!1;function kT(n,t,e,i){n.repoInfo_=new Pf(`${t}:${e}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function IT(n,t,e,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||Fe("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Bt("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let r=hu(o,s),a=r.repoInfo,l,c;typeof process<"u"&&Mh&&(c=Mh[ET]),c?(l=!0,o=`http://${c}?ns=${a.namespace}`,r=hu(o,s),a=r.repoInfo):l=!r.repoInfo.secure;const h=s&&l?new Xn(Xn.OWNER):new jC(n.name,n.options,t);iT("Invalid Firebase Database URL",r),$(r.path)||Fe("Database URL must point to the root of a Firebase Database (not including a child path).");const u=AT(a,n,h,new $C(n.name,e));return new PT(u,n)}function MT(n,t){const e=Sa[t];(!e||e[n.key]!==n)&&Fe(`Database ${t}(${n.repoInfo_}) has already been deleted.`),gT(n),delete e[n.key]}function AT(n,t,e,i){let s=Sa[t.name];s||(s={},Sa[t.name]=s);let o=s[n.toURLString()];return o&&Fe("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new lT(n,TT,e,i),s[n.toURLString()]=o,o}class PT{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(cT(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new We(this._repo,J())),this._rootInternal}_delete(){return this._rootInternal!==null&&(MT(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Fe("Cannot call "+t+" on a deleted database.")}}function DT(n=mC(),t){const e=tl(n,"database").getImmediate({identifier:t});if(!e._instanceStarted){const i=nw("database");i&&RT(e,...i)}return e}function RT(n,t,e,i={}){n=li(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Fe("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Fe('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Xn(Xn.OWNER);else if(i.mockUserToken){const r=typeof i.mockUserToken=="string"?i.mockUserToken:iw(i.mockUserToken,n.app.options.projectId);o=new Xn(r)}kT(s,t,e,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(n){IC(gC),en(new Le("database",(t,{instanceIdentifier:e})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return IT(i,s,o,e)},"PUBLIC").setMultipleInstances(!0)),ye(Ah,Ph,n),ye(Ah,Ph,"esm2017")}Ne.prototype.simpleListen=function(n,t){this.sendRequest("q",{p:n},t)};Ne.prototype.echo=function(n,t){this.sendRequest("echo",{d:n},t)};OT();const Pp="@firebase/installations",Nl="0.6.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp=1e4,Rp=`w:${Nl}`,Op="FIS_v2",NT="https://firebaseinstallations.googleapis.com/v1",LT=60*60*1e3,FT="installations",BT="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Pn=new Wo(FT,BT,HT);function Np(n){return n instanceof Nn&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp({projectId:n}){return`${NT}/projects/${n}/installations`}function Fp(n){return{token:n.token,requestStatus:2,expiresIn:zT(n.expiresIn),creationTime:Date.now()}}async function Bp(n,t){const i=(await t.json()).error;return Pn.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Hp({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function WT(n,{refreshToken:t}){const e=Hp(n);return e.append("Authorization",VT(t)),e}async function Wp(n){const t=await n();return t.status>=500&&t.status<600?n():t}function zT(n){return Number(n.replace("s","000"))}function VT(n){return`${Op} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $T({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const i=Lp(n),s=Hp(n),o=t.getImmediate({optional:!0});if(o){const c=await o.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const r={fid:e,authVersion:Op,appId:n.appId,sdkVersion:Rp},a={method:"POST",headers:s,body:JSON.stringify(r)},l=await Wp(()=>fetch(i,a));if(l.ok){const c=await l.json();return{fid:c.fid||e,registrationStatus:2,refreshToken:c.refreshToken,authToken:Fp(c.authToken)}}else throw await Bp("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zp(n){return new Promise(t=>{setTimeout(t,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UT=/^[cdef][\w-]{21}$/,Ea="";function YT(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=qT(n);return UT.test(e)?e:Ea}catch{return Ea}}function qT(n){return jT(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xo(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp=new Map;function $p(n,t){const e=Xo(n);jp(e,t),GT(e,t)}function jp(n,t){const e=Vp.get(n);if(e)for(const i of e)i(t)}function GT(n,t){const e=KT();e&&e.postMessage({key:n,fid:t}),XT()}let yn=null;function KT(){return!yn&&"BroadcastChannel"in self&&(yn=new BroadcastChannel("[Firebase] FID Change"),yn.onmessage=n=>{jp(n.data.key,n.data.fid)}),yn}function XT(){Vp.size===0&&yn&&(yn.close(),yn=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT="firebase-installations-database",JT=1,Dn="firebase-installations-store";let Ar=null;function Ll(){return Ar||(Ar=df(QT,JT,{upgrade:(n,t)=>{switch(t){case 0:n.createObjectStore(Dn)}}})),Ar}async function Po(n,t){const e=Xo(n),s=(await Ll()).transaction(Dn,"readwrite"),o=s.objectStore(Dn),r=await o.get(e);return await o.put(t,e),await s.done,(!r||r.fid!==t.fid)&&$p(n,t.fid),t}async function Up(n){const t=Xo(n),i=(await Ll()).transaction(Dn,"readwrite");await i.objectStore(Dn).delete(t),await i.done}async function Qo(n,t){const e=Xo(n),s=(await Ll()).transaction(Dn,"readwrite"),o=s.objectStore(Dn),r=await o.get(e),a=t(r);return a===void 0?await o.delete(e):await o.put(a,e),await s.done,a&&(!r||r.fid!==a.fid)&&$p(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fl(n){let t;const e=await Qo(n.appConfig,i=>{const s=ZT(i),o=tk(n,s);return t=o.registrationPromise,o.installationEntry});return e.fid===Ea?{installationEntry:await t}:{installationEntry:e,registrationPromise:t}}function ZT(n){const t=n||{fid:YT(),registrationStatus:0};return Yp(t)}function tk(n,t){if(t.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Pn.create("app-offline"));return{installationEntry:t,registrationPromise:s}}const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=ek(n,e);return{installationEntry:e,registrationPromise:i}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:nk(n)}:{installationEntry:t}}async function ek(n,t){try{const e=await $T(n,t);return Po(n.appConfig,e)}catch(e){throw Np(e)&&e.customData.serverCode===409?await Up(n.appConfig):await Po(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}async function nk(n){let t=await du(n.appConfig);for(;t.registrationStatus===1;)await zp(100),t=await du(n.appConfig);if(t.registrationStatus===0){const{installationEntry:e,registrationPromise:i}=await Fl(n);return i||e}return t}function du(n){return Qo(n,t=>{if(!t)throw Pn.create("installation-not-found");return Yp(t)})}function Yp(n){return ik(n)?{fid:n.fid,registrationStatus:0}:n}function ik(n){return n.registrationStatus===1&&n.registrationTime+Dp<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sk({appConfig:n,heartbeatServiceProvider:t},e){const i=ok(n,e),s=WT(n,e),o=t.getImmediate({optional:!0});if(o){const c=await o.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const r={installation:{sdkVersion:Rp,appId:n.appId}},a={method:"POST",headers:s,body:JSON.stringify(r)},l=await Wp(()=>fetch(i,a));if(l.ok){const c=await l.json();return Fp(c)}else throw await Bp("Generate Auth Token",l)}function ok(n,{fid:t}){return`${Lp(n)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bl(n,t=!1){let e;const i=await Qo(n.appConfig,o=>{if(!qp(o))throw Pn.create("not-registered");const r=o.authToken;if(!t&&lk(r))return o;if(r.requestStatus===1)return e=rk(n,t),o;{if(!navigator.onLine)throw Pn.create("app-offline");const a=hk(o);return e=ak(n,a),a}});return e?await e:i.authToken}async function rk(n,t){let e=await fu(n.appConfig);for(;e.authToken.requestStatus===1;)await zp(100),e=await fu(n.appConfig);const i=e.authToken;return i.requestStatus===0?Bl(n,t):i}function fu(n){return Qo(n,t=>{if(!qp(t))throw Pn.create("not-registered");const e=t.authToken;return uk(e)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}async function ak(n,t){try{const e=await sk(n,t),i=Object.assign(Object.assign({},t),{authToken:e});return await Po(n.appConfig,i),e}catch(e){if(Np(e)&&(e.customData.serverCode===401||e.customData.serverCode===404))await Up(n.appConfig);else{const i=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Po(n.appConfig,i)}throw e}}function qp(n){return n!==void 0&&n.registrationStatus===2}function lk(n){return n.requestStatus===2&&!ck(n)}function ck(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+LT}function hk(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function uk(n){return n.requestStatus===1&&n.requestTime+Dp<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dk(n){const t=n,{installationEntry:e,registrationPromise:i}=await Fl(t);return i?i.catch(console.error):Bl(t).catch(console.error),e.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fk(n,t=!1){const e=n;return await pk(e),(await Bl(e,t)).token}async function pk(n){const{registrationPromise:t}=await Fl(n);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(n){if(!n||!n.options)throw Pr("App Configuration");if(!n.name)throw Pr("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw Pr(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Pr(n){return Pn.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="installations",mk="installations-internal",_k=n=>{const t=n.getProvider("app").getImmediate(),e=gk(t),i=tl(t,"heartbeat");return{app:t,appConfig:e,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},bk=n=>{const t=n.getProvider("app").getImmediate(),e=tl(t,Gp).getImmediate();return{getId:()=>dk(e),getToken:s=>fk(e,s)}};function yk(){en(new Le(Gp,_k,"PUBLIC")),en(new Le(mk,bk,"PRIVATE"))}yk();ye(Pp,Nl);ye(Pp,Nl,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu="analytics",vk="firebase_id",xk="origin",wk=60*1e3,Ck="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Hl="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qt=new Ja("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ee=new Wo("analytics","Analytics",Sk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(n){if(!n.startsWith(Hl)){const t=ee.create("invalid-gtag-resource",{gtagURL:n});return qt.warn(t.message),""}return n}function Kp(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function Tk(n,t){let e;return window.trustedTypes&&(e=window.trustedTypes.createPolicy(n,t)),e}function kk(n,t){const e=Tk("firebase-js-sdk-policy",{createScriptURL:Ek}),i=document.createElement("script"),s=`${Hl}?l=${n}&id=${t}`;i.src=e?e==null?void 0:e.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function Ik(n){let t=[];return Array.isArray(window[n])?t=window[n]:window[n]=t,t}async function Mk(n,t,e,i,s,o){const r=i[s];try{if(r)await t[r];else{const l=(await Kp(e)).find(c=>c.measurementId===s);l&&await t[l.appId]}}catch(a){qt.error(a)}n("config",s,o)}async function Ak(n,t,e,i,s){try{let o=[];if(s&&s.send_to){let r=s.send_to;Array.isArray(r)||(r=[r]);const a=await Kp(e);for(const l of r){const c=a.find(u=>u.measurementId===l),h=c&&t[c.appId];if(h)o.push(h);else{o=[];break}}}o.length===0&&(o=Object.values(t)),await Promise.all(o),n("event",i,s||{})}catch(o){qt.error(o)}}function Pk(n,t,e,i){async function s(o,...r){try{if(o==="event"){const[a,l]=r;await Ak(n,t,e,a,l)}else if(o==="config"){const[a,l]=r;await Mk(n,t,e,i,a,l)}else if(o==="consent"){const[a]=r;n("consent","update",a)}else if(o==="get"){const[a,l,c]=r;n("get",a,l,c)}else if(o==="set"){const[a]=r;n("set",a)}else n(o,...r)}catch(a){qt.error(a)}}return s}function Dk(n,t,e,i,s){let o=function(...r){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=Pk(o,n,t,e),{gtagCore:o,wrappedGtag:window[s]}}function Rk(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(Hl)&&e.src.includes(n))return e;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok=30,Nk=1e3;class Lk{constructor(t={},e=Nk){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const Xp=new Lk;function Fk(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function Bk(n){var t;const{appId:e,apiKey:i}=n,s={method:"GET",headers:Fk(i)},o=Ck.replace("{app-id}",e),r=await fetch(o,s);if(r.status!==200&&r.status!==304){let a="";try{const l=await r.json();!((t=l.error)===null||t===void 0)&&t.message&&(a=l.error.message)}catch{}throw ee.create("config-fetch-failed",{httpStatus:r.status,responseMessage:a})}return r.json()}async function Hk(n,t=Xp,e){const{appId:i,apiKey:s,measurementId:o}=n.options;if(!i)throw ee.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw ee.create("no-api-key")}const r=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Vk;return setTimeout(async()=>{a.abort()},e!==void 0?e:wk),Qp({appId:i,apiKey:s,measurementId:o},r,a,t)}async function Qp(n,{throttleEndTimeMillis:t,backoffCount:e},i,s=Xp){var o;const{appId:r,measurementId:a}=n;try{await Wk(i,t)}catch(l){if(a)return qt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:r,measurementId:a};throw l}try{const l=await Bk(n);return s.deleteThrottleMetadata(r),l}catch(l){const c=l;if(!zk(c)){if(s.deleteThrottleMetadata(r),a)return qt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:r,measurementId:a};throw l}const h=Number((o=c==null?void 0:c.customData)===null||o===void 0?void 0:o.httpStatus)===503?vh(e,s.intervalMillis,Ok):vh(e,s.intervalMillis),u={throttleEndTimeMillis:Date.now()+h,backoffCount:e+1};return s.setThrottleMetadata(r,u),qt.debug(`Calling attemptFetch again in ${h} millis`),Qp(n,u,i,s)}}function Wk(n,t){return new Promise((e,i)=>{const s=Math.max(t-Date.now(),0),o=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(o),i(ee.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function zk(n){if(!(n instanceof Nn)||!n.customData)return!1;const t=Number(n.customData.httpStatus);return t===429||t===500||t===503||t===504}class Vk{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function $k(n,t,e,i,s){if(s&&s.global){n("event",e,i);return}else{const o=await t,r=Object.assign(Object.assign({},i),{send_to:o});n("event",e,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jk(){if(af())try{await lf()}catch(n){return qt.warn(ee.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return qt.warn(ee.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function Uk(n,t,e,i,s,o,r){var a;const l=Hk(n);l.then(f=>{e[f.measurementId]=f.appId,n.options.measurementId&&f.measurementId!==n.options.measurementId&&qt.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>qt.error(f)),t.push(l);const c=jk().then(f=>{if(f)return i.getId()}),[h,u]=await Promise.all([l,c]);Rk(o)||kk(o,h.measurementId),s("js",new Date);const d=(a=r==null?void 0:r.config)!==null&&a!==void 0?a:{};return d[xk]="firebase",d.update=!0,u!=null&&(d[vk]=u),s("config",h.measurementId,d),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(t){this.app=t}_delete(){return delete Gi[this.app.options.appId],Promise.resolve()}}let Gi={},gu=[];const mu={};let Dr="dataLayer",qk="gtag",_u,Jp,bu=!1;function Gk(){const n=[];if(ow()&&n.push("This is a browser extension environment."),aw()||n.push("Cookies are not available."),n.length>0){const t=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),e=ee.create("invalid-analytics-context",{errorInfo:t});qt.warn(e.message)}}function Kk(n,t,e){Gk();const i=n.options.appId;if(!i)throw ee.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)qt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ee.create("no-api-key");if(Gi[i]!=null)throw ee.create("already-exists",{id:i});if(!bu){Ik(Dr);const{wrappedGtag:o,gtagCore:r}=Dk(Gi,gu,mu,Dr,qk);Jp=o,_u=r,bu=!0}return Gi[i]=Uk(n,gu,mu,t,_u,Dr,e),new Yk(n)}function Xk(n,t,e,i){n=li(n),$k(Jp,Gi[n.app.options.appId],t,e,i).catch(s=>qt.error(s))}const yu="@firebase/analytics",vu="0.10.2";function Qk(){en(new Le(pu,(t,{options:e})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();return Kk(i,s,e)},"PUBLIC")),en(new Le("analytics-internal",n,"PRIVATE")),ye(yu,vu),ye(yu,vu,"esm2017");function n(t){try{const e=t.getProvider(pu).getImmediate();return{logEvent:(i,s,o)=>Xk(e,i,s,o)}}catch(e){throw ee.create("interop-component-reg-failed",{reason:e})}}}Qk();const Jk={__name:"DashBoard",setup(n){const e=ff({apiKey:"AIzaSyAgzP_84CmYH4Oe403ySujF5gZpIZfi0eA",authDomain:"test1-2aeb4.firebaseapp.com",databaseURL:"https://test1-2aeb4-default-rtdb.firebaseio.com",projectId:"test1-2aeb4",storageBucket:"test1-2aeb4.appspot.com",messagingSenderId:"405318153874",appId:"1:405318153874:web:982c4d2f9014409e02584b",measurementId:"G-VTLBLY5WEJ"}),i=DT(e),s=Et(i,"Tb/sensor/co2_concentration"),o=Et(i,"Tb/sensor/outside_temperature"),r=Et(i,"Tb/sensor/room_temperature"),a=Et(i,"Tb/sensor/room_humidity"),l=Et(i,"Tb/state/co2_concentration_manual"),c=Et(i,"Tb/state/outside_temperature_manual"),h=Et(i,"Tb/state/room_temperature_manual"),u=Et(i,"Tb/state/room_humidity_manual"),d=Et(i,"Tb/state/fan"),f=Et(i,"Tb/state/mist"),p=S([]),g=S([]),m=S([]),_=S([]),b=S(),x=S(),C=S(),v=S([]),w=S(!1),E=S(),T=S(!1),M=S(!1),A=S(!1),P=Et(i,"mushroom_tb/sensor/temperature"),N=Et(i,"mushroom_tb/sensor/humidity"),q=Et(i,"mushroom_tb/sensor/light"),dt=Et(i,"mushroom_tb/state/temperature_manual"),R=Et(i,"mushroom_tb/state/humidity_manual"),B=Et(i,"mushroom_tb/state/light_manual"),U=Et(i,"mushroom_tb/state/heater"),_t=Et(i,"mushroom_tb/state/mist"),it=S([]),Lt=S([]),H=S([]),Y=S(),ut=S(),K=wt=>{uu(wt,G=>{switch(wt._path.pieces_[2]){case"co2_concentration":p.value.push(Math.round(parseFloat(G.val())));break;case"outside_temperature":g.value.push(Math.round(parseFloat(G.val())));break;case"room_temperature":m.value.push(Math.round(parseFloat(G.val())));break;case"room_humidity":_.value.push(Math.round(parseFloat(G.val())));break;case"co2_concentration_manual":b.value=Math.round(parseFloat(G.val()));break;case"fan":x.value=Number(G.val());break;case"mist":C.value=Number(G.val());break}})},St=wt=>{uu(wt,G=>{switch(console.log(G),wt._path.pieces_[2]){case"temperature":it.value.push(Math.round(parseFloat(G.val())));break;case"humidity":Lt.value.push(Math.round(parseFloat(G.val())));break;case"light":H.value.push(Math.round(parseFloat(G.val())));break;case"heater":Y.value=Number(G.val());break;case"mist":ut.value=Number(G.val());break}})},Pt=()=>{K(s),K(o),K(r),K(a),K(l),p.value[p.value.length-1]>b.value?M.value=!0:M.value=!1},Cs=()=>{St(P),St(N),St(q)},Fn=(wt,G)=>{let bt=null;switch(wt){case"fan":bt=d,G==0?G=1:G=0;break;case"mist":bt=f,G==0?G=1:G=0;break;case"heater":bt=U,G==0?G=1:G=0;break;case"mistMushroom":bt=_t,G==0?G=1:G=0;break;case"co2Concentration":bt=l;break;case"roomHumidity":bt=u;break;case"outsideTemperature":bt=c;break;case"roomTemperature":bt=h;break;case"light":bt=B;break;case"humidity":bt=R;break;case"temperature":bt=dt;break}CT(bt,G.toString()).then(()=>{K(bt),Bn(),T.value=!0,setTimeout(()=>{T.value=!1},3e3),console.log("Successfully")}).catch(Hn=>{console.error("Fail:",Hn)})},di=wt=>{E.value=wt,w.value=!0},Ss=wt=>{Fn(E.value,wt)},Bn=()=>{w.value=!1,E.value=""};return Cu(()=>{hg().query.page==="mushroom_house"&&(A.value=!0)}),Ot(()=>{K(d),K(f),St(U),St(_t),Yx(()=>{A.value?Cs():Pt();const wt=new Date;v.value.push(wt.toLocaleTimeString())},3e3)}),(wt,G)=>{const bt=pg,Hn=F0,Jo=Ux;return F(),tt(us,null,[y(T)?(F(),re(bt,{key:0,type:"info"})):X("",!0),y(M)?(F(),re(bt,{key:1,type:"warning"})):X("",!0),y(A)?X("",!0):(F(),re(Hn,{key:2,co2Concentration:y(p)[y(p).length-1],outsideTemperature:y(g)[y(g).length-1],roomTemperature:y(m)[y(m).length-1],roomHumidity:y(_)[y(_).length-1],fan:y(x),mist:y(C),time:y(v)[y(v).length-1],onUpdateValue:Fn,onOpenSetting:di},null,8,["co2Concentration","outsideTemperature","roomTemperature","roomHumidity","fan","mist","time"])),y(A)?(F(),re(Hn,{key:3,temperature:y(it)[y(it).length-1],humidity:y(Lt)[y(Lt).length-1],light:y(H)[y(H).length-1],heater:y(Y),mistMushroom:y(ut),time:y(v)[y(v).length-1],isMushroomHouse:y(A),onUpdateValue:Fn,onOpenSetting:di},null,8,["temperature","humidity","light","heater","mistMushroom","time","isMushroomHouse"])):X("",!0),Wt(Jo,{isOpenDialog:y(w),typeSetting:y(E),onSaveData:Ss,onResetValue:Bn},null,8,["isOpenDialog","typeSetting"])],64)}}},Zk={class:"main"},oI={__name:"index",setup(n){return ug({title:"iot"}),(t,e)=>{const i=Jk;return F(),tt("div",Zk,[Wt(i)])}}};export{oI as default};
